///////////////////////////////////////////////////////
/// SPECULAR BUMPMAPPING 2D FRAGMENT PROGRAM //////////
///////////////////////////////////////////////////////

void main(float4 pos : POSITION, //in projection space
		  float4 color : COLOR,
		  float3 uv : TEXCOORD0, //in object space
		  float3 LightDir	: TEXCOORD1,
		  float2 ScreenPos	: TEXCOORD2,
                      
		  out float4 oColor : COLOR,
            
		  uniform sampler2D NormalMap : TEXUNIT0,
		  uniform sampler2D LightMap : TEXUNIT1)
{
	float4 BumpVec = (1 - 2*tex2D(NormalMap, uv));
	
	float4 LightCol = tex2D(LightMap,ScreenPos);
	
	float Diffuse = dot(LightDir,BumpVec.xyz)*LightCol.x;
	
	oColor.xyz = Diffuse*color.xyz;
}