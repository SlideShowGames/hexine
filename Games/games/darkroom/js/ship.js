var Ship={LIFTOFF_COOLDOWN:120,ALLOY_PER_HULL:1,ALLOY_PER_THRUSTER:1,BASE_HULL:0,BASE_THRUSTERS:1,name:_("Ship"),init:function(e){this.options=$.extend(this.options,e),$SM.get("features.location.spaceShip")||($SM.set("features.location.spaceShip",!0),$SM.setM("game.spaceShip",{hull:Ship.BASE_HULL,thrusters:Ship.BASE_THRUSTERS})),this.tab=Header.addLocation(_("An Old Starship"),"ship",Ship),this.panel=$("<div>").attr("id","shipPanel").addClass("location").appendTo("div#locationSlider"),Engine.updateSlider();var t=$("<div>").attr("id","hullRow").appendTo("div#shipPanel");$("<div>").addClass("row_key").text(_("hull:")).appendTo(t),$("<div>").addClass("row_val").text($SM.get("game.spaceShip.hull")).appendTo(t),$("<div>").addClass("clear").appendTo(t);var i=$("<div>").attr("id","engineRow").appendTo("div#shipPanel");$("<div>").addClass("row_key").text(_("engine:")).appendTo(i),$("<div>").addClass("row_val").text($SM.get("game.spaceShip.thrusters")).appendTo(i),$("<div>").addClass("clear").appendTo(i),new Button.Button({id:"reinforceButton",text:_("reinforce hull"),click:Ship.reinforceHull,width:"100px",cost:{"alien alloy":Ship.ALLOY_PER_HULL}}).appendTo("div#shipPanel"),new Button.Button({id:"engineButton",text:_("upgrade engine"),click:Ship.upgradeEngine,width:"100px",cost:{"alien alloy":Ship.ALLOY_PER_THRUSTER}}).appendTo("div#shipPanel");var n=new Button.Button({id:"liftoffButton",text:_("lift off"),click:Ship.checkLiftOff,width:"100px",cooldown:Ship.LIFTOFF_COOLDOWN}).appendTo("div#shipPanel");$SM.get("game.spaceShip.hull")<=0&&Button.setDisabled(n,!0),Space.init(),$.Dispatch("stateUpdate").subscribe(Ship.handleStateUpdates)},options:{},onArrival:function(e){Ship.setTitle(),$SM.get("game.spaceShip.seenShip")||(Notifications.notify(Ship,_("somewhere above the debris cloud, the wanderer fleet hovers. been on this rock too long.")),$SM.set("game.spaceShip.seenShip",!0)),AudioEngine.playBackgroundMusic(AudioLibrary.MUSIC_SHIP),Engine.moveStoresView(null,e)},setTitle:function(){Engine.activeModule==this&&(document.title=_("An Old Starship"))},reinforceHull:function(){if($SM.get('stores["alien alloy"]',!0)<Ship.ALLOY_PER_HULL)return Notifications.notify(Ship,_("not enough alien alloy")),!1;$SM.add('stores["alien alloy"]',-Ship.ALLOY_PER_HULL),$SM.add("game.spaceShip.hull",1),$SM.get("game.spaceShip.hull")>0&&Button.setDisabled($("#liftoffButton",Ship.panel),!1),$("#hullRow .row_val",Ship.panel).text($SM.get("game.spaceShip.hull")),AudioEngine.playSound(AudioLibrary.REINFORCE_HULL)},upgradeEngine:function(){if($SM.get('stores["alien alloy"]',!0)<Ship.ALLOY_PER_THRUSTER)return Notifications.notify(Ship,_("not enough alien alloy")),!1;$SM.add('stores["alien alloy"]',-Ship.ALLOY_PER_THRUSTER),$SM.add("game.spaceShip.thrusters",1),$("#engineRow .row_val",Ship.panel).text($SM.get("game.spaceShip.thrusters")),AudioEngine.playSound(AudioLibrary.UPGRADE_ENGINE)},getMaxHull:function(){return $SM.get("game.spaceShip.hull")},checkLiftOff:function(){$SM.get("game.spaceShip.seenWarning")?Ship.liftOff():Events.startEvent({title:_("Ready to Leave?"),scenes:{start:{text:[_("time to get out of this place. won't be coming back.")],buttons:{fly:{text:_("lift off"),onChoose:function(){$SM.set("game.spaceShip.seenWarning",!0),Ship.liftOff()},nextScene:"end"},wait:{text:_("linger"),onChoose:function(){Button.clearCooldown($("#liftoffButton"))},nextScene:"end"}}}}})},liftOff:function(){$("#outerSlider").animate({top:"700px"},300),Space.onArrival(),Engine.activeModule=Space,AudioEngine.playSound(AudioLibrary.LIFT_OFF)},handleStateUpdates:function(e){}};