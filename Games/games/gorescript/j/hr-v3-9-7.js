(function(){var aQ={};gws=aQ;aQ.settings={global:{autoLoad:true,initialScene:"load",fps:60,rootElement:"root",aspectRatio:1.333,nativeAssetResolution:1024,resizeFont:true,plugins:["js/animal-plugin.js","js/pngquant-plugin.js","js/manifest-plugin.js","js/compile-scripts.js","js/language-plugin.js","js/names-plugin.js","js/compile-assets.js","js/compression-plugin.js","js/write-files.js"]},manifest:{audio:{firefox:"ogg",opera:"ogg",chrome:"ogg",android:"m4a",silk:"m4a",ipod:"m4a",ipad:"m4a",iphone:"m4a",msie:"mp3",safari:"mp3",trident:"mp3"}},version:"3.9.7",timestamp:"Wed Feb 17 10:06:17 EST 2016",buildIndex:117,animals:{bert:{id:"bert",name:"Bertle the Turtle",assets:{avatar:{src:"turtle-avatar.png",data:{}},profile:{src:"turtle-profile.png",data:{spritesheet:{frames:{width:32,height:32,regX:16,regY:20},framerate:8,animations:{airborne:7,grounded:{frames:[1,2,3,4]}}}}}},data:{}},mayor:{id:"mayor",name:"Noah Gopher III",assets:{avatar:{src:"gopher-avatar.png",data:{}},profile:{src:"gopher-profile.png",data:{spritesheet:{frames:{width:32,height:32,regX:16,regY:20},framerate:8,animations:{airborne:7,grounded:{frames:[1,2,3,4]}}}}}}},sheldon:{id:"sheldon",name:"Sheldon the Sheep",assets:{avatar:{src:"sheep-avatar.png",data:{}},profile:{src:"sheep-profile.png",data:{spritesheet:{frames:{width:32,height:32,regX:16,regY:20},framerate:8,animations:{airborne:7,grounded:{frames:[1,2,3,4]}}}}}}}},assets:{"Fontin-SmallCaps":{id:"Fontin-SmallCaps",src:"f/Fontin-SmallCaps.ttf"},slayer:{id:"slayer",src:"f/slayer.ttf"},click:{id:"click",src:"a/click.m4a"},Layer1_1:{id:"Layer1_1",src:"a/Layer1_1.m4a"},Layer1_2:{id:"Layer1_2",src:"a/Layer1_2.m4a"},Layer1_3:{id:"Layer1_3",src:"a/Layer1_3.m4a"},Layer1_4:{id:"Layer1_4",src:"a/Layer1_4.m4a"},Layer1_5:{id:"Layer1_5",src:"a/Layer1_5.m4a"},Layer1_6:{id:"Layer1_6",src:"a/Layer1_6.m4a"},Layer2_1:{id:"Layer2_1",src:"a/Layer2_1.m4a"},Layer2_2:{id:"Layer2_2",src:"a/Layer2_2.m4a"},Layer2_3:{id:"Layer2_3",src:"a/Layer2_3.m4a"},Layer2_4:{id:"Layer2_4",src:"a/Layer2_4.m4a"},Layer2_5:{id:"Layer2_5",src:"a/Layer2_5.m4a"},"end-game":{id:"end-game",src:"a/end-game.m4a"},sfx:{id:"sfx",src:"a/sfx.m4a"},Turn0:{id:"Turn0",src:"a/Turn0.m4a"},Turn1:{id:"Turn1",src:"a/Turn1.m4a"},Turn2:{id:"Turn2",src:"a/Turn2.m4a"},"bonus-unlock":{id:"bonus-unlock",src:"a/bonus-unlock.m4a"},"bonus-tile":{id:"bonus-tile",src:"a/bonus-tile.m4a"},"bonus-points":{id:"bonus-points",src:"a/bonus-points.m4a"},"daily-challenge":{id:"daily-challenge",src:"a/daily-challenge.m4a"},"ad-fb":{id:"ad-fb",src:"i/ad-fb.png"},ad_fb:{id:"ad_fb",src:"i/ad_fb.png",cache:false},"ad-ios":{id:"ad-ios",src:"i/ad-ios.png",cache:false},"ad-sakura":{id:"ad-sakura",src:"i/ad-sakura.png"},"ad-t":{id:"ad-t",src:"i/ad-t.png",cache:false},"ad-tw":{id:"ad-tw",src:"i/ad-tw.png"},ad_tw:{id:"ad_tw",src:"i/ad_tw.png",cache:false},ad_twitter:{id:"ad_twitter",src:"i/ad_twitter.png",cache:false},"chrome-web-store":{id:"chrome-web-store",src:"i/chrome-web-store.png",cache:false},favicon:{id:"favicon",src:"i/favicon.ico",cache:false},"icon-16":{id:"icon-16",src:"i/icon-16.png",cache:false},"icon-32":{id:"icon-32",src:"i/icon-32.png",cache:false},"icon-48":{id:"icon-48",src:"i/icon-48.png",cache:false},"icon-64":{id:"icon-64",src:"i/icon-64.png",cache:false},"icon-128":{id:"icon-128",src:"i/icon-128.png",cache:false},"ios-share":{id:"ios-share",src:"i/ios-share.png",cache:false},mid_1:{id:"mid_1",src:"i/mid_1.png",cache:false},rock:{id:"rock",src:"i/rock.png",cache:false},mid_0:{id:"mid_0",src:"i/mid_0.png",cache:false},mid_2:{id:"mid_2",src:"i/mid_2.png",cache:false},gameboard_glow:{id:"gameboard_glow",src:"i/gameboard_glow.png",cache:false},corner_shadow:{id:"corner_shadow",src:"i/corner_shadow.png",cache:false},top_0:{id:"top_0",src:"i/top_0.png",cache:false},top_1:{id:"top_1",src:"i/top_1.png",cache:false},top_2:{id:"top_2",src:"i/top_2.png",cache:false},"left-trim":{id:"left-trim",src:"i/left-trim.png",cache:false},right_trim:{id:"right_trim",src:"i/right_trim.png",cache:false},"ss-lotus-petal":{id:"ss-lotus-petal",src:"i/ss-lotus-petal.jpg",cache:false},"ss-hana-blossom":{id:"ss-hana-blossom",src:"i/ss-hana-blossom.jpg",cache:false},"ss-sakura-grove":{id:"ss-sakura-grove",src:"i/ss-sakura-grove.jpg",cache:false},"ss-daily-challenge-new":{id:"ss-daily-challenge-new",src:"i/ss-daily-challenge-new.jpg",cache:false},"ss-clover":{id:"ss-clover",src:"i/ss-clover.jpg",cache:false},"ss-lovely":{id:"ss-lovely",src:"i/ss-lovely.jpg",cache:false},"ss-desert-trek":{id:"ss-desert-trek",src:"i/ss-desert-trek.jpg",cache:false},"ss-ephemeral-tranquility":{id:"ss-ephemeral-tranquility",src:"i/ss-ephemeral-tranquility.jpg",cache:false},"ss-raceway":{id:"ss-raceway",src:"i/ss-raceway.jpg",cache:false},"ss-sakura-garden":{id:"ss-sakura-garden",src:"i/ss-sakura-garden.jpg",cache:false},"ss-sakura-blossom":{id:"ss-sakura-blossom",src:"i/ss-sakura-blossom.jpg",cache:false},"ss-honeycomb":{id:"ss-honeycomb",src:"i/ss-honeycomb.jpg",cache:false},bg:{id:"bg",src:"i/bg.jpg"},"bonus-tiles":{id:"bonus-tiles",src:"i/bonus-tiles.png"},button:{id:"button",src:"i/button.png"},"button-highlight":{id:"button-highlight",src:"i/button-highlight.png"},"button-tiny":{id:"button-tiny",src:"i/button-tiny.png"},checkoutMobile:{id:"checkoutMobile",src:"i/checkoutMobile.gif"},"dialog-box":{id:"dialog-box",src:"i/dialog-box.png"},"tab-small":{id:"tab-small",src:"i/tab-small.png"},tiles12:{id:"tiles12",src:"i/tiles12.png"},"ss-classic":{id:"ss-classic",src:"i/ss-classic.jpg"},browsers:{id:"browsers",src:"i/browsers.png"},"entanglement-logo-250":{id:"entanglement-logo-250",src:"i/entanglement-logo-250.png"},score_background:{id:"score_background",src:"i/score_background.png"},line:{id:"line",src:"i/line.png"},"line-red":{id:"line-red",src:"i/line-red.png"},exit:{id:"exit",src:"i/exit.png"},"side-menu-reflection":{id:"side-menu-reflection",src:"i/side-menu-reflection.png"},icon_logo:{id:"icon_logo",src:"i/icon_logo.png"},"bg-highscores":{id:"bg-highscores",src:"i/bg-highscores.png"},VERY_TOP_GLOW:{id:"VERY_TOP_GLOW",src:"i/VERY_TOP_GLOW.png"},swap:{id:"swap",src:"i/swap.png"},red:{id:"red",src:"i/red.png"},blue:{id:"blue",src:"i/blue.png"},yellow:{id:"yellow",src:"i/yellow.png"},green:{id:"green",src:"i/green.png"},orange:{id:"orange",src:"i/orange.png"},purple:{id:"purple",src:"i/purple.png"},field_places:{id:"field_places",src:"i/field_places.png"},field_lengths:{id:"field_lengths",src:"i/field_lengths.png"},field_scores:{id:"field_scores",src:"i/field_scores.png"},menu_bg2:{id:"menu_bg2",src:"i/menu_bg2.png"},field:{id:"field",src:"i/field.png"},button_numberbar:{id:"button_numberbar",src:"i/button_numberbar.png"},button_namebar:{id:"button_namebar",src:"i/button_namebar.png"},button_scorebar:{id:"button_scorebar",src:"i/button_scorebar.png"},"arrow-left":{id:"arrow-left",src:"i/arrow-left.png"},"arrow-right":{id:"arrow-right",src:"i/arrow-right.png"},sparks1:{id:"sparks1",src:"i/sparks1.png"},sparks2:{id:"sparks2",src:"i/sparks2.png"},online:{id:"online",src:"i/online.png"},offline:{id:"offline",src:"i/offline.png"},field_names_highlight:{id:"field_names_highlight",src:"i/field_names_highlight.png"},field_small_highlight:{id:"field_small_highlight",src:"i/field_small_highlight.png"},icon_star:{id:"icon_star",src:"i/icon_star.png"},field_names:{id:"field_names",src:"i/field_names.png"},field_small:{id:"field_small",src:"i/field_small.png"},bar:{id:"bar",src:"i/bar.png"},"bar-buttons1":{id:"bar-buttons1",src:"i/bar-buttons1.png"},"credits-gw":{id:"credits-gw",src:"i/credits-gw.png"},"credits-jp":{id:"credits-jp",src:"i/credits-jp.png"},"credits-oa":{id:"credits-oa",src:"i/credits-oa.png"},"bar-horizontal":{id:"bar-horizontal",src:"i/bar-horizontal.png"},scrollbar_middle:{id:"scrollbar_middle",src:"i/scrollbar_middle.png"},scrollbar_small:{id:"scrollbar_small",src:"i/scrollbar_small.png"},"tile-jewelry2":{id:"tile-jewelry2",src:"i/tile-jewelry2.png"},"rotate-buttons":{id:"rotate-buttons",src:"i/rotate-buttons.png"},"bonus-tile-shadow":{id:"bonus-tile-shadow",src:"i/bonus-tile-shadow.png"},"expansion-box":{id:"expansion-box",src:"i/expansion-box.png"},"post-game-buttons":{id:"post-game-buttons",src:"i/post-game-buttons.png"},"free-trial-banner-h":{id:"free-trial-banner-h",src:"i/free-trial-banner-h.png"},"back-button":{id:"back-button",src:"i/back-button.png"},background:{id:"background",src:"i/background.jpg"},button_default1:{id:"button_default1",src:"i/button_default1.png"},button_roll:{id:"button_roll",src:"i/button_roll.png"},logo:{id:"logo",src:"i/logo.png"},"logo-mobile":{id:"logo-mobile",src:"i/logo-mobile.png"},menu_background:{id:"menu_background",src:"i/menu_background.png"},"menu-icons-2":{id:"menu-icons-2",src:"i/menu-icons-2.png"},"main-menu-buttons":{id:"main-menu-buttons",src:"i/main-menu-buttons.png"},main_menu_toplayer:{id:"main_menu_toplayer",src:"i/main_menu_toplayer.png"},"side-menu-buttons":{id:"side-menu-buttons",src:"i/side-menu-buttons.png"},"side-icons":{id:"side-icons",src:"i/side-icons.png"},"side-background":{id:"side-background",src:"i/side-background.png"},"bert-avatar":{id:"bert-avatar",src:"i/animals-turtle-avatar.png",data:{}},"bert-profile":{id:"bert-profile",src:"i/animals-turtle-profile.png",data:{spritesheet:{frames:{width:32,height:32,regX:16,regY:20},framerate:8,animations:{airborne:7,grounded:{frames:[1,2,3,4]}}}}},"mayor-avatar":{id:"mayor-avatar",src:"i/animals-gopher-avatar.png",data:{}},"mayor-profile":{id:"mayor-profile",src:"i/animals-gopher-profile.png",data:{spritesheet:{frames:{width:32,height:32,regX:16,regY:20},framerate:8,animations:{airborne:7,grounded:{frames:[1,2,3,4]}}}}},"sheldon-avatar":{id:"sheldon-avatar",src:"i/animals-sheep-avatar.png",data:{}},"sheldon-profile":{id:"sheldon-profile",src:"i/animals-sheep-profile.png",data:{spritesheet:{frames:{width:32,height:32,regX:16,regY:20},framerate:8,animations:{airborne:7,grounded:{frames:[1,2,3,4]}}}}}},includes:{"script/asset-loader.js":{src:"../game/script/asset-loader.js",id:"script/asset-loader.js"},"script/animation.js":{src:"../game/script/animation.js",id:"script/animation.js"},"script/animation-manager.js":{src:"../game/script/animation-manager.js",id:"script/animation-manager.js"},"script/audio.js":{src:"../game/script/audio.js",id:"script/audio.js"},"script/audio-manager.js":{src:"../game/script/audio-manager.js",id:"script/audio-manager.js"},"script/audio-mobile.js":{src:"../game/script/audio-mobile.js",id:"script/audio-mobile.js"},"script/banner-ads.js":{src:"../game/script/banner-ads.js",id:"script/banner-ads.js"},"script/browser-check.js":{src:"../game/script/browser-check.js",id:"script/browser-check.js"},"script/button.js":{src:"../game/script/button.js",id:"script/button.js"},"script/draw.js":{src:"../game/script/draw.js",id:"script/draw.js"},"script/layer.js":{src:"../game/script/layer.js",id:"script/layer.js"},"script/local-storage.js":{src:"../game/script/local-storage.js",id:"script/local-storage.js"},"script/loop.js":{src:"../game/script/loop.js",id:"script/loop.js"},"script/progress-bar.js":{src:"../game/script/progress-bar.js",id:"script/progress-bar.js"},"script/waypoints.js":{src:"../game/script/waypoints.js",id:"script/waypoints.js"},"script/settings.js":{src:"../game/script/settings.js",id:"script/settings.js"},"script/account.js":{src:"../game/script/account.js",id:"script/account.js"},"script/ads.js":{src:"../game/script/ads.js",id:"script/ads.js"},"script/ajax.js":{src:"../game/script/ajax.js",id:"script/ajax.js"},"script/analytics.js":{src:"../game/script/analytics.js",id:"script/analytics.js"},"script/button-bar.js":{src:"../game/script/button-bar.js",id:"script/button-bar.js"},"script/buy-page.js":{src:"../game/script/buy-page.js",id:"script/buy-page.js"},"script/canvas.js":{src:"../game/script/canvas.js",id:"script/canvas.js"},"script/client-appengine.js":{src:"../game/script/client-appengine.js",id:"script/client-appengine.js"},"script/client-plus.js":{src:"../game/script/client-plus.js",id:"script/client-plus.js"},"script/create-shortcut.js":{src:"../game/script/create-shortcut.js",id:"script/create-shortcut.js"},"script/global.js":{src:"../game/script/global.js",id:"script/global.js"},"script/html.js":{src:"../game/script/html.js",id:"script/html.js"},"script/input.js":{src:"../game/script/input.js",id:"script/input.js"},"script/localscores.js":{src:"../game/script/localscores.js",id:"script/localscores.js"},"script/main.js":{src:"../game/script/main.js",id:"script/main.js"},"script/map.js":{src:"../game/script/map.js",id:"script/map.js"},"script/menu.js":{src:"../game/script/menu.js",id:"script/menu.js"},"script/offline.js":{src:"../game/script/offline.js",id:"script/offline.js"},"script/openid-popup.js":{src:"../game/script/openid-popup.js",id:"script/openid-popup.js"},"script/page-swipe.js":{src:"../game/script/page-swipe.js",id:"script/page-swipe.js"},"script/payments.js":{src:"../game/script/payments.js",id:"script/payments.js"},"script/play-again-panel.js":{src:"../game/script/play-again-panel.js",id:"script/play-again-panel.js"},"script/player.js":{src:"../game/script/player.js",id:"script/player.js"},"script/phonegap.js":{src:"../game/script/phonegap.js",id:"script/phonegap.js"},"script/replay.js":{src:"../game/script/replay.js",id:"script/replay.js"},"script/selection.js":{src:"../game/script/selection.js",id:"script/selection.js"},"script/score.js":{src:"../game/script/score.js",id:"script/score.js"},"script/sha1.js":{src:"../game/script/sha1.js",id:"script/sha1.js"},"script/subtle-message.js":{src:"../game/script/subtle-message.js",id:"script/subtle-message.js"},"script/tile.js":{src:"../game/script/tile.js",id:"script/tile.js"},"script/tile-control.js":{src:"../game/script/tile-control.js",id:"script/tile-control.js"},"script/view.js":{src:"../game/script/view.js",id:"script/view.js"},"script/view-tile.js":{src:"../game/script/view-tile.js",id:"script/view-tile.js"},"script/windows.js":{src:"../game/script/windows.js",id:"script/windows.js"},"css/ads.css":{src:"../game/css/ads.css",id:"css/ads.css"},"css/background.css":{src:"../game/css/background.css",id:"css/background.css"},"css/browsers.css":{src:"../game/css/browsers.css",id:"css/browsers.css"},"css/button-bar.css":{src:"../game/css/button-bar.css",id:"css/button-bar.css"},"css/buy-page.css":{src:"../game/css/buy-page.css",id:"css/buy-page.css"},"css/create-shortcut.css":{src:"../game/css/create-shortcut.css",id:"css/create-shortcut.css"},"css/dialog.css":{src:"../game/css/dialog.css",id:"css/dialog.css"},"css/effects.css":{src:"../game/css/effects.css",id:"css/effects.css"},"css/language.css":{src:"../game/css/language.css",id:"css/language.css"},"css/main-menu.css":{src:"../game/css/main-menu.css",id:"css/main-menu.css"},"css/menu.css":{src:"../game/css/menu.css",id:"css/menu.css"},"css/page-swipe.css":{src:"../game/css/page-swipe.css",id:"css/page-swipe.css"},"css/play-again-panel.css":{src:"../game/css/play-again-panel.css",id:"css/play-again-panel.css"},"css/play-ui.css":{src:"../game/css/play-ui.css",id:"css/play-ui.css"},"css/progress-bar.css":{src:"../game/css/progress-bar.css",id:"css/progress-bar.css"},"css/scoreboard.css":{src:"../game/css/scoreboard.css",id:"css/scoreboard.css"},"css/scrollbar.css":{src:"../game/css/scrollbar.css",id:"css/scrollbar.css"},"css/side-menu.css":{src:"../game/css/side-menu.css",id:"css/side-menu.css"},"css/standard.css":{src:"../game/css/standard.css",id:"css/standard.css"},"css/subtle-message.css":{src:"../game/css/subtle-message.css",id:"css/subtle-message.css"},"css/tile-control.css":{src:"../game/css/tile-control.css",id:"css/tile-control.css"}},entities:{},scenes:{},levels:{},components:{},debug:false};gws.assets={cdn:"",images:[],streamingEnabled:"untested",saveScaledImages:true,sounds:[],assetCount:0,assetsLoaded:0,assetsFailed:0,imageCount:0,imagesLoaded:0,soundCount:0,soundsLoaded:0,onFinishOne:function(bQ,e){},onFinishImages:function(){},onFinishSounds:function(){},onFinishAll:function(){},unloadedAssets:[],loadedAssets:[],loadedImage:function(e){this.loaded(e);this.imagesLoaded+=1;if(this.imagesLoaded>=this.imageCount){this.onFinishImages()}},loadedSound:function(e){this.loaded(e);this.soundsLoaded+=1;if(this.soundsLoaded>=this.soundCount){this.onFinishSounds()}},loaded:function(bQ){if(this.cdn!=""){bQ=bQ.replace(this.cdn,"")}if(bQ.indexOf("?")>0){bQ=bQ.split("?")[0]}this.assetsLoaded+=1;if(console){console.log(bQ+" ("+this.assetsLoaded+" of "+this.assetCount+") is loaded")}this.onFinishOne(this.assetsLoaded/this.assetCount,bQ);for(var e=0;e<this.unloadedAssets.length;e++){if(this.unloadedAssets[e]==bQ){this.unloadedAssets.splice(e,1)[0];break}}this.loadedAssets.push(bQ);if(this.assetsLoaded>=this.assetCount){this.onFinishAll()}},load:function(bT,bZ,bR,bV,bQ){var bW,bS,b0;if(bT.length==0){if(bR){bR()}return false}this.unloadedAssets=bT;this.onFinishOne=function(b1,e){};this.onFinishImages=function(){};this.onFinishSounds=function(){};this.onFinishAll=function(){};if(bZ){this.onFinishOne=bZ}if(bR){this.onFinishAll=bR}if(bV){this.onFinishImages=bV}if(bQ){this.onFinishSounds=bQ}for(var bU in bT){bS=b0=bT[bU];if(bS.indexOf("?")>0){b0=bS.split("?")[0]}this.assetCount+=1;bW=b0.length-4;if(bW>=0){var bY=b0.toUpperCase().substring(bW);switch(bY){case".PNG":case".JPG":case"JPEG":this.images[b0]=new Image();this.images[b0].addEventListener("load",this.eventListeners.loadImage,false);this.images[b0].addEventListener("error",this.eventListeners.fail,false);this.images[b0].src=this.cdn+bS;this.imageCount+=1;break;case".MP3":case".M4A":case".WAV":case".OGG":if(window.Audia&&window.Audia.supported&&(gws.assets.streamingEnabled!=="disabled")){this.sounds[b0]=new Audia();this.sounds[b0].onload=this.eventListeners.loadSound;try{this.sounds[b0].src=this.cdn+bS;gws.assets.streamingEnabled="enabled"}catch(bX){gws.assets.streamingEnabled="disabled"}}else{gws.assets.streamingEnabled="disabled"}if(gws.assets.streamingEnabled==="disabled"){if(window.Media){this.sounds[b0]=new Media("/android_asset/www/"+bS,this.eventListeners.loadSound,this.eventListeners.fail);this.sounds[b0].srcName=bS}else{this.sounds[b0]=new Audio();this.sounds[b0].addEventListener("loadeddata",this.eventListeners.loadSound,false);this.sounds[b0].addEventListener("error",this.eventListeners.fail,false);this.sounds[b0].src=this.cdn+bS}}this.soundCount+=1;break;case".ICO":default:this.assetsLoaded+=1}}else{this.assetsLoaded+=1}}},eventListeners:{loadImage:function(){gws.assets.loadedImage(this.getAttribute("src"))},loadSound:function(){var e=this.getAttribute?this.getAttribute("src"):this.src||this.srcName;gws.assets.loadedSound(e)},fail:function(){gws.assets.loaded(this.getAttribute?this.getAttribute("src"):this.src||this.srcName);gws.assets.assetsFailed+=1;if(console){console.error((this.getAttribute?this.getAttribute("src"):this.src||this.srcName)+" failed to load.")}}},getImage:function(bY,bQ,bZ){var bU=this.images[bY];if(bU){if(this.saveScaledImages){var bW=Math.ceil(bQ);var bX=Math.ceil(bZ||(((bW==bU.width)||(!bW))?bU.height:bW*bU.height/bU.width));if(!bW){bW=Math.ceil((bX==bU.height)?bU.width:bX*bU.width/bU.height)}var bR=((bW==bU.width)&&(bX==bU.height));var bS=bR?bY:bY+"-"+bW+"x"+bX;if(!this.images[bS]){var bT=document.createElement("canvas");bT.width=bW;bT.height=bX;var b0=bT.getContext("2d");try{b0.drawImage(bU,0,0,bU.width,bU.height,0,0,bW,bX)}catch(bV){}this.images[bS]=bT}return this.images[bS]}else{return bU}}else{console.warn('"'+bY+'" is not a loaded asset!');return false}},removeImage:function(e){this.images[e]=undefined},getTile:function(bV,bR,bW,bT,bQ){var bU=bV+"-"+bR+"_"+bW;var bS=this.images[bU];if(!bS){var e=bV.split("-");e=e[e.length-1].split(".")[0].split("x");if(!this.createSpriteSheet(bV,false,e[0],e[1])){console.error("Tile of ("+bR+","+bW+") on "+bV+" cannot be created.")}}return this.getImage(bU,bT,bQ)},createSpriteSheet:function(b1,bQ,bR,b3){var bW=bR||1;var bZ=b3||1;var bT=this.images[bQ||b1];if(bT){var b0=Math.floor(bT.width/bW);var bY=Math.floor(bT.height/bZ);for(var bV=0;bV<bW;bV++){for(var bX=0;bX<bZ;bX++){var bS=document.createElement("canvas");bS.width=b0;bS.height=bY;var b2=bS.getContext("2d");try{b2.drawImage(bT,bV*b0,bX*bY,b0,bY,0,0,b0,bY)}catch(bU){}this.images[b1+"-"+bV+"_"+bX]=bS}}this.removeImage(bQ||b1);return true}else{console.error('gws.assets.createSpriteSheet: "'+b1+'" is not in the list of assets.');return false}},setImageName:function(bQ,e){this.images[e]=bQ;return bQ},setSoundName:function(bQ,e){this.sounds[e]=bQ;return bQ},getSound:function(e){if(this.sounds[e]){return this.sounds[e]}else{throw'"'+e+'" is not a loaded asset!';return false}},removeSound:function(e){this.sounds[e]=undefined},combine:function(bS){var bY=bS||{};var bU=bY.layers||[];var bR=bY.minWidth||0;var bQ=bY.minHeight||0;bR=Math.ceil(bR/2);bQ=Math.ceil(bQ/2);var bV=bQ,b1=bQ,e=bR,b0=bR,bW,bZ="";for(var bX in bU){bW=bU[bX];bW.x=bW.x||0;bW.y=bW.y||0;bZ+=bW.image;if(bW.spriteXY){bW.imageSrc=this.getTile(bW.image,bW.spriteXY.x,bW.spriteXY.y,bW.width,bW.height)}else{bW.imageSrc=this.getImage(bW.image,bW.width,bW.height)}bW.width=bW.width||bW.imageSrc.width;bW.height=bW.height||bW.imageSrc.height;bV=Math.max(bV,bW.y);b1=Math.max(b1,bW.height-bW.y);e=Math.max(e,bW.x);b0=Math.max(b0,bW.width-bW.x)}bZ=bY.title||bZ;var bT=document.createElement("canvas");bT.width=e+b0;bT.height=bV+b1;var b4=e;var b2=bV;var b3=bT.getContext("2d");for(var bX in bU){bW=bU[bX];b3.save();if(bW.mirror){if(bW.mirror=="horizontal"){b3.translate(b4,0);b3.scale(-1,1);b3.translate(-b4,0)}else{if(bW.mirror=="vertical"){b3.translate(0,b2);b3.scale(1,-1);b3.translate(0,-b2)}}}b3.drawImage(bW.imageSrc,0,0,bW.imageSrc.width,bW.imageSrc.height,b4-bW.x,b2-bW.y,bW.width,bW.height);b3.restore()}return this.setImageName(bT,bZ)},copyTile:function(bQ,e,bR){return this.copyImage(bQ,this.getTile(bQ,e,bR))},copyImage:function(bT,bS){var bQ=bS||this.getImage(bT);var bR=document.createElement("canvas");bR.width=bQ.width;bR.height=bQ.height;var e=bR.getContext("2d");e.save();e.drawImage(bQ,0,0,bQ.width,bQ.height,0,0,bQ.width,bQ.height);e.restore();return bR},filterAudio:function(bR,e){var bS=[],bQ;if(e.ogg){for(bQ in bR){if((bR[bQ].indexOf("mp3")<0)&&(bR[bQ].indexOf("m4a")<0)){bS.push(bR[bQ])}}}else{if(e.m4a&&(e.android||e.iOS)){for(bQ in bR){if((bR[bQ].indexOf("ogg")<0)&&(bR[bQ].indexOf("mp3")<0)){bS.push(bR[bQ])}}}else{for(bQ in bR){if((bR[bQ].indexOf("ogg")<0)&&(bR[bQ].indexOf("m4a")<0)){bS.push(bR[bQ])}}}}bR=bS;return bR},referenceAudio:function(bS,e){if(e.mobile){var bT=[],bR,bQ;for(bQ in bS){if((bS[bQ].indexOf("ogg")>0)||(bS[bQ].indexOf("mp3")>0)||(bS[bQ].indexOf("m4a")>0)){if(window.Media){bR=new Media("/android_asset/www/"+bS[bQ]);bR.srcName=bS[bQ]}else{bR=new Audio();bR.src=bS[bQ]}this.setSoundName(bR,bS[bQ].replace("a/","").replace(".mp3","").replace(".m4a","").replace(".ogg",""))}else{bT.push(bS[bQ])}}bS=bT}return bS}};gws.classes=gws.classes||{};gws.classes.frame=function(bQ){var e=bQ||{};this.edges=[];this.t=e.t;this.time=e.time;this.x=e.x;this.y=e.y;this.z=e.z;this.image=e.image;this.sprite=e.sprite;this.spriteSize=e.spriteSize};gws.classes.frame.prototype.setEdge=function(e,bQ){this.edges[e]=bQ};gws.classes.frame.prototype.getEdge=function(e){return this.edges[e]};gws.classes.frame.prototype.getNode=function(bQ){var e=this.getEdge(bQ);if(e){return e.getNode(this)}else{return false}};gws.classes.animation=function(e,bQ,bR){this.layer=bQ;this.div=false;if(!bQ.context){this.div=gws.createElement(bQ.canvas,"div","animation");this.div.style.position="absolute";this.div.style.top="0px";this.div.style.left="0px";this.div.style.webkitTransformOrigin="50% 50% 0";this.div.style.mozTransformOrigin="50% 50% 0";this.div.style.msTransformOrigin="50% 50% 0";this.div.style.oTransformOrigin="50% 50% 0";this.div.style.transformOrigin="50% 50% 0"}this.currentFrame={assets:bR};this.lastFrame={assets:bR};this.sequences=[];this.setupAnimation(e);this.isDifferent=true;this.update()};gws.classes.animation.prototype.addSequence=function(e){this.destroyOnEnd=false;this.sequences.push(e)};gws.classes.animation.prototype.replaceSequence=function(e){this.destroyOnEnd=false;this.sequences=e};gws.classes.animation.prototype.interruptSequence=function(e){this.destroyOnEnd=false;this.sequences=e;this.interrupt=true};gws.classes.animation.prototype.nextSequence=function(e){if(this.onEnd){this.onEnd();this.onEnd=false}if((this.sequences.length>0)&&(!this.destroyNow)){if(this.sequences[0].delay){if(this.sequences[0].startTime){if(e>=this.sequences[0].startTime){this.setupAnimation(this.sequences.splice(0,1)[0],e);this.update(e);return true}else{return false}}else{this.sequences[0].startTime=e+this.sequences[0].delay;this.sequences[0].delay=1;return false}}this.setupAnimation(this.sequences.splice(0,1)[0],e);this.update(e);return true}else{if((this.destroyOnEnd||this.destroyNow)&&!this.destroyed){this.destroyed=true;return false}else{if(this.referenceObj){return false}else{if(!this.destroyed){this.destroyed=true;return true}}}}};gws.classes.animation.prototype.setupAnimation=function(bS,bT){if(bS.onBegin){bS.onBegin();if(DEBUG){if(this.console){console.log("Animation onBegin at "+(bT||new Date().getTime()))}}}this.onEnd=bS.onEnd;this.referenceObj=bS.object||this.referenceObj||false;this.relative=bS.relative||false;if(!this.relative){this.relativeX=0;this.relativeY=0}else{this.relativeX=this.relativeX||bS.relativeX||0;this.relativeY=this.relativeY||bS.relativeY||0}var bR=bS;var bV=bR.frames||[];this.x1=bR.x1||bR.x||this.x2||0;this.y1=bR.y1||bR.y||this.y2||0;this.z1=bR.z1||bR.z||this.z2||0;this.x2=bR.x2||bR.x||this.x2||0;this.y2=bR.y2||bR.y||this.y2||0;this.z2=bR.z2||bR.z||this.z2||0;this.height1=bR.height1||bR.height||this.height2||0;this.height2=bR.height2||bR.height||this.height2||0;this.radius1=bR.radius1||bR.radius||this.radius2||0;this.radius2=bR.radius2||bR.radius||this.radius2||0;this.width1=bR.width1||bR.width||this.width2||0;this.width2=bR.width2||bR.width||this.width2||0;this.rotation1=bR.rotation1||bR.rotation||this.rotation2||0;this.rotation2=bR.rotation2||bR.rotation||this.rotation2||0;this.opacity1=(typeof bR.opacity1!="undefined")?bR.opacity1:(bR.opacity||this.opacity2||1);this.opacity2=(typeof bR.opacity2!="undefined")?bR.opacity2:(bR.opacity||this.opacity2||1);this.cycles=bR.cycles||1;this.totalFrames=bV.length*this.cycles;var bU=0,bW=0,bQ=0;this.frames=[];for(var e=0;e<this.totalFrames;e++){bW=e%bV.length;this.frames[e]={x:bV[bW].x||0,y:bV[bW].y||0,z:bV[bW].z||0,time:bV[bW].time||66,image:bV[bW].image,sprite:bV[bW].sprite||false,spriteSize:bV[bW].spriteSize||false,t:bU};bU+=this.frames[e].time;bQ++}if(bR.time&&(bR.time>bU)){this.cycles=Math.ceil(bR.time/bU);this.totalFrames=bV.length*this.cycles;for(var e=bQ;e<this.totalFrames;e++){bW=e%bV.length;this.frames[e]={x:bV[bW].x||0,y:bV[bW].y||0,z:bV[bW].z||0,time:bV[bW].time||66,image:bV[bW].image,sprite:bV[bW].sprite||false,spriteSize:bV[bW].spriteSize||false,t:bU};bU+=this.frames[e].time}}this.frames=new gws.classes.way({points:this.frames,nodeClass:gws.classes.frame});this.audio=bR.audio||false;if(this.audio){bU=this.audio.getLength()}bU=bR.time||bU;this.delay=bR.delay||0;this.startTime=(bR.startTime||bT||new Date().getTime())+this.delay;this.endTime=bR.endTime||this.startTime+bU;this.time=Math.min(this.endTime-this.startTime,bU);this.infiniteCycle=bR.infiniteCycle||false;this.currentFrame.scale=bR.scale;this.currentFrame.scaleX=bR.scaleX;this.currentFrame.scaleY=bR.scaleY;this.currentFrame.offset=(typeof bR.offset=="undefined")?0.5:bR.offset;this.currentFrame.offsetX=(typeof bR.offsetX=="undefined")?this.currentFrame.offset:bR.offsetX;this.currentFrame.offsetY=(typeof bR.offsetY=="undefined")?this.currentFrame.offset:bR.offsetY;this.currentFrame.color=bR.color;this.currentFrame.mirror=bR.mirror;this.currentFrame.clippingRect=bR.clippingRect;this.currentFrame.clippingRegion=bR.clippingRegion;this.destroyOnEnd=bR.remove||false;this.destroyed=false};gws.classes.animation.prototype.update=function(bQ){this.doNotRender=false;this.isDifferent=false;this.updated=bQ||new Date().getTime();var bR=0;if(this.audio){bR=this.audio.getCurrentTime();if(bR>=this.audio.getDuration()){this.audio=false}}if(((bQ>this.endTime)&&(!this.infiniteCycle))||this.interrupt){if(this.interrupt){this.interrupt=false}if(this.nextSequence(bQ)){return}}if(bQ>=this.startTime){var e=Math.min(bR||(bQ-this.startTime),this.time);var bT;if(this.infiniteCycle){bT=this.frames.destination;bT=this.frames.getXYZ((bQ-this.startTime)%(bT.t+bT.time))}else{bT=this.frames.getXYZ(e)}var bS=e/this.time;this.currentFrame.x=(bS*(this.x2-this.x1))+this.x1+bT.node.x+this.relativeX;this.currentFrame.y=(bS*(this.y2-this.y1))+this.y1+bT.node.y+this.relativeY;this.currentFrame.z=(bS*(this.z2-this.z1))+this.z1+bT.node.z;this.currentFrame.imageName=bT.node.image;this.currentFrame.spriteXY=bT.node.sprite;this.currentFrame.spriteSize=bT.node.spriteSize;this.currentFrame.height=(bS*(this.height2-this.height1))+this.height1;this.currentFrame.width=(bS*(this.width2-this.width1))+this.width1;this.currentFrame.radius=(bS*(this.radius2-this.radius1))+this.radius1;this.currentFrame.rotation=(bS*(this.rotation2-this.rotation1))+this.rotation1;this.currentFrame.opacity=(bS*(this.opacity2-this.opacity1))+this.opacity1;if((this.currentFrame.x!=this.lastFrame.x)||(this.currentFrame.y!=this.lastFrame.y)||(this.currentFrame.z!=this.lastFrame.z)||(this.currentFrame.offset!=this.lastFrame.offset)||(this.currentFrame.offsetX!=this.lastFrame.offsetX)||(this.currentFrame.offsetY!=this.lastFrame.offsetY)||(this.currentFrame.imageName!=this.lastFrame.imageName)||(this.currentFrame.spriteXY!=this.lastFrame.spriteXY)||(this.currentFrame.height!=this.lastFrame.height)||(this.currentFrame.width!=this.lastFrame.width)||(this.currentFrame.radius!=this.lastFrame.radius)||(this.currentFrame.rotation!=this.lastFrame.rotation)||(this.currentFrame.mirror!=this.lastFrame.mirror)||(this.currentFrame.opacity!=this.lastFrame.opacity)){this.isDifferent=true}if((bQ>this.endTime)&&this.infiniteCycle){this.nextSequence(bQ)}}else{if(!this.referenceObj){this.doNotRender=true}}};gws.classes.animation.prototype.clear=function(){if(this.layer&&(!this.doNotRender)&&(!this.div)){this.layer.clearRectangle(this.lastFrame)}};gws.classes.animation.prototype.getSpriteSize=function(bQ){var e=bQ.split("-");if(e.length>1){e=e[e.length-1].split(".")[0].split("x");if(e.length>1){return{x:e[0],y:e[1]}}else{return{x:1,y:1}}}else{return{x:1,y:1}}};gws.classes.animation.prototype.render=function(){if(this.layer&&(!this.destroyed)&&(!this.doNotRender)){if(this.div){if(this.isDifferent){if(this.currentFrame.z!=this.lastFrame.z){this.div.style.zIndex=Math.floor(this.currentFrame.z)}if(this.currentFrame.imageName!=this.lastFrame.imageName){var bT=this.currentFrame.assets.images[this.currentFrame.imageName];this.div.style.backgroundImage="url("+bT.src+")";this.bgSize=this.currentFrame.spriteSize||this.getSpriteSize(this.currentFrame.imageName);if(!this.height1&&!this.height2){this.currentFrame.height=((bT.height/this.bgSize.y)/(bT.width/this.bgSize.x))*this.currentFrame.width;this.div.style.height=this.layer.world2windowY(this.currentFrame.height)+"px"}if(!this.width1&&!this.width2){this.currentFrame.width=((bT.width/this.bgSize.x)/(bT.height/this.bgSize.y))*this.currentFrame.height;this.div.style.width=this.layer.world2windowX(this.currentFrame.width)+"px"}this.div.style.backgroundSize=(this.bgSize.x*100)+"%";if(DEBUG){if(!this.currentFrame.assets.images[this.currentFrame.imageName].src){console.warn(this.currentFrame.imageName)}}}if((this.currentFrame.height>0)&&(this.currentFrame.height!=this.lastFrame.height)){this.div.style.height=this.layer.world2windowY(this.currentFrame.height)+"px"}if((this.currentFrame.width>0)&&(this.currentFrame.width!=this.lastFrame.width)){this.div.style.width=this.layer.world2windowX(this.currentFrame.width)+"px"}if(this.currentFrame.spriteXY!=this.lastFrame.spriteXY){var bQ=0;var e=0;if(this.bgSize.x>1){bQ=((100*this.currentFrame.spriteXY.x)/(this.bgSize.x-1))}if(this.bgSize.y>1){e=((100*this.currentFrame.spriteXY.y)/(this.bgSize.y-1))}this.div.style.backgroundPosition=bQ+"% "+e+"%"}if(this.currentFrame.opacity!=this.lastFrame.opacity){this.div.style.opacity=this.currentFrame.opacity}if((this.currentFrame.x!=this.lastFrame.x)||(this.currentFrame.y!=this.lastFrame.y)||(this.currentFrame.rotation!=this.lastFrame.rotation)||(this.currentFrame.mirror!=this.lastFrame.mirror)){var bS="";if(this.currentFrame.mirror=="horizontal"){bS="scale3d(-1,1,1) "}if(this.currentFrame.mirror=="vertical"){bS="scale3d(1,-1,1) "}var bW=this.layer.world2windowX(this.currentFrame.x-(this.currentFrame.offsetX*(this.currentFrame.width||this.div.style.width.replace("px",""))));var bV=this.layer.world2windowY(this.currentFrame.y-(this.currentFrame.offsetY*(this.currentFrame.height||this.div.style.height.replace("px",""))));this.div.style.webkitTransform="translate3D("+bW+"px,"+bV+"px,0px)"+bS+" rotate("+(this.currentFrame.rotation||0)+"rad)";this.div.style.mozTransform="translate3D("+bW+"px,"+bV+"px,0px)"+bS+" rotate("+(this.currentFrame.rotation||0)+"rad)";this.div.style.msTransform="translate3D("+bW+"px,"+bV+"px,0px)"+bS+" rotate("+(this.currentFrame.rotation||0)+"rad)";this.div.style.oTransform="translate3D("+bW+"px,"+bV+"px,0px)"+bS+" rotate("+(this.currentFrame.rotation||0)+"rad)";this.div.style.transform="translate3D("+bW+"px,"+bV+"px,0px)"+bS+" rotate("+(this.currentFrame.rotation||0)+"rad)";if(this.currentFrame.clippingRect){var bR=(this.layer.world2windowX(this.currentFrame.clippingRect.x)-bW);var bX=(this.layer.world2windowY(this.currentFrame.clippingRect.y)-bV);var bY=this.layer.world2windowX(this.currentFrame.clippingRect.width)+bR;var bU=this.layer.world2windowY(this.currentFrame.clippingRect.height)+bX;this.div.style.clip="rect("+bX+"px,"+bY+"px,"+bU+"px,"+bR+"px)"}else{this.div.style.clip="auto"}}}}else{this.layer.drawImage(this.currentFrame)}this.lastFrame.x=this.currentFrame.x;this.lastFrame.y=this.currentFrame.y;this.lastFrame.z=this.currentFrame.z;this.lastFrame.offsetX=this.currentFrame.offsetX;this.lastFrame.offsetY=this.currentFrame.offsetY;this.lastFrame.imageName=this.currentFrame.imageName;this.lastFrame.spriteXY=this.currentFrame.spriteXY;this.lastFrame.height=this.currentFrame.height;this.lastFrame.width=this.currentFrame.width;this.lastFrame.radius=this.currentFrame.radius;this.lastFrame.rotation=this.currentFrame.rotation;this.lastFrame.opacity=this.currentFrame.opacity;this.lastFrame.mirror=this.currentFrame.mirror}};gws.classes.animation.prototype.getZIndex=function(){return this.currentFrame.z||0};gws.classes=gws.classes||{};gws.classes.animationManager=function(e,bR,bQ){this.layer=e;this.assets=bR;this.animations=[];this.usingDivs=!e.context;this.zIndexed=false;this.onQuiet=bQ};gws.classes.animationManager.prototype.animate=function(bQ){var bR=false;if(bQ.object){for(var e in this.animations){if(this.animations[e].referenceObj==bQ.object){if((!this.animations[e].id&&!bQ.id)||(this.animations[e].id==bQ.id)){bR=this.animations[e];break}}}}if(bR){if(bQ.replace){bR.replaceSequence([bQ])}else{if(bQ.interrupt){bQ.interrupt=false;bR.interruptSequence([bQ])}else{bR.addSequence(bQ)}}return bR}else{return this.add(bQ)}};gws.classes.animationManager.prototype.addSequence=function(bR){var bQ=this.add(bR[0]);for(var e=1;e<bR.length;e++){bQ.addSequence(bR[e])}};gws.classes.animationManager.prototype.animateList=function(bQ){for(var e=0;e<bQ.length;e++){this.animate(bQ[e])}};gws.classes.animationManager.prototype.replaceSequence=function(bR){bR[0].replace=true;var bQ=this.animate(bR[0]);for(var e=1;e<bR.length;e++){bQ.addSequence(bR[e])}};gws.classes.animationManager.prototype.interruptSequence=function(bR){bR[0].interrupt=true;var bQ=this.animate(bR[0]);for(var e=1;e<bR.length;e++){bQ.addSequence(bR[e])}};gws.classes.animationManager.prototype.add=function(bR){if(bR.z||bR.z1||bR.z2){this.zIndexed=true}if(bR.relative){var e=this.getAnimationByObject(bR.relative);if(e){bR.relativeX=e.currentFrame.x;bR.relativeY=e.currentFrame.y}}var bQ=new gws.classes.animation(bR,this.layer,this.assets);this.animations.splice(0,0,bQ);return bQ};gws.classes.animationManager.prototype.remove=function(bQ){var e=[];for(x in this.animations){if(bQ!=this.animations[x]){e.push(this.animations[x])}else{if(this.usingDivs){this.layer.canvas.removeChild(this.animations[x].div)}}}this.animations=e};gws.classes.animationManager.prototype.sort=function(){this.animations.sort(function(bQ,e){return bQ.getZIndex()-e.getZIndex()})};gws.classes.animationManager.prototype.update=function(){var e=true;var bQ=new Date().getTime();for(var bR in this.animations){if(this.updateAnimation(this.animations[bR],bQ).isDifferent){e=false}}if(e){if(this.onQuiet){this.onQuiet()}this.onQuiet=false}return e};gws.classes.animationManager.prototype.getAnimationByObject=function(bQ){var bR;for(var e in this.animations){bR=this.animations[e];if(bR.referenceObj==bQ){return bR}}return false};gws.classes.animationManager.prototype.updateAnimationByObject=function(bQ,e){var bR=this.getAnimationByObject(bQ);if(bR){return this.updateAnimation(bR,e)}};gws.classes.animationManager.prototype.updateAnimation=function(bR,bQ){var e;if(bR.updated!=bQ){if(bR.relative){e=this.updateAnimationByObject(bR.relative,bQ);if(e){bR.relativeX=e.currentFrame.x;bR.relativeY=e.currentFrame.y}else{bR.relativeX=0;bR.relativeY=0}}bR.update(bQ)}return bR};gws.classes.animationManager.prototype.clear=function(){for(var e in this.animations){this.animations[e].clear()}};gws.classes.animationManager.prototype.render=function(){var e=[];if(this.zIndexed){this.sort()}for(var bQ=0;bQ<this.animations.length;bQ++){if(this.animations[bQ].destroyed){e.push(this.animations[bQ])}else{this.animations[bQ].render()}}for(var bQ in e){this.remove(e[bQ])}};gws.classes.animationManager.prototype.removeObject=function(bQ,bR){for(var e in this.animations){if((this.animations[e].referenceObj==bQ)&&(bR?(this.animations[e].id==bR):true)){this.animations[e].destroyOnEnd=true}}};gws.classes.animationManager.prototype.removeObjectNow=function(bQ,bR){for(var e in this.animations){if((this.animations[e].referenceObj==bQ)&&(bR?(this.animations[e].id==bR):true)){this.animations[e].destroyNow=true}}};gws.classes.animationManager.prototype.removeAll=function(bQ,bR){for(var e in this.animations){this.animations[e].clear();if(this.usingDivs){this.layer.canvas.removeChild(this.animations[e].div)}}this.animations=[]};gws.classes=gws.classes||{};gws.classes.audio=function(e){var bQ=e||{};this.sound=bQ.sound;this.instances=bQ.instances||1;this.start=bQ.start||0;this.length=bQ.length||0;this.end=bQ.end||(bQ.start+bQ.length);if(this.end<=this.start){this.end=0}if(this.end&&!this.length){this.length=this.end-this.start}};gws.classes.audio.prototype.play=function(){try{this.sound.currentTime=this.start;if(this.sound.seekTo){this.sound.seekTo(this.start*1000)}this.sound.play()}catch(bQ){}};gws.classes.audio.prototype.update=function(){var bQ=this.sound.currentTime,bR=this.sound.ended,e=this;if(this.sound.getCurrentPosition){this.sound.getCurrentPosition(function(bS){if((e.end&&(bS>=e.end))||(e.sound.getDuration()<=bS)){e.stop();return true}else{return false}})}else{if((this.end&&(bQ>=this.end))||bR){this.stop();return true}else{return false}}};gws.classes.audio.prototype.pause=function(){try{this.sound.pause()}catch(bQ){}};gws.classes.audio.prototype.stop=function(){try{this.sound.pause()}catch(bQ){}};gws.classes.audio.prototype.getCurrentTime=function(){var e=this.sound.currentTime;if(this.sound.getCurrentPosition){e=this.sound.getCurrentPosition()}return Math.min(this.length||999999,Math.max(0,(e-this.start)))*1000};gws.classes.audio.prototype.getDuration=function(){return(this.end-this.start)*1000};gws.classes.audio.prototype.getLength=function(){return this.length*1000};gws.classes.audio.prototype.setVolume=function(bQ){try{this.sound.volume=bQ}catch(bR){}};gws.classes=gws.classes||{};gws.classes.audioManager=function(bS){this.time=0;var bQ=bS||{};this.musicMuted=bQ.musicMuted||bQ.muted||false;this.musicMutedByCode=bQ.musicStartMuted||false;this.sfxMuted=bQ.sfxMuted||bQ.muted||false;this.sfxMutedByCode=bQ.sfxStartMuted||false;this.assets=bQ.assets||false;this.musicOffset=bQ.musicOffset||false;this.offsetTracks=bQ.offsetTracks||false;this.sounds=bQ.sounds||[];this.onPlayMusic=bQ.onPlayMusic||false;this.onMuteMusic=bQ.onMuteMusic||false;this.onPlaySFX=bQ.onPlaySFX||false;this.onMuteSFX=bQ.onMuteSFX||false;this.musicFade=100;this.musicVolume=100;this.delayedSounds=[];this.playingSounds=[];for(var bW in this.assets.sounds){this.sounds[bW]=new gws.classes.audio({sound:this.assets.getSound(bW),layer:"sfx",manager:this})}this.musicTracks=[];this.currentTrack=0;if(bQ.musicTracks){for(var bT in bQ.musicTracks){this.musicTracks[bT]=[];for(var bR in bQ.musicTracks[bT]){this.musicTracks[bT][bR]=this.sounds[bQ.musicTracks[bT][bR]];if(!this.musicTracks[bT][bR]){this.musicMutedByCode=true}}}}else{if(bQ.musicTrack){this.musicTracks[0]=[this.sounds[bQ.musicTrack]];if(!this.musicTracks[0]){this.musicMutedByCode=true}}}var bX=this,e=function(){bX.sfxMutedByCode=true;bX.muteMusic(true);bX.stop()},bV=function(){bX.sfxMutedByCode=false;bX.musicMutedByCode=false},bU=function(){if(document.webkitHidden||document.mozHidden||document.msHidden||document.hidden){e()}else{bV()}};window.addEventListener("pagehide",e,false);window.addEventListener("pageshow",bV,false);window.addEventListener("webkitvisibilitychange",bU,false);window.addEventListener("mozvisibilitychange",bU,false);window.addEventListener("msvisibilitychange",bU,false);window.addEventListener("visibilitychange",bU,false)};gws.classes.audioManager.prototype.addSoundSegment=function(bT,bQ,bR,bS,e){this.sounds[bQ]=new gws.classes.audio({sound:this.sounds[bT].sound,start:bR,length:bS,end:e,layer:"sfx",manager:this})};gws.classes.audioManager.prototype.update=function(){if(this.musicFade!=this.musicVolume){if(this.musicFade>this.musicVolume){this.musicVolume+=1}else{this.musicVolume-=1}this.musicTracks[0][0].setVolume(this.musicVolume/100)}if((this.musicMuted||this.musicMutedByCode)||!this.musicOffset){this.time=0}else{var bR=new Date().getTime();var bS=(bR-this.time);if(!this.time){this.time=bR-this.musicOffset}if(bS>=this.musicOffset){this.time+=this.musicOffset;if(this.offsetTracks){this.musicTracks[this.currentTrack][Math.floor(Math.random()*this.musicTracks[this.currentTrack].length)].play();this.currentTrack=(this.currentTrack+1)%this.musicTracks.length}else{for(var bT in this.musicTracks){this.musicTracks[bT][Math.floor(Math.random()*this.musicTracks[bT].length)].play()}}}}var e=new Date().getTime();for(soundIndex in this.delayedSounds){if(this.delayedSounds[soundIndex].when<e){this.play(this.delayedSounds[soundIndex].sound,0,this.delayedSounds[soundIndex].override);this.delayedSounds.splice(soundIndex,1);break}}if(this.playingSounds.length>0){var bQ=[];for(soundIndex in this.playingSounds){if(!this.playingSounds[soundIndex].update()){bQ.push(this.playingSounds[soundIndex])}}this.playingSounds=bQ}};gws.classes.audioManager.prototype.muteMusic=function(bQ){if(bQ){this.musicMutedByCode=true}else{this.musicMuted=true;if(this.onMuteMusic){this.onMuteMusic()}}for(var bR in this.musicTracks){for(var e in this.musicTracks[bR]){if(this.musicTracks[bR][e]){this.musicTracks[bR][e].stop()}}}};gws.classes.audioManager.prototype.muteSFX=function(){this.sfxMuted=true;if(this.onMuteSFX){this.onMuteSFX()}};gws.classes.audioManager.prototype.playMusic=function(){this.musicMuted=false;if(this.onPlayMusic){this.onPlayMusic()}};gws.classes.audioManager.prototype.fadeMusic=function(e){this.musicFade=e};gws.classes.audioManager.prototype.playSFX=function(){this.sfxMuted=false;if(this.onPlaySFX){this.onPlaySFX()}};gws.classes.audioManager.prototype.toggleMusic=function(){if(this.musicMuted){this.playMusic()}else{this.muteMusic()}};gws.classes.audioManager.prototype.toggleSFX=function(){if(this.sfxMuted){this.playSFX()}else{this.muteSFX()}};gws.classes.audioManager.prototype.play=function(bS,bR,e){var bQ=(typeof(bS)=="string")?this.sounds[bS]:bS;if(bQ){if(bR){this.delayedSounds.push({sound:bQ,when:new Date().getTime()+bR,override:e||false})}else{if(this.sfxMuted?false:(e?true:(this.sfxMutedByCode?false:true))){if(bQ.end){this.stop(bQ.sound);this.playingSounds.push(bQ)}bQ.play()}}}else{if(window.console){console.warn("Couldn't play '"+bS+"'; it's not a loaded sound.")}}};gws.classes.audioManager.prototype.stop=function(bR){if(this.playingSounds.length>0){var e=[];for(var bQ in this.playingSounds){if(bR&&(this.playingSounds[bQ].sound!=bR)){e.push(this.playingSounds[bQ])}else{this.playingSounds[bQ].stop()}}this.playingSounds=e}};gws.enableAudio=function(bQ){var e=bQ||{},bS=e.element,bU=e.audio,bR=e.onEnd||function(){},bV=false,bT=false;bT=function(bY){var bX=function(){bU.removeEventListener("play",bX,false);bU.pause();bS.removeEventListener("touchstart",bT,false);bR()},bW=function(){bU.removeEventListener("canplaythrough",bW,false);if(bV){bV()}};bU.addEventListener("play",bX,false);bU.addEventListener("canplaythrough",bW,false);try{bU.play()}catch(bY){bV=function(){bV=false;bU.play()}}};bS.addEventListener("touchstart",bT,false)};try{if(top.location!=location){var bf=function(){var bQ=window.location.href;var e=bQ.split("/")[2];window.location="http://gopherwoodstudios.com/w/?g="+e};try{document.domain=/(\w+)(.\w+)?$/.exec(location.hostname)[0];if(parent.document.domain!=document.domain){bf()}}catch(a5){bf()}}}catch(a5){}window.Modernizr=function(cm,cl,ck){function bQ(e){cd.cssText=e}function b7(cn,e){return bQ(ca.join(cn+";")+(e||""))}function b5(cn,e){return typeof cn===e}function b3(cn,e){return !!~(""+cn).indexOf(e)}function b1(co,cn){for(var cq in co){var cp=co[cq];if(!b3(cp,"-")&&cd[cp]!==ck){return cn=="pfx"?cp:!0}}return !1}function bZ(co,cn,cr){for(var cq in co){var cp=cn[co[cq]];if(cp!==ck){return cr===!1?co[cq]:b5(cp,"function")?cp.bind(cr||cn):cp}}return !1}function bX(co,cn,cr){var cq=co.charAt(0).toUpperCase()+co.slice(1),cp=(co+" "+b8.join(cq+" ")+cq).split(" ");return b5(cn,"string")||b5(cn,"undefined")?b1(cp,cn):(cp=(co+" "+b6.join(cq+" ")+cq).split(" "),bZ(cp,cn,cr))}var cj="2.6.2",ci={},ch=!0,cg=cl.documentElement,cf="modernizr",ce=cl.createElement(cf),cd=ce.style,cc,cb={}.toString,ca=" -webkit- -moz- -o- -ms- ".split(" "),b9="Webkit Moz O ms",b8=b9.split(" "),b6=b9.toLowerCase().split(" "),b4={},b2={},b0={},bY=[],bW=bY.slice,bV,bT=function(cx,cw,cv,cu){var ct,cs,cr,cq,cp=cl.createElement("div"),co=cl.body,cn=co||cl.createElement("body");if(parseInt(cv,10)){while(cv--){cr=cl.createElement("div"),cr.id=cu?cu[cv]:cf+(cv+1),cp.appendChild(cr)}}return ct=["&#173;",'<style id="s',cf,'">',cx,"</style>"].join(""),cp.id=cf,(co?cp:cn).innerHTML+=ct,cn.appendChild(cp),co||(cn.style.background="",cn.style.overflow="hidden",cq=cg.style.overflow,cg.style.overflow="hidden",cg.appendChild(cn)),cs=cw(cp,cx),co?cp.parentNode.removeChild(cp):(cn.parentNode.removeChild(cn),cg.style.overflow=cq),!!cs},bS={}.hasOwnProperty,bR;!b5(bS,"undefined")&&!b5(bS.call,"undefined")?bR=function(cn,e){return bS.call(cn,e)}:bR=function(cn,e){return e in cn&&b5(cn.constructor.prototype[e],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(cn){var cq=this;if(typeof cq!="function"){throw new TypeError}var cp=bW.call(arguments,1),co=function(){if(this instanceof co){var e=function(){};e.prototype=cq.prototype;var cs=new e,cr=cq.apply(cs,cp.concat(bW.call(arguments)));return Object(cr)===cr?cr:cs}return cq.apply(cn,cp.concat(bW.call(arguments)))};return co}),b4.csstransforms3d=function(){var e=!!bX("perspective");return e&&"webkitPerspective" in cg.style&&bT("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(cn,co){e=cn.offsetLeft===9&&cn.offsetHeight===3}),e};for(var bU in b4){bR(b4,bU)&&(bV=bU.toLowerCase(),ci[bV]=b4[bU](),bY.push((ci[bV]?"":"no-")+bV))}return ci.addTest=function(cn,e){if(typeof cn=="object"){for(var co in cn){bR(cn,co)&&ci.addTest(co,cn[co])}}else{cn=cn.toLowerCase();if(ci[cn]!==ck){return ci}e=typeof e=="function"?e():e,typeof ch!="undefined"&&ch&&(cg.className+=" "+(e?"":"no-")+cn),ci[cn]=e}return ci},bQ(""),ce=cc=null,function(cE,cD){function cu(cF,e){var cH=cF.createElement("p"),cG=cF.getElementsByTagName("head")[0]||cF.documentElement;return cH.innerHTML="x<style>"+e+"</style>",cG.insertBefore(cH.lastChild,cG.firstChild)}function ct(){var e=cn.elements;return typeof e=="string"?e.split(" "):e}function cs(cF){var e=cw[cF[cy]];return e||(e={},cx++,cF[cy]=cx,cw[cx]=e),e}function cr(e,cH,cG){cH||(cH=cD);if(cv){return cH.createElement(e)}cG||(cG=cs(cH));var cF;return cG.cache[e]?cF=cG.cache[e].cloneNode():cA.test(e)?cF=(cG.cache[e]=cG.createElem(e)).cloneNode():cF=cG.createElem(e),cF.canHaveChildren&&!cB.test(e)?cG.frag.appendChild(cF):cF}function cq(cF,cK){cF||(cF=cD);if(cv){return cF.createDocumentFragment()}cK=cK||cs(cF);var cJ=cK.frag.cloneNode(),cI=0,cH=ct(),cG=cH.length;for(;cI<cG;cI++){cJ.createElement(cH[cI])}return cJ}function cp(cF,e){e.cache||(e.cache={},e.createElem=cF.createElement,e.createFrag=cF.createDocumentFragment,e.frag=e.createFrag()),cF.createElement=function(cG){return cn.shivMethods?cr(cG,cF,e):e.createElem(cG)},cF.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+ct().join().replace(/\w+/g,function(cG){return e.createElem(cG),e.frag.createElement(cG),'c("'+cG+'")'})+");return n}")(cn,e.frag)}function co(e){e||(e=cD);var cF=cs(e);return cn.shivCSS&&!cz&&!cF.hasCSS&&(cF.hasCSS=!!cu(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),cv||cp(e,cF),e}var cC=cE.html5||{},cB=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,cA=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,cz,cy="_html5shiv",cx=0,cw={},cv;(function(){try{var e=cD.createElement("a");e.innerHTML="<xyz></xyz>",cz="hidden" in e,cv=e.childNodes.length==1||function(){cD.createElement("a");var cG=cD.createDocumentFragment();return typeof cG.cloneNode=="undefined"||typeof cG.createDocumentFragment=="undefined"||typeof cG.createElement=="undefined"}()}catch(cF){cz=!0,cv=!0}})();var cn={elements:cC.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:cC.shivCSS!==!1,supportsUnknownElements:cv,shivMethods:cC.shivMethods!==!1,type:"default",shivDocument:co,createElement:cr,createDocumentFragment:cq};cE.html5=cn,co(cD)}(this,cl),ci._version=cj,ci._prefixes=ca,ci._domPrefixes=b6,ci._cssomPrefixes=b8,ci.testProp=function(e){return b1([e])},ci.testAllProps=bX,ci.testStyles=bT,cg.className=cg.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(ch?" js "+bY.join(" "):""),ci}(this,this.document),function(ch,cg,cf){function ce(e){return"[object Function]"==b3.call(e)}function cd(e){return"string"==typeof e}function cc(){}function cb(e){return !e||"loaded"==e||"complete"==e||"uninitialized"==e}function ca(){var e=b2.shift();b0=1,e?e.t?b5(function(){("c"==e.t?bZ.injectCss:bZ.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),ca()):b0=0}function b9(cs,cr,cq,cp,co,cn,cm){function cl(e){if(!cj&&cb(ck.readyState)&&(ct.r=cj=1,!b0&&ca(),ck.onload=ck.onreadystatechange=null,e)){"img"!=cs&&b5(function(){bW.removeChild(ck)},50);for(var cu in bR[cr]){bR[cr].hasOwnProperty(cu)&&bR[cr][cu].onload()}}}var cm=cm||bZ.errorTimeout,ck=cg.createElement(cs),cj=0,ci=0,ct={t:cq,s:cr,e:co,a:cn,x:cm};1===bR[cr]&&(ci=1,bR[cr]=[]),"object"==cs?ck.data=cr:(ck.src=cr,ck.type=cs),ck.width=ck.height="0",ck.onerror=ck.onload=ck.onreadystatechange=function(){cl.call(this,ci)},b2.splice(cp,0,ct),"img"!=cs&&(ci||2===bR[cr]?(bW.insertBefore(ck,bX?null:b4),b5(cl,cm)):bR[cr].push(ck))}function b8(ci,e,cl,ck,cj){return b0=0,e=e||"j",cd(ci)?b9("c"==e?bU:bV,ci,e,this.i++,cl,ck,cj):(b2.splice(this.i++,0,ci),1==b2.length&&ca()),this}function b7(){var e=bZ;return e.loader={load:b8,i:0},e}var b6=cg.documentElement,b5=ch.setTimeout,b4=cg.getElementsByTagName("script")[0],b3={}.toString,b2=[],b0=0,bY="MozAppearance" in b6.style,bX=bY&&!!cg.createRange().compareNode,bW=bX?b6:b4.parentNode,b6=ch.opera&&"[object Opera]"==b3.call(ch.opera),b6=!!cg.attachEvent&&!b6,bV=bY?"object":b6?"script":"img",bU=b6?"script":bV,bT=Array.isArray||function(e){return"[object Array]"==b3.call(e)},bS=[],bR={},bQ={timeout:function(ci,e){return e.length&&(ci.timeout=e[0]),ci}},b1,bZ;bZ=function(cj){function e(cp){var cp=cp.split("!"),co=bS.length,cu=cp.pop(),ct=cp.length,cu={url:cu,origUrl:cu,prefixes:cp},cs,cr,cq;for(cr=0;cr<ct;cr++){cq=cp[cr].split("="),(cs=bQ[cq.shift()])&&(cu=cs(cu,cq))}for(cr=0;cr<co;cr++){cu=bS[cr](cu)}return cu}function cn(co,cu,ct,cs,cr){var cq=e(co),cp=cq.autoCallback;cq.url.split(".").pop().split("?").shift(),cq.bypass||(cu&&(cu=ce(cu)?cu:cu[co]||cu[cs]||cu[co.split("/").pop().split("?")[0]]),cq.instead?cq.instead(co,cu,ct,cs,cr):(bR[cq.url]?cq.noexec=!0:bR[cq.url]=1,ct.load(cq.url,cq.forceCSS||!cq.forceJS&&"css"==cq.url.split(".").pop().split("?").shift()?"c":cf,cq.noexec,cq.attrs,cq.timeout),(ce(cu)||ce(cp))&&ct.load(function(){b7(),cu&&cu(cq.origUrl,cr,cs),cp&&cp(cq.origUrl,cr,cs),bR[cq.url]=2})))}function cm(cx,cw){function cv(cy,cz){if(cy){if(cd(cy)){cz||(cs=function(){var cA=[].slice.call(arguments);cr.apply(this,cA),cq()}),cn(cy,cs,cw,0,cu)}else{if(Object(cy)===cy){for(co in cp=function(){var cA=0,cB;for(cB in cy){cy.hasOwnProperty(cB)&&cA++}return cA}(),cy){cy.hasOwnProperty(co)&&(!cz&&!--cp&&(ce(cs)?cs=function(){var cA=[].slice.call(arguments);cr.apply(this,cA),cq()}:cs[co]=function(cA){return function(){var cB=[].slice.call(arguments);cA&&cA.apply(this,cB),cq()}}(cr[co])),cn(cy[co],cs,cw,co,cu))}}}}else{!cz&&cq()}}var cu=!!cx.test,ct=cx.load||cx.both,cs=cx.callback||cc,cr=cs,cq=cx.complete||cc,cp,co;cv(cu?cx.yep:cx.nope,!!ct),ct&&cv(ct)}var cl,ck,ci=this.yepnope.loader;if(cd(cj)){cn(cj,0,ci,0)}else{if(bT(cj)){for(cl=0;cl<cj.length;cl++){ck=cj[cl],cd(ck)?cn(ck,0,ci,0):bT(ck)?bZ(ck):Object(ck)===ck&&cm(ck,ci)}}else{Object(cj)===cj&&cm(cj,ci)}}},bZ.addPrefix=function(ci,e){bQ[ci]=e},bZ.addFilter=function(e){bS.push(e)},bZ.errorTimeout=10000,null==cg.readyState&&cg.addEventListener&&(cg.readyState="loading",cg.addEventListener("DOMContentLoaded",b1=function(){cg.removeEventListener("DOMContentLoaded",b1,0),cg.readyState="complete"},0)),ch.yepnope=b7(),ch.yepnope.executeStack=ca,ch.yepnope.injectJs=function(cq,cp,co,cn,cm,cl){var ck=cg.createElement("script"),cj,ci,cn=cn||bZ.errorTimeout;ck.src=cq;for(ci in co){ck.setAttribute(ci,co[ci])}cp=cl?ca:cp||cc,ck.onreadystatechange=ck.onload=function(){!cj&&cb(ck.readyState)&&(cj=1,cp(),ck.onload=ck.onreadystatechange=null)},b5(function(){cj||(cj=1,cp(1))},cn),cm?ck.onload():b4.parentNode.insertBefore(ck,b4)},ch.yepnope.injectCss=function(ci,co,cn,cm,cl,ck){var cm=cg.createElement("link"),cj,co=ck?ca:co||cc;cm.href=ci,cm.rel="stylesheet",cm.type="text/css";for(cj in cn){cm.setAttribute(cj,cn[cj])}cl||(b4.parentNode.insertBefore(cm,b4),b5(co,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};(function(){var bT=navigator.userAgent.toLowerCase(),e=(bT.search("ipod")>-1),bY=(bT.search("iphone")>-1),b1=(bT.search("ipad")>-1),bR=(bT.search("safari")>-1),bQ=(bT.search("msie")>-1),bS=(bT.search("android")>-1),bZ=(bT.search("silk")>-1),b3=(bT.search("(khtml, like gecko) u/")>-1),bX=(bT.search("firefox")>-1),bW=(bT.search("chrome")>-1)||(bT.search("crios")>-1),bV=document.createElement("audio"),b0=document.documentElement,bU=true,b2=true;if((bV.canPlayType)&&!(!!bV.canPlayType&&""!=bV.canPlayType('audio/ogg; codecs="vorbis"'))){bU=false;if(bQ||!(!!bV.canPlayType&&""!=bV.canPlayType("audio/mp4"))){b2=false}}gws.browserCheck=function(){var b5={canvas:false,mobile:false,transitions:false,progress:false,css3dTransforms:false,touch:!!("ontouchstart" in window),chrome:bW,iPod:e,iPhone:bY,iPad:b1,iOS:e||bY||b1,safari:bR,ie:bQ,android:bS,silk:bZ,firefox:bX,packaged:(document.URL.indexOf("http://")===-1),phonegap:(document.URL.indexOf("http://")===-1)&&(document.URL.indexOf("app://")===-1)&&(document.URL.indexOf("chrome-extension://")===-1),conduitTilt:b3,ogg:bU,m4a:b2};var b4=document.createElement("canvas");try{b5.canvas=!!(b4.getContext("2d"))}catch(b6){b5.canvas=!!(b4.getContext)}delete b4;var b7=document.createElement("div");b5.transitions=(b7.style.transition!==undefined)||(b7.style.webkitTransition!==undefined)||(b7.style.MozTransition!==undefined)||(b7.style.OTransition!==undefined)||(b7.style.msTransition!==undefined);delete b7;b5.css3dTransforms=Modernizr.csstransforms3d;b5.progress=("position" in document.createElement("progress"));b5.mobile=b5.touch;return b5}})();gws.classes.button=function(bU,bR,bT,bQ){bT=bT||"";bR=bR||"";this.base=gws.createElement(bU,"div",bR,bT);this.layers=[];for(var e=0;e<bQ.length;e++){var bV=bQ[e];bV.id=bV.id||e;bV.generalStyle=bV.generalStyle||"button-default";bV.specificStyle=bV.specificStyle||"";bV.textStyle=bV.textStyle||"";this.layers[bV.id]=gws.createElement(this.base,"div",bV.generalStyle,bV.specificStyle);if(bV.image){var bS=bV.image;bS.style.width="100%";bS.style.height="100%";this.layers[bV.id].appendChild(bS)}if(bV.altText){this.layers[bV.id].setAttribute("title",bV.altText)}if(bV.text){this.layers[bV.id].textElement=gws.createTextBlock(this.layers[bV.id],"div",bV.textStyle,false,bV.text)}if(bV.onClickFunction){this.layers[bV.id].onclick=bV.onClickFunction}if(bV.onMouseOverFunction){this.layers[bV.id].onmouseover=bV.onMouseOverFunction}if(bV.onMouseOutFunction){this.layers[bV.id].onmouseout=bV.onMouseOutFunction}}gws.classes.button.prototype.hide=function(){this.base.style.display="none"};gws.classes.button.prototype.show=function(){this.base.style.display="block"};gws.classes.button.prototype.hideLayer=function(bW){this.layers[bW].style.display="none"};gws.classes.button.prototype.showLayer=function(bW){this.layers[bW].style.display="block"};gws.classes.button.prototype.setText=function(bX,bW){if(this.layers[bX].textElement){this.layers[bX].textElement.innerHTML=bW}else{this.layers[bX].textElement=gws.createTextBlock(this.layers[bX],"div",false,false,bW)}}};gws.draw={boundingbox:function(bQ,bT,e){var bU=Math.PI;while(e<0){e+=(bU*2)}var bS=Math.cos(e);var bR=Math.sin(e);switch(Math.floor(e/(bU/2))%4){case 0:return{width:bT*bR+bQ*bS,height:bT*bS+bQ*bR};case 1:return{width:bT*bR-bQ*bS,height:-bT*bS+bQ*bR};case 2:return{width:-bT*bR-bQ*bS,height:-bT*bS-bQ*bR};case 3:return{width:-bT*bR+bQ*bS,height:bT*bS-bQ*bR}}},clear:function(bU){var b0=bU||{};var b1=b0.context||false;var b7=b0.scale||1;var b6=b0.scaleX||b7;var b5=b0.scaleY||b7;var bT=(typeof b0.offset=="undefined")?0.5:b0.offset;var b4=(typeof b0.offsetX=="undefined")?bT:b0.offsetX;var b3=(typeof b0.offsetY=="undefined")?bT:b0.offsetY;var bW=b6*gws.choose(b0.lastX,b0.x,0);var bV=b5*gws.choose(b0.lastY,b0.y,0);var b2=gws.choose(b0.lastRotation,b0.rotate,b0.rotation,0);var bX=b0.lastMirror||b0.mirror||false;var bR=b7*gws.choose(b0.lastRadius,b0.radius,0);var bZ=gws.choose(b0.lastWidth,b0.width,bR*2,0);var bY=gws.choose(b0.lastHeight,b0.height,bR*2,0);if(b2){var bS=this.boundingbox(bZ,bY,b2);bZ=bS.width;bY=bS.height}bZ=bZ*b6+((b2||bX)?8:0);bY=bY*b5+((b2||bX)?8:0);var bQ=bW-b4*bZ;var e=bV-b3*bY;if(b1){b1.clearRect(Math.floor(bQ),Math.floor(e),Math.ceil(bZ),Math.ceil(bY))}},circle:function(bU){var b3=bU||{};var b4=b3.context||false;var cd=b3.scale||1;var cc=b3.scaleX||cd;var cb=b3.scaleY||cd;var bT=(typeof b3.offset=="undefined")?0.5:b3.offset;var b9=(typeof b3.offsetX=="undefined")?bT:b3.offsetX;var b8=(typeof b3.offsetY=="undefined")?bT:b3.offsetY;var bW=cc*(b3.x||0);var bV=cb*(b3.y||0);var bS=cd*(b3.radius||0);var b1=cc*(b3.width||bS*2||0);var bZ=cb*(b3.height||bS*2||0);var b6=b3.rotate||b3.rotation||0;var b5=b3.color||false;var bX=b3.mirror||false;var bR=(typeof b3.opacity!="undefined")?b3.opacity:1;var b7=b3.assets||false;var ca=b3.imageName||false;var b2=b3.spriteXY||false;if((!b2)&&(typeof b3.spriteX!="undefined")&&(typeof b3.spriteY!="undefined")){b2={x:b3.spriteX,y:b3.spriteY}}var bY=b3.image||((b7&&ca)?(b2?b7.getTile(ca,b2.x,b2.y,b1,bZ):b7.getImage(ca,b1,bZ)):false);if(bY){if(bY.width>bY.height){bZ=b1*bY.height/bY.width}else{b1=bZ*bY.width/bY.height}}var bQ=bW-b9*b1;var e=bV-b8*bZ;if(b4){b4.save();if(b6){b4.translate(bW,bV);b4.rotate(b6);b4.translate(-bW,-bV)}if(b5){b4.fillStyle=b5;b4.beginPath();b4.arc(bQ,e,bS,0,2*Math.PI,true);b4.fill()}b4.globalAlpha=bR;if(bY){if(bX){var b0=0;if(bX=="horizontal"){b0=Math.round(bW*2)/2;b4.translate(b0,0);b4.scale(-1,1);b4.translate(-b0,0)}else{if(bX=="vertical"){b0=Math.round(bV*2)/2;b4.translate(0,b0);b4.scale(1,-1);b4.translate(0,-b0)}}}b4.drawImage(bY,0,0,bY.width,bY.height,Math.floor(bQ),Math.floor(e),Math.ceil(b1),Math.ceil(bZ))}b4.restore()}},rectangle:function(bW){var b0=0,bZ=0,cn=0,bT=0;var ce=[];var b9=bW||{};var ca=b9.context||false;var co=b9.scale||1;var cm=b9.scaleX||co;var cl=b9.scaleY||co;var bV=(typeof b9.offset=="undefined")?0.5:b9.offset;var ci=(typeof b9.offsetX=="undefined")?bV:b9.offsetX;var cg=(typeof b9.offsetY=="undefined")?bV:b9.offsetY;var bY=cm*(b9.x||0);var bX=cl*(b9.y||0);var bU=co*(b9.radius||0);var b7=cm*(b9.width||bU*2||0);var b3=cl*(b9.height||bU*2||0);var b5=!!b9.clippingRect;if(b5){b0=cm*(b9.clippingRect.x||0);bZ=cl*(b9.clippingRect.y||0);cn=cm*(b9.clippingRect.width||0);bT=cl*(b9.clippingRect.height||0);if((cn<=0)||(bT<=0)){return}}var b4=!!b9.clippingRegion;if(b4){for(var ck=0;ck<b9.clippingRegion.length;ck++){ce[ck]=[];ce[ck][0]=cm*b9.clippingRegion[ck][0];ce[ck][1]=cl*b9.clippingRegion[ck][1]}}var cd=b9.rotate||b9.rotation||0;var cb=b9.color||false;var b1=b9.mirror||false;var bS=(typeof b9.opacity!="undefined")?b9.opacity:1;var cf=b9.assets||false;var cj=b9.imageName||false;var b8=b9.spriteXY||false;if((!b8)&&(typeof b9.spriteX!="undefined")&&(typeof b9.spriteY!="undefined")){b8={x:b9.spriteX,y:b9.spriteY}}var b2=b9.image||((cf&&cj)?(b8?cf.getTile(cj,b8.x,b8.y,b7,b3):cf.getImage(cj,b7,b3)):false);if(!b7){b9.width=Math.round((b2.width/cm)*(b3/b2.height)*1000)/1000;b7=cm*b9.width;b2=b9.image||((cf&&cj)?(b8?cf.getTile(cj,b8.x,b8.y,b7,b3):cf.getImage(cj,b7,b3)):false)}if(!b3){b9.height=Math.round((b2.height/cl)*(b7/b2.width)*1000)/1000;b3=cl*b9.height;b2=b9.image||((cf&&cj)?(b8?cf.getTile(cj,b8.x,b8.y,b7,b3):cf.getImage(cj,b7,b3)):false)}var bR=bY-ci*b7;var bQ=bX-cg*b3;if(ca){ca.save();if(b5){ca.beginPath();ca.rect(b0,bZ,cn,bT);ca.closePath();ca.clip()}if(b4){ca.beginPath();for(var cc=0;cc<ce.length;cc++){if(cc==0){ca.moveTo(ce[cc][0],ce[cc][1])}else{ca.lineTo(ce[cc][0],ce[cc][1])}}ca.closePath();ca.clip()}if(cd){ca.translate(bY,bX);ca.rotate(cd);ca.translate(-bY,-bX)}if(cb){ca.beginPath();ca.fillStyle=cb;ca.rect(Math.floor(bR),Math.floor(bQ),Math.ceil(b7),Math.ceil(b3));ca.fill()}ca.globalAlpha=bS;if(b2){if(b1){var b6=0;if(b1=="horizontal"){b6=Math.round(bY*2)/2;ca.translate(b6,0);ca.scale(-1,1);ca.translate(-b6,0)}else{if(b1=="vertical"){b6=Math.round(bX*2)/2;ca.translate(0,b6);ca.scale(1,-1);ca.translate(0,-b6)}}}try{ca.drawImage(b2,0,0,b2.naturalWidth||b2.width,b2.naturalHeight||b2.height,Math.floor(bR),Math.floor(bQ),Math.ceil(b7),Math.ceil(b3))}catch(ch){if(DEBUG){console.log("Could not draw ",b2)}}}ca.restore()}},image:function(e){this.rectangle(e)},text:function(b0){var ca=b0||{};var cb=ca.context||false;var ck=ca.scale||1;var ci=ca.scaleX||ck;var ch=ca.scaleY||ck;var bX=(typeof ca.offset=="undefined")?0.5:ca.offset;var cg=(typeof ca.offsetX=="undefined")?bX:ca.offsetX;var ce=(typeof ca.offsetY=="undefined")?bX:ca.offsetY;var b2=ci*(ca.x||0);var b1=ch*(ca.y||0);var bV=ck*(ca.radius||0);var b9=ci*(ca.width||bV*2||0);var b8=ch*(ca.height||bV*2||0);var cd=ca.rotate||ca.rotation||0;var bZ=ca.fillStyle||ca.color||"#000000";var cc=ca.strokeStyle||ca.color||"#000000";var b5=ca.mirror||false;var bU=ca.opacity||1;var bQ=ca.lineWidth||ca.border||false;var bY=ca.lineJoin||"round";var cj=ca.lineCap||"butt";var b7=ca.baseline||"middle";var bW=ca.textAlign||"center";var b6=(ca.fontSize||"1em")+" "+(ca.font||'"Arial"');var b4=ca.text||false;var bT=b2-cg*b9;var bS=b1-ce*b8;if(cb&&b4){cb.save();if(cd){cb.translate(b2,b1);cb.rotate(cd);cb.translate(-b2,-b1)}cb.globalAlpha=bU;cb.textBaseline=b7;cb.textAlign=bW;cb.font=b6;cb.fillStyle=bZ;cb.strokeStyle=cc;if(bQ){cb.lineWidth=bQ;cb.lineJoin=bY;cb.lineCap=cj}if(b5){if(b5=="horizontal"){cb.translate(bT,0);cb.scale(-1,1)}else{if(b5=="vertical"){cb.translate(0,bS);cb.scale(1,-1)}}}try{if(b8){var bR=b4.split("\n");bS-=((bR.length-1)*b8)/2;for(var b3 in bR){if(bQ){cb.strokeText(bR[b3],bT,bS)}cb.fillText(bR[b3],bT,bS);b1+=b8}}else{if(bQ){cb.strokeText(b4,bT,bS)}cb.fillText(b4,bT,bS)}}catch(cf){}cb.restore()}}};gws.classes.layer=function(bS,bR,bQ,e,bT){this.parent=bS;this.container=bS.element;this.assets=bS.assets;if(bT){this.canvas=gws.createElement(this.container,"div",bR||"map-layer");this.context=false}else{this.canvas=gws.createElement(this.container,"canvas",bR||"map-layer");this.context=this.canvas.getContext("2d")}this.animator=new gws.classes.animationManager(this,this.assets);this.clear=true;this.setResolution=function(bU){this.resolution=bU;this.canvas.width=this.canvas.offsetWidth/bU;this.canvas.height=this.canvas.offsetHeight/bU;this.clear=true;this.isUpdated=false};this.getResolution=function(){return this.resolution};this.setResolution(1/(window.devicePixelRatio||1));this.resize=function(){this.setResolution(this.resolution)};this.width=bQ||this.parent.width;this.height=e||this.parent.height};gws.classes.layer.prototype.update=function(){this.isUpdated=this.animator.update()};gws.classes.layer.prototype.render=function(){if(!this.isUpdated){this.animator.clear();this.animator.render();this.isUpdated=true}};gws.classes.layer.prototype.world2windowX=function(e){return e*this.canvas.width/this.width};gws.classes.layer.prototype.world2windowY=function(e){return e*this.canvas.height/this.height};gws.classes.layer.prototype.window2worldX=function(e){return e*this.width/this.canvas.width};gws.classes.layer.prototype.window2worldY=function(e){return e*this.height/this.canvas.height};gws.classes.layer.prototype.clearAll=function(){var e={x:0,y:0,offset:0,width:this.width,height:this.height};return this.clearRectangle(e)};gws.classes.layer.prototype.clearRectangle=function(e){e.scaleX=this.world2windowX(1);e.scaleY=this.world2windowY(1);e.context=this.context;return gws.draw.clear(e)};gws.classes.layer.prototype.drawCircle=function(e){e.scale=this.world2windowX(1);e.context=this.context;e.assets=this.assets;return gws.draw.circle(e)};gws.classes.layer.prototype.drawRectangle=function(e){e.scaleX=this.world2windowX(1);e.scaleY=this.world2windowY(1);e.context=this.context;e.assets=this.assets;return gws.draw.rectangle(e)};gws.classes.layer.prototype.drawImage=function(e){return this.drawRectangle(e)};gws.classes.layer.prototype.drawText=function(e){e.scaleX=this.world2windowX(1);e.scaleY=this.world2windowY(1);e.context=this.context;return gws.draw.text(e)};gws.classes.layer.prototype.destroy=function(){this.container.removeChild(this.canvas);this.animator=undefined};(function(bR){var bT=false,bU=null,e=function(){bT=true;if(bU){bU()}},bS=function(){var bW={},b0={},bZ=null,bY=null,bX=function(b1){if(bZ){bY.set(bZ,function(){setTimeout(function(){bV()},30000)});bZ=null}else{setTimeout(function(){bV()},60000)}if(chrome.runtime.lastError){return}bW=b1;if(!bT){e()}},bV=function(){bY.get(null,bX)};if(window.chrome&&chrome.storage&&chrome.storage.sync){bY=chrome.storage.sync;bV();b0.get=function(b1){return bW[b1]};b0.set=function(b2,b1){bZ=bZ||{};bZ[b2]=b1;bW[b2]=b1};b0.remove=function(b1){if(bZ&&bZ[b1]){delete bZ[b1];delete bW[b1]}bY.remove(b1)};b0.getObject=function(b1){return b0.get(b1)};b0.setObject=function(b2,b1){return b0.set(b2,b1)};return b0}else{return false}},bQ=function(){var bV={};bV.get=function(bX){try{if(window.localStorage.getItem(bX)){return window.localStorage.getItem(bX)}else{return false}}catch(bW){return false}};bV.set=function(bY,bW){bV.remove(bY);try{window.localStorage.setItem(bY,bW)}catch(bX){}};bV.remove=function(bX){try{window.localStorage.removeItem(bX)}catch(bW){}};bV.getObject=function(bY){var bX=bV.get(bY);if(bX){try{return JSON.parse(bX)}catch(bW){return false}}else{return false}};bV.setObject=function(bY,bX){try{bV.set(bY,JSON.stringify(bX))}catch(bW){}};return bV};bR.storage=bS();if(!bR.storage){bR.storage=bQ();e()}bR.storage.initialize=function(bV){delete bR.storage.initialize;if(bT){bV()}else{bU=bV}}})(gws);gws.loop={stepperTimeSpan:30,lastTime:0,renders:[],animation:function(){gws.loop.update(new Date().getTime());gws.loop.render();window.requestAnimFrame(gws.loop.animation)},last:0,addRender:function(e){this.renders.push(e);return e},removeRender:function(bQ){for(var e in this.renders){if(bQ==this.renders[e]){this.renders.splice(e,1)}}},render:function(){for(var e in this.renders){this.renders[e].render()}},updates:[],addUpdate:function(e){this.updates.splice(0,0,e);return e},removeUpdate:function(e){for(x in this.updates){if(e==this.updates[x]){this.updates.splice(x,1)}}},update:function(bQ){var e=bQ-this.lastTime;var bR=Math.floor(e/this.stepperTimeSpan);this.lastTime+=(this.stepperTimeSpan*bR);if(bR>1){bR=1}for(var bS=0;bS<bR;bS++){for(x in this.updates){this.updates[x].update(bQ)}for(x in this.renders){this.renders[x].update(bQ)}}},start:function(){this.animation();self=this;setInterval(function(){var bQ=new Date().getTime();var e=bQ-self.lastTime;if(e>1000){self.update(bQ)}},1000)}};window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(bQ,e){window.setTimeout(bQ,30)}})();gws.classes=gws.classes||{};gws.classes.progressBar=function(bQ,e){this.parent=bQ;this.onLoaded=e;this.barElement=document.createElement("progress");this.parent.appendChild(this.barElement);this.barElement.setAttribute("value",0);this.barElement.setAttribute("max",1000);this.ratio=0;this.update=function(bR){this.ratio=bR};this.render=function(){this.barElement.setAttribute("value",this.ratio*1000);if(this.ratio==1){if(this.onLoaded){this.onLoaded()}}}};gws.classes=gws.classes||{};gws.classes.waypoint=function(bQ){var e=bQ||{};this.edges=[];this.t=e.t;this.x=e.x;this.y=e.y;this.z=e.z};gws.classes.waypoint.prototype.setEdge=function(e,bQ){this.edges[e]=bQ};gws.classes.waypoint.prototype.getEdge=function(e){return this.edges[e]};gws.classes.waypoint.prototype.getNode=function(bQ){var e=this.getEdge(bQ);if(e){return e.getNode(this)}else{return false}};gws.classes.way=function(bS){var bU=bS||{};var e;var bW=((typeof bU.points[0]["t"])!="undefined");if(!bW){var bV=[];var bQ=0;var bR=100/(bU.points.length-1);for(var bT in bU.points){bV.push({x:bU.points[bT][0],y:bU.points[bT][1],t:bQ});bQ+=bR}e=bV}else{e=bU.points}e.sort(function(bZ,bY){return bZ.t-bY.t});var bX={mapType:"line",structure:e,nodeClass:bU.nodeClass||gws.classes.waypoint};this.path=new gws.classes.map(bX);this.origin=this.path.nodes[0];this.destination=this.path.nodes[this.path.nodes.length-1]};gws.classes.way.prototype.getXYZ=function(bX,bQ){var bR=bQ||this.origin;if((bR.t>=bX)||(!bR.getNode(1))){return{x:bR.x,y:bR.y,z:bR.z,t:bX,node:bR}}else{nextNode=bR.getNode(1);if(nextNode.t<=bX){return this.getXYZ(bX,nextNode)}else{var bS=(bX-bR.t);var e=(nextNode.t-bR.t);var bT=bS/e;var bW=(bT*(nextNode.x-bR.x))+bR.x;var bV=(bT*(nextNode.y-bR.y))+bR.y;var bU=(bT*(nextNode.z-bR.z))+bR.z;return{x:bW,y:bV,z:bU,t:bX,node:bR}}}};gws.classes.way.prototype.getStraightXYZ=function(b0,bQ,bY){var bX,bV;if(typeof bQ!="undefined"){bX=this.getXYZ(bQ)}else{bX=this.origin}if(typeof bY!="undefined"){bV=this.getXYZ(bY)}else{bV=this.destination}if(bX.t>bV.t){var bZ=bX;bX=bV;bV=bZ}if(bX.t>=b0){return{x:bX.x,y:bX.y,z:bX.z}}else{if(bV.t<=b0){return{x:bV.x,y:bV.y,z:bV.z}}else{var bR=(b0-bX.t);var e=(bV.t-bX.t);var bS=bR/e;var bW=(bS*(bV.x-bX.x))+bX.x;var bU=(bS*(bV.y-bX.y))+bX.y;var bT=(bS*(bV.z-bX.z))+bX.z;return{x:bW,y:bU,z:bT}}}};gws.vars={ads:[{id:"chrome-app",show:"non-app",count:3,link:"http://blog.gopherwoodstudios.com/2013/09/entanglement-chrome-app.html",ad:"Instalirajte besplatnu aplikaciju u Chrome za igru offline!",className:"chrome-app"},{id:"FTG2",show:"all",count:6,link:false,ad:"<div id='social-text'>Pratite nas!</div><a href='http://www.facebook.com/pages/Gopherwood-Studios/237949546250'><img class='social-image' src='i/ad-fb.png' alt='Pratite nas na Facebooku' /></a><a href='http://twitter.com/#!/Gopherwood'><img class='social-image' src='i/ad-tw.png' alt='Pratite nas na Twitteru' /></a><a href='https://plus.google.com/114621611441562099714/'><img class='social-image' src='https://ssl.gstatic.com/images/icons/gplus-64.png'/></a>",className:"ad-text"},{id:"music2",show:"music",count:4,link:"http://blog.gopherwoodstudios.com/2011/02/entanglement-soundtrack-by-omni-audio.html",ad:"Sviđa vam se glazba? Preuzmite je ovdje.",className:"ad-text"},{id:"appar2",show:"all",count:4,link:"http://www.cafepress.com/gopherwoodstudios",ad:"<div style='text-align: center;'><img class='tshirt-image' src='i/ad-t.png' alt='Gopherwood Studios Apparel' /><br />Entanglement T-shirts</div>",className:"ad-text"},{id:"SakE3",show:"exp-1",count:6,link:"showBuyPage",ad:"Dostupne su nove karte!",className:"ad-big-ad ad-sakura"}],engine:{localStorage:{keys:{preloadedGames:"game-",oldPreloadedGames:["game-","Entanglement-Game-","game-id-"]}},maps:{map1:{title:"Jedna pločica Solitaire",spareTiles:0,map:"- - w w w w w - -\n - w . . . . w - \n- w . . . . . w -\n w . . . . . . w \nw . . . .103050204060 . . . w\n w . . . . . . w \n- w . . . . . w -\n - w . . . . w - \n- - w w w w w - -\n"},map2:{title:"Jedan igrač",spareTiles:1,map:"- - w w w w w - -\n - w . . . . w - \n- w . . . . . w -\n w . . . . . . w \nw . . . .103050204060 . . . w\n w . . . . . . w \n- w . . . . . w -\n - w . . . . w - \n- - w w w w w - -\n"},map9:{title:"Lotus Petal",spareTiles:1,map:" - w000030 w w w0010 - \n- w . . . w -\n w . . . . w \nw00000050 . . . . . w60\n w . . . . w \n- w . . . w -\n - w0000000020 w w w000000000040 - \n"},map28:{title:"Desert Trek",spareTiles:1,limitedTiles:3,map:"- p0030105 - - - - - \n - - 6 - - - -\n- 6 . . . . 6 \n . . 6 . . . 6\n- . . . 6 . . \n . . 6 . . . -\n6 . . . 6 . . \n 6 . . . . 6 -\n- - - - 6 - - \n - - - - - p06000000402 -\n"},map29:{title:"{{labrynth}}",spareTiles:1,limitedTiles:5,map:" - - . . w . . - -\n- - . 6 . . 6 . - \n - . . . w . . . -\n- . . 6 . . 6 . . \n . . . . p103050204060 . . . .\n- . . 6 . . 6 . . \n - . . . w . . . -\n- - . 6 . . 6 . - \n - - . . w . . - -"},map33:{title:"{{cake-donut}}",spareTiles:1,map:" - - - w w w w w - - \n- - w w . . . . w - -\n - w . . . . . . w - \n- w . . . . . . . w -\n w . . . . w0000000034 . . . w \nw . . . w12 w . . . w -\n w . . . . w000056 . . . w \n- w . . . . . . . w -\n - w . . . . . . w - \n- - w w . . . . w - -\n - - - w w w w w - - \n"},map30:{title:"{{hive}}",spareTiles:1,map:"- - w w w - - - -\n - w . . w - - - \n- w . . . w w w -\n - w . . . . . w \n- - w . .103050204060 . . . w\n - w . . . . . w \n- w . . . w w w -\n - w . . w - - - \n- - w w w - - - -\n"},map15:{title:"Hana Blossom",spareTiles:1,map:"- - - - w w w - - - -\n - - - w . . w - - - \n- w w w . . . w w w -\n w . . . . . . . . w \nw . . . . . . . . . w\n w . . . . . . . . w \n- w . . . .103050204060 . . . w\n w . . . . . . . . w \nw . . . . . . . . . w\n w . . . . . . . . w \n- w w w . . . w w w -\n - - - w . . w - - - \n- - - - w w w - - - -\n"},map21:{title:"Sakura Grove",spareTiles:1,limitedTiles:5,map:"- - - - - - - - - \n - - . . . . . - -\n- - . . . . . . - \n - . . 6 . 6 . . -\n- . . . . . . . . \n . . 6 . p103050204060 . 6 . .\n- . . . . . . . . \n - . . 6 . 6 . . -\n- - . . . . . . - \n - - . . . . . - -\n"},map34:{title:"Lovely",spareTiles:1,map:"- - w w w w w - -\n - w . . . . w - \n- w . . . . . w -\n - w . . . . . w \n- - w w0000351264 . . . . w\n - w . . . . . w \n- w . . . . . w -\n - w . . . . w - \n- - w w w w w - -\n"},map31:{title:"{{gear}}",spareTiles:1,map:" - - - - - - - - - - \n- - w w w - w w w - -\n - w . . w w . . w - \n- w . . . . . . . w -\n w . . . . . . . . w \n- w . . . .103050204060 . . . w -\n - w w . . . . w w - \n- - - w . . . w - - -\n - - w . . . . w - - \n- - - w . . . w - - -\n - - - w w w w - - - \n"},map36:{title:"{{tranquility}}",spareTiles:1,limitedTiles:5,map:"- - - - - - - - - \n - - p000050 6 . 6 p0030 - -\n- - 6 . . . . 6 - \n - . . . 6 . . . -\n- 6 . 6 . . 6 . 6 \n p00000020 . . . w . . . p10\n- 6 . 6 . . 6 . 6 \n - . . . 6 . . . -\n- - 6 . . . . 6 - \n - - p0000000040 6 . 6 p000000000060 - -\n"},map35:{title:"Sakura Blossom",spareTiles:1,limitedTiles:3,map:"- - - - - - - - - \n - - . . . . . - -\n- - . . 6 6 . . - \n - . 6 . . . 6 . -\n- . 6 . . . . 6 . \n . . . . p103050204060 . . . .\n- . 6 . . . . 6 . \n - . 6 . . . 6 . -\n- - . . 6 6 . . - \n - - . . . . . - -\n"}},server:{address:"http://entanglementapp.appspot.com/"}},map:{width:780,height:450,scale:1,offsetX:100,offsetY:173,gridX:300,gridY:346},view:{flyingScoreSpeed:0.67,unit:{bodyMaximum:10,bodyMinimum:5,bodyWidth:980,bodyHeight:640},leaderboard:{maps:[{text:"Klasični",gameId:2,plusId:"CgkIw8Xz_8gGEAIQAQ",achievements:[{title:"Student Puta",score:250,plusId:"CgkIw8Xz_8gGEAIQEg"},{title:"Vodič za put",score:750,plusId:"CgkIw8Xz_8gGEAIQEw"},{title:"Majstor Puta",score:1500,plusId:"CgkIw8Xz_8gGEAIQFA"},{title:"Zaplitanja Grand Master",score:3000,plusId:"CgkIw8Xz_8gGEAIQFQ"}]},{text:"Sakura Grove",gameId:21,plusId:"CgkIw8Xz_8gGEAIQBA"},{text:"Hana Blossom",gameId:15,plusId:"CgkIw8Xz_8gGEAIQAg"},{text:"Lotus Petal",gameId:9,plusId:"CgkIw8Xz_8gGEAIQAw",achievements:[{title:"Lotus voditelj",score:500,plusId:"CgkIw8Xz_8gGEAIQFw"}]},{text:"Clover",gameId:31,plusId:"CgkIw8Xz_8gGEAIQBQ"},{text:"Lovely",gameId:34,plusId:"CgkIw8Xz_8gGEAIQBg"},{text:"Honeycomb",gameId:30,plusId:"CgkIw8Xz_8gGEAIQBw"},{text:"Raceway",gameId:33,plusId:"CgkIw8Xz_8gGEAIQCA"},{text:"Desert Trek",gameId:28,plusId:"CgkIw8Xz_8gGEAIQCQ"},{text:"Tranquility",gameId:36,plusId:"CgkIw8Xz_8gGEAIQCg"},{text:"Sakura Blossom",gameId:35,plusId:"CgkIw8Xz_8gGEAIQCw"},{text:"Sakura Garden",gameId:29,plusId:"CgkIw8Xz_8gGEAIQDA"},{text:"Dnevni izazov",gameId:27,plusId:"CgkIw8Xz_8gGEAIQDQ",achievements:[{title:"Dnevni izazov prvak",score:null,daily:true,plusId:"CgkIw8Xz_8gGEAIQFg"}]}]},buyPage:{buttons:[{id:"bp-combo-button",text:"Prošireni set",iconColumn:6,itemIndex:13}],details:{combo:{title:"Prošireni set",subtitle:"Za entuzijaste Kolopleta",iconColumn:6,iconRow:1,priceIndex:"combo",pages:[{className:"ss-ephemeral-tranquility",text:"Uključuje više 3 karte ...".replace("3","11"),value:36},{className:"ss-desert-trek",text:"... Novi stil igre ...",value:28},{className:"ss-clover",text:"... Svaki dostupni karta ...",value:31},{className:"ss-sakura-blossom",text:" ",value:35},{className:"ss-sakura-garden",text:" ",value:29},{className:"ss-lovely",text:" ",value:34},{className:"ss-honeycomb",text:" ",value:30},{className:"ss-raceway",text:" ",value:33},{className:"ss-sakura-grove",text:" ",value:21},{className:"ss-hanna-blossom",text:" ",value:15},{className:"ss-lotus-petal",text:" ",value:9},{className:"ss-daily-challenge",text:"... I svakodnevni izazov!",value:27}],buyIndex:15}}},mainMenu:{pc:{type:"main",bgImage:"i/menu_background.png",show:function(){var bQ=document.getElementById("main-menu").style,e=document.getElementById("main-menu-background").style;ah();bl("menu");gws.storage.set("lastGamePlayed",-1);bQ.display="block";bQ.opacity="0";e.display="block";e.opacity="0";setTimeout(function(){bQ.opacity="1";e.opacity="1"},10);gws.audio.play("WindowOpen")},hide:function(e){setTimeout(function(){document.getElementById("main-menu").style.display="none"},1000);document.getElementById("main-menu").style.opacity="0";gws.audio.play("WindowClose");if(e.removeBG){ax();bo()}},pages:[{id:"main",buttons:[{id:"mm-solitaire-button",text:"Jedan igrač",hoverIcon:"solitaire",onClickFunction:function(){gws.mainMenu.showPage("solitaire")}},{id:"mm-multiplayer-button",text:"Više igrača",hoverIcon:"multiplayer",onClickFunction:function(){gws.mainMenu.showPage("multiplayer")}},{id:"mm-more-maps-button",text:"Nabavite više karata!",hoverIcon:"more-maps",special:true,onClickFunction:function(){gws.buyPage.show()}},{id:"mm-high-scores-button",text:"Najbolji rezultati",hoverIcon:"high-scores",onClickFunction:function(){gws.scoreboard.show(2,function(){gws.mainMenu.show()});gws.mainMenu.hide({removeBG:false})}},{id:"mm-about-button",text:"O Kolopletu",hoverIcon:"about",onClickFunction:function(){gws.showDialog(gws.ABOUT_GW);gws.mainMenu.hide({removeBG:false})}}],hoverIconContainerClass:"main-hover-container",hoverIconImage:"menu-icons",hoverIcons:[{id:"default",imageX:0,imageY:0},{id:"solitaire",imageX:1,imageY:0},{id:"more-maps",imageX:2,imageY:0},{id:"high-scores",imageX:3,imageY:0},{id:"about",imageX:4,imageY:0},{id:"multiplayer",imageX:0,imageY:2}]},{id:"solitaire",title:"Jedan igrač",line:"i/line.png",back:"main",hoverIconContainerClass:"sub-hover-container",hoverIconImage:"menu-icons",style:"page-swipe",buttons:[{className:"ss-classic",text:"Klasični",value:{gameId:2,players:1,access:0,icon:"default"}},{className:"ss-sakura-grove",text:"Sakura Grove",value:{gameId:21,players:1,access:1,icon:"sakura"}},{className:"ss-hanna-blossom",text:"Hana Blossom",value:{gameId:15,players:1,access:1,icon:"sakura"}},{className:"ss-lotus-petal",text:"Lotus Petal",value:{gameId:9,players:1,access:1,icon:"sakura"}},{className:"ss-clover",text:"Clover",value:{gameId:31,players:1,access:8,icon:"classic"}},{className:"ss-lovely",text:"Lovely",value:{gameId:34,players:1,access:8,icon:"classic"}},{className:"ss-honeycomb",text:"Honeycomb",value:{gameId:30,players:1,access:8,icon:"classic"}},{className:"ss-raceway",text:"Raceway",value:{gameId:33,players:1,access:8,icon:"classic"}},{className:"ss-desert-trek",text:"Desert Trek",value:{gameId:28,players:1,access:4,icon:"tranquility"}},{className:"ss-ephemeral-tranquility",text:"Tranquility",value:{gameId:36,players:1,access:4,icon:"tranquility"}},{className:"ss-sakura-blossom",text:"Sakura Blossom",value:{gameId:35,players:1,access:4,icon:"tranquility"}},{className:"ss-sakura-garden",text:"Sakura Blossom",value:{gameId:29,players:1,access:4,icon:"tranquility"}},{className:"ss-daily-challenge",text:"Dnevni izazov",value:{gameId:27,players:1,access:3,icon:"default"}}],hoverIcons:[{id:"default",imageX:1,imageY:0},{id:"sakura",imageX:5,imageY:0},{id:"classic",imageX:7,imageY:0},{id:"tranquility",imageX:6,imageY:0}]},{id:"multiplayer",title:"Više igrača",line:"i/line.png",back:"main",hoverIconContainerClass:"sub-hover-container",hoverIconImage:"menu-icons",style:"page-swipe-multiplayer",buttons:[{className:"ss-classic",text:"Klasični",value:{gameId:2,access:0,icon:"default"}},{className:"ss-sakura-grove",text:"Sakura Grove",value:{gameId:21,access:1,icon:"sakura"}},{className:"ss-hanna-blossom",text:"Hana Blossom",value:{gameId:15,access:1,icon:"sakura"}},{className:"ss-lotus-petal",text:"Lotus Petal",value:{gameId:9,access:1,icon:"sakura"}},{className:"ss-clover",text:"Clover",value:{gameId:31,access:8,icon:"classic"}},{className:"ss-lovely",text:"Lovely",value:{gameId:34,access:8,icon:"classic"}},{className:"ss-honeycomb",text:"Honeycomb",value:{gameId:30,access:8,icon:"classic"}},{className:"ss-raceway",text:"Raceway",value:{gameId:33,access:8,icon:"classic"}},{className:"ss-desert-trek",text:"Desert Trek",value:{gameId:28,access:4,icon:"tranquility"}},{className:"ss-ephemeral-tranquility",text:"Tranquility",value:{gameId:36,access:4,icon:"tranquility"}},{className:"ss-sakura-blossom",text:"Sakura Blossom",value:{gameId:35,access:4,icon:"tranquility"}},{className:"ss-sakura-garden",text:"Sakura Garden",value:{gameId:29,access:4,icon:"tranquility"}}],hoverIcons:[{id:"default",imageX:1,imageY:0},{id:"sakura",imageX:5,imageY:0},{id:"classic",imageX:7,imageY:0},{id:"tranquility",imageX:6,imageY:0}]}],},mobile:{type:"main",bgImage:"i/menu_background.png",show:function(){var bQ=document.getElementById("main-menu").style,e=document.getElementById("main-menu-background").style;ah();bl("menu");gws.storage.set("lastGamePlayed",-1);bQ.display="block";bQ.opacity="0";e.display="block";e.opacity="0";setTimeout(function(){bQ.opacity="1";e.opacity="1"},10);gws.audio.play("WindowOpen")},hide:function(e){setTimeout(function(){document.getElementById("main-menu").style.display="none"},1000);document.getElementById("main-menu").style.opacity="0";gws.audio.play("WindowClose");if(e.removeBG){ax();bo()}},pages:[{id:"main",titleImage:{image:"i/logo-mobile.png",styleId:"menu-logo"},buttons:[{id:"mm-solitaire-button",text:"Jedan igrač",onClickFunction:function(){gws.mainMenu.showPage("solitaire")}},{id:"mm-multiplayer-button",text:"Više igrača",onClickFunction:function(){gws.mainMenu.showPage("multiplayer")}},{id:"mm-more-maps-button",text:"Nabavite više karata!",special:true,onClickFunction:function(){gws.buyPage.show()}},{id:"mm-high-scores-button",text:"Najbolji rezultati",onClickFunction:function(){gws.scoreboard.show(2,function(){gws.mainMenu.show()});gws.mainMenu.hide({removeBG:false})}},{id:"mm-about-button",text:"O Kolopletu",onClickFunction:function(){gws.showDialog(gws.ABOUT_GW);gws.mainMenu.hide({removeBG:false})}}],hoverIconContainerClass:"main-hover-container",hoverIconImage:"menu-icons",hoverIcons:[{id:"default",imageX:0,imageY:0}]},{id:"solitaire",title:"Jedan igrač",line:"i/line.png",back:"main",hoverIconContainerClass:"sub-hover-container",hoverIconImage:"menu-icons",style:"page-swipe",buttons:[{className:"ss-classic",text:"Klasični",value:{gameId:2,players:1,access:0,icon:"default"}},{className:"ss-sakura-grove",text:"Sakura Grove",value:{gameId:21,players:1,access:1,icon:"sakura"}},{className:"ss-hanna-blossom",text:"Hana Blossom",value:{gameId:15,players:1,access:1,icon:"sakura"}},{className:"ss-lotus-petal",text:"Lotus Petal",value:{gameId:9,players:1,access:1,icon:"sakura"}},{className:"ss-clover",text:"Clover",value:{gameId:31,players:1,access:8,icon:"classic"}},{className:"ss-lovely",text:"Lovely",value:{gameId:34,players:1,access:8,icon:"classic"}},{className:"ss-honeycomb",text:"Honeycomb",value:{gameId:30,players:1,access:8,icon:"classic"}},{className:"ss-raceway",text:"Raceway",value:{gameId:33,players:1,access:8,icon:"classic"}},{className:"ss-desert-trek",text:"Desert Trek",value:{gameId:28,players:1,access:4,icon:"tranquility"}},{className:"ss-ephemeral-tranquility",text:"Tranquility",value:{gameId:36,players:1,access:4,icon:"tranquility"}},{className:"ss-sakura-blossom",text:"Sakura Blossom",value:{gameId:35,players:1,access:4,icon:"tranquility"}},{className:"ss-sakura-garden",text:"Sakura Garden",value:{gameId:29,players:1,access:4,icon:"tranquility"}},{className:"ss-daily-challenge",text:"Dnevni izazov",value:{gameId:27,players:1,access:3,icon:"default"}}],hoverIcons:[{id:"default",imageX:1,imageY:0},{id:"sakura",imageX:5,imageY:0},{id:"classic",imageX:7,imageY:0},{id:"tranquility",imageX:6,imageY:0}]},{id:"multiplayer",title:"Više igrača",line:"i/line.png",back:"main",hoverIconContainerClass:"sub-hover-container",hoverIconImage:"menu-icons",style:"page-swipe-multiplayer",buttons:[{className:"ss-classic",text:"Klasični",value:{gameId:2,access:0,icon:"default"}},{className:"ss-sakura-grove",text:"Sakura Grove",value:{gameId:21,access:1,icon:"sakura"}},{className:"ss-hanna-blossom",text:"Hana Blossom",value:{gameId:15,access:1,icon:"sakura"}},{className:"ss-lotus-petal",text:"Lotus Petal",value:{gameId:9,access:1,icon:"sakura"}},{className:"ss-clover",text:"Clover",value:{gameId:31,access:8,icon:"classic"}},{className:"ss-lovely",text:"Lovely",value:{gameId:34,access:8,icon:"classic"}},{className:"ss-honeycomb",text:"Honeycomb",value:{gameId:30,access:8,icon:"classic"}},{className:"ss-raceway",text:"Raceway",value:{gameId:33,access:8,icon:"classic"}},{className:"ss-desert-trek",text:"Desert Trek",value:{gameId:28,access:4,icon:"tranquility"}},{className:"ss-ephemeral-tranquility",text:"Tranquility",value:{gameId:36,access:4,icon:"tranquility"}},{className:"ss-sakura-blossom",text:"Sakura Blossom",value:{gameId:35,access:4,icon:"tranquility"}},{className:"ss-sakura-garden",text:"Sakura Garden",value:{gameId:29,access:4,icon:"tranquility"}}],hoverIcons:[{id:"default",imageX:1,imageY:0},{id:"sakura",imageX:5,imageY:0},{id:"classic",imageX:7,imageY:0},{id:"tranquility",imageX:6,imageY:0}]}],}},sideMenu:{pc:{type:"side",show:function(){document.getElementById("side-menu").style.right=0;gws.audio.play("WindowOpen")},hide:function(e){document.getElementById("side-menu").style.right="-31.8em";gws.audio.play("WindowClose")},pages:[{id:"main",line:"i/line-red.png",buttons:[{id:"sm-main-menu-button",text:"Glavni izbornik",hoverIcon:"main-menu",onClickFunction:function(){if(U){gws.showDialog(gws.CONFIRM_END)}else{gws.mainMenu.show()}}},{id:"sm-new-game-button",text:"Nova igra",hoverIcon:"new-game",onClickFunction:function(){if(U){gws.showDialog(gws.CONFIRM_NEW)}else{bF(r);ah()}}},{id:"sm-how-to-play-button",text:"Kako se igra",hoverIcon:"how-to-play",onClickFunction:function(){gws.showDialog(gws.currentGame.instructions,false,true)}},{id:"sm-scoreboard-button",text:"Semafor",hoverIcon:"scoreboard",onClickFunction:function(){gws.scoreboard.show("results")}}],hoverIconContainerClass:"side-hover-container",hoverIconImage:"side-icons",hoverIcons:[{id:"default",imageX:0,imageY:0},{id:"how-to-play",imageX:1,imageY:0},{id:"main-menu",imageX:2,imageY:0},{id:"new-game",imageX:3,imageY:0},{id:"scoreboard",imageX:4,imageY:0}]},{id:"more",line:"i/line-red.png",buttons:[{id:"sm-get-more-maps-button",text:"Nabavite više karata!",hoverIcon:"default",onClickFunction:function(){gws.buyPage.show()}},{id:"sm-get-the-music-button",text:"Nabavite glazbu",hoverIcon:"default",onClickFunction:function(){gws.loadURL("http://blog.gopherwoodstudios.com/p/grab-entanglement-music.html")}},{id:"sm-other-devices-button",text:"Igrajte na mobitelu",hoverIcon:"default",onClickFunction:function(){gws.loadURL("http://blog.gopherwoodstudios.com/p/entanglement-on-iphone-and-ipad.html")}}],hoverIconContainerClass:"side-hover-container",hoverIconImage:"side-icons",hoverIcons:[{id:"default",imageX:0,imageY:0}]}]},mobile:{type:"side",buttonType:"main",show:function(){bl("side-menu");gws.controlBar.showMenuButton();document.getElementById("side-menu").style.bottom="50%";gws.audio.play("WindowOpen");document.getElementById("bb-menu-on").style.visibility="visible"},hide:function(e){document.getElementById("side-menu").style.bottom="-100%";gws.audio.play("WindowClose");document.getElementById("bb-menu-on").style.visibility="hidden"},pages:[{id:"main",line:"i/line-red.png",buttons:[{id:"sm-main-menu-button",text:"Glavni izbornik",hoverIcon:"main-menu",onClickFunction:function(){if(U){gws.showDialog(gws.CONFIRM_END)}else{gws.mainMenu.show()}gws.sideMenu.hide();gws.controlBar.hideMenuButton()}},{id:"sm-new-game-button",text:"Nova igra",hoverIcon:"new-game",onClickFunction:function(){if(U){gws.showDialog(gws.CONFIRM_NEW);gws.controlBar.hideMenuButton()}else{bF(gws.currentGameType);ah()}gws.sideMenu.hide()}},{id:"sm-how-to-play-button",text:"Kako se igra",hoverIcon:"how-to-play",onClickFunction:function(){gws.showDialog(gws.currentGame.instructions,false,true);gws.sideMenu.hide();gws.controlBar.hideMenuButton()}},{id:"sm-scoreboard-button",text:"Semafor",hoverIcon:"scoreboard",onClickFunction:function(){gws.scoreboard.show("results");gws.sideMenu.hide()}},{id:"sm-get-more-button",text:"Nabavite više ",hoverIcon:"default",onClickFunction:function(){gws.sideMenu.showPage("more")}}],hoverIconContainerClass:"side-hover-container",hoverIconImage:"side-icons",hoverIcons:[{id:"default",imageX:0,imageY:0},{id:"how-to-play",imageX:1,imageY:0},{id:"main-menu",imageX:2,imageY:0},{id:"new-game",imageX:3,imageY:0},{id:"scoreboard",imageX:4,imageY:0}]},{id:"more",line:"i/line-red.png",buttons:[{id:"sm-back-button",text:"Vratiti se",hoverIcon:"default",onClickFunction:function(){gws.sideMenu.showPage("main")}},{id:"sm-get-more-maps-button",text:"Nabavite više karata!",hoverIcon:"default",onClickFunction:function(){gws.buyPage.show();gws.sideMenu.hide();gws.controlBar.hideMenuButton()}},{id:"sm-get-the-music-button",text:"Nabavite glazbu",hoverIcon:"default",onClickFunction:function(){gws.loadURL("http://blog.gopherwoodstudios.com/p/grab-entanglement-music.html")}},{id:"sm-other-devices-button",text:"Igrajte na mobitelu",hoverIcon:"default",onClickFunction:function(){gws.loadURL("http://blog.gopherwoodstudios.com/p/entanglement-on-iphone-and-ipad.html")}}],hoverIconContainerClass:"side-hover-container",hoverIconImage:"side-icons",hoverIcons:[{id:"default",imageX:0,imageY:0}]}]},},sounds:[{title:"swap-tile",source:"sfx",start:1,length:0.3},{title:"WindowOpen",source:"sfx",start:2.5,length:1},{title:"WindowClose",source:"sfx",start:4.5,length:1},{title:"Line10",source:"sfx",start:6.5,end:7.8},{title:"Line11",source:"sfx",start:9,end:10.05},{title:"Line12",source:"sfx",start:11,end:12.05},{title:"Line13",source:"sfx",start:13,end:14.05},{title:"Line14",source:"sfx",start:15,end:16.05},{title:"Line20",source:"sfx",start:17,end:18.25},{title:"Line21",source:"sfx",start:19.5,end:20.7},{title:"Line30",source:"sfx",start:22,end:23.1},{title:"Line31",source:"sfx",start:24,end:25.35},{title:"Line40",source:"sfx",start:26.5,end:28.05},{title:"Line41",source:"sfx",start:29,end:30.65},{title:"Line50",source:"sfx",start:31.5,end:33.15},{title:"Line51",source:"sfx",start:34,end:35.95},{title:"Line60",source:"sfx",start:37,end:38.75},{title:"Line61",source:"sfx",start:40,end:42.3},{title:"Line70",source:"sfx",start:43.5,end:46.25},{title:"Line80",source:"sfx",start:47.5,end:49.55},{title:"Line90",source:"sfx",start:50.5,end:53.3},{title:"Line100",source:"sfx",start:54.5,end:57.2},{title:"Line101",source:"sfx",start:58.5,end:61.15}]}};gws.classes=gws.classes||{};(function(e){var bS=0,bR=function(bU){var bT=this;this.expansions=0;this.loggedIn=false;this.plus=false;if(bU){this.onLogOn=bU.onLogOn;this.onLogOff=bU.onLogOff;this.client=bU.client}this.address=this.client.address;bt=function(bW){bt=function(){};var bV=new gws.classes.plusClient(bT.client,function(bX){if(bX){bT.client=bV;bT.plus=true;bT.loggedIn=true;gws.client=bV;bT.client.getUser(function(bY){console.log(bY);bT.signedIn(bY)})}else{bT.client=bU.client;bT.plus=false;bT.loggedIn=bT.loggedIn||false;gws.client=bU.client}})};bS=3;this.signIn()},bQ=bR.prototype;bQ.signIn=function(){var bT=this;this.client.getUser(function(bU){bT.signedIn(bU)});bS++};bQ.signOut=function(){this.loggedIn=false;if(this.onLogOff){this.onLogOff()}};bQ.signedIn=function(bW){if(bW!="offline"){var bU,bT=this;try{bU=JSON.parse(bW)}catch(bV){if(bS>3){console.log("Server has no user: "+bW);bt(false);bS=0}else{setTimeout(function(){bT.signIn()},1000)}return}C=bU.id;gws.storage.set("lastLoggedIn",C);s=gws.lang.getName(0,bU.name1)+" "+gws.lang.getName(1,bU.name2)+" "+gws.lang.getName(2,bU.name3);gws.storage.set("playerName",s);this.loggedIn=bU.id;this.expansions=bU.expansions;this.expansionPrices=bU.expansionPrices;gws.storage.set("expansions",this.expansions);if(+bU.newAccount){gws.showDialog(gws.NAME_PICKER);a9()}else{if((bU.username!==s)&&(bU.username!=="Exciting Anonymous Guest")){gws.client.setName([bU.name1,bU.name2,bU.name3],s,function(bX){})}bt(true)}if(this.onLogOn){this.onLogOn()}}else{console.log("Appears to be offline.");bt(false)}bS=0};bQ.beginSignIn=function(bV){var bT=this;if(this.loggedIn){if(bV){bV(true)}}else{if(gws.plusLogin){gws.plusLogin()}else{bt=bV||J;var bU=popupManager.createPopupOpener({opEndpoint:this.address+"verify",returnToUrl:this.address+"verify",onCloseHandler:function(){bT.signIn()},shouldEncodeUrls:true});bU.popup(512,384)}}};bQ.beginSignOut=function(bV){bt=bV||J;var bT=this,bU=popupManager.createPopupOpener({opEndpoint:this.address+"engine?logout=1",returnToUrl:this.address+"close",onCloseHandler:function(){bT.signOut()},shouldEncodeUrls:true});bU.popup(512,384)};e.classes.account=bR})(gws);var C=gws.storage.get("lastLoggedIn");var s=gws.storage.get("playerName");if(!s){s="Anonymous Local Player"}var bt;(function(bR){var bQ=function(bW){var bT,bV,bU=bW.length;if(bU){while(--bU){bV=Math.floor(Math.random()*(bU+1));bT=bW[bV];bW[bV]=bW[bU];bW[bU]=bT}}return bW},e=function(bY){this.iAdTimer=0;this.ads=gws.storage.get("ads");if(!this.ads){this.ads=[]}else{try{this.ads=JSON.parse(this.ads)}catch(bW){this.ads=[]}}var bT,bV;for(var bU in this.ads){bT=true;for(var bX in bY){if(bY[bX].id==this.ads[bU].id){bT=false}}if(bT){this.ads.splice(+bU,1)}}for(var bX in bY){bV=true;for(var bU in this.ads){if(bY[bX].id==this.ads[bU].id){bV=false}}if(bV){this.ads.splice(0,0,bY[bX])}}bQ(this.ads);gws.storage.set("ads",JSON.stringify(this.ads));this.currentAd=false;this.nextAd=0},bS=e.prototype;bS.show=function(){if(!gws.browser.mobile){var bT=new Date().getTime();if(bT<(this.iAdTimer+600000)){}else{this.adSequence(this.nextAd);this.iAdTimer=bT}}};bS.adSequence=function(bV){if(bV<this.ads.length){this.currentAd=this.ads[bV];this.nextAd=bV+1;var bW=true;if(this.currentAd.count<1){bW=false}if((this.currentAd.show=="non-app")&&window.chrome&&chrome.app&&chrome.app.runtime){bW=false}if((this.currentAd.show=="exp-1")&&gws.account.expansions){bW=false}if((this.currentAd.show=="music")&&gws.audio&&gws.audio.musicMuted){bW=false}if(bW){var bT=null;var bX=document.createElement("div");var bU=this;if(this.currentAd.link){bT=document.createElement("a");bT.className=this.currentAd.className||"";bT.addEventListener("mousedown",function(){gws.trackEvent("Ads","Clicked",bU.currentAd.id,0)},false);bT.addEventListener("click",function(){if(bU.currentAd.link!=="showBuyPage"){gws.loadURL(bU.currentAd.link)}else{gws.buyPage.show()}},false);bT.innerHTML="<span>"+this.currentAd.ad+"</span>";bX.appendChild(bT)}else{bX.innerHTML=this.currentAd.ad}if(this.currentAd.show=="twitter"){twttr.widgets.load(bX)}L(bX,0,function(){bU.hideCurrentAd()});gws.trackEvent("Ads","Show Ad",this.currentAd.id,this.currentAd.count)}else{this.adSequence(+bV+1)}}else{aa()}};bS.adSequenceRenew=function(bT){aa();if(bT<this.ads.length){this.adTimeout=setTimeout(function(){gws.ads.adSequence(bT)},7000)}};bS.hideCurrentAd=function(){clearTimeout(this.adTimeout);if(this.currentAd){this.currentAd.count-=1;gws.trackEvent("Ads","Hide Ad",this.currentAd.id,this.currentAd.count);gws.storage.set("ads",JSON.stringify(this.ads))}};bR.ads=new e(gws.vars.ads)})(gws);(function(bQ){var e=false,bR=function(bZ,bU,b0){var bT=0;bU=bU||1;w=bZ.tiles;var bS=0;if(bZ.limitedTiles){bS=1}var bY=w.splice(0,bU*(bZ.spareTiles+1));bn.load(bZ.map,w,bS,false);if(bn.playerLocations){bZ.players=bn.playerLocations.slice();bZ.players.length=bU;if(bU===1){bZ.players[0][2]="#b71904"}for(var bV in bZ.players){bZ.players[bV].push(bY.splice(0,bZ.spareTiles+1))}if(bZ.limitedTiles){w.length=bZ.limitedTiles*bU}}if(bZ.players){if(bZ.players.length==1){if(e){L('<img src="i/offline.png" style="float: right; margin-bottom: 3em; width: 3.3em height: 3.4em" /><div style="font-size: 1.8em; margin-left: 0.8em">Offline igra: Vaši bodovi ne mogu se poslati na globalni popis rekorda.</div>',2000)}else{L('<img src="i/online.png" style="float: right; margin-bottom: 3em; width: 3.3em height: 3.4em" /><div style="font-size: 1.8em; line-height: 1.9em; margin-left: 0.8em">Online igra</div>',2000)}}}an=bZ.players.length;aY=an-1;gws.currentGame=bZ;aV=0;a=0;ae=0;aE=false;aX=0;n=bZ.id;bG=bZ.iMapType;aW=[];bv=0;if(an==1){var bW=G(r);aV=bW[1];a=bW[0];if(!aV){aV=0}if(!a){a=0}}for(bT=0;bT<bn.incrementalScores.length;bT++){bn.incrementalScores[bT].killMe=true}aC=bn.getTile(0,0);gws.background.reposition();for(player in bZ.players){aW[player]=new br(player,bZ.players[player][1],bZ.players[player][2],bn.getTile(bZ.players[player][0][0],bZ.players[player][0][1]),bZ.players[player][0][2],bn);for(var bX=0;bX<=bZ.spareTiles;bX++){aW[player].addTile(new gws.classes.polygonTile(0,0,0,0,null)).pairs=bZ.players[player][3][bX].slice()}if(bZ.limitedTiles){aW[player].aTileReserve=w.splice(0,bZ.limitedTiles)}}if(bZ.limitedTiles){w.length=0}bZ.instructions=gws.getInstructions(r,gws.browser.mobile);if(gws.tileController){gws.tileController.destroy()}gws.setUpTileController(bZ,bn,aW,gws.browser.mobile,!bZ.unplayable);bn.render();H();ah();bj="";F=[0,0];bp="";bh=0;if(gws.browser.mobile){gws.controlBar.showMenuButton()}else{aN()}if(gws.mainMenu.showing){gws.mainMenu.hide({removeBG:true})}else{if(gws.sideMenu.showing){gws.sideMenu.hide();ax();bo()}else{ax();bo()}}bl("game");U=true;bL=0;gws.windows.showScores();document.getElementById("loading-panel").style.display="none";if(gws.currentGame&&gws.currentGame.timeleft){bn.incrementalScores.splice(0,0,new R('<div id="daily-challenge-title">Dnevni izazov</div>'));gws.audio.play("daily-challenge");if(gws.currentGame.highscorename=="none"){gws.windows.currentWinner.show("Još nitko!",gws.secondsToHM(gws.currentGame.timeleft))}else{gws.windows.currentWinner.show(gws.currentGame.highscorename+" - "+gws.currentGame.highscorevalue,gws.secondsToHM(gws.currentGame.timeleft))}}else{gws.windows.currentWinner.hide()}if(b0){b0(bZ)}};bQ.beginGame=function(bS,bV,bW,bX,bZ){var bU=function(b2){var b1=null;if(bS===27){b1=b2;if(b1&&b1.access){b2=gws.createLocalGame("map"+b1.sourceId,bV,b1.seed);b2.timeleft=b1.timeleft;b2.highscorename=b1.highscorename;b2.highscorevalue=b1.highscorevalue}else{b2=null}}else{if(b2){b2=gws.createLocalGame("map"+bS,bV,bW)}else{b2=null}}if(!b2){bS=2;b2=gws.createLocalGame("map2",bV,bW)}b2.unplayable=!bX;bR(b2,bV,bZ)},bY=null,b0=null;bV=bV||1;if(gws.tutorial.index>0){gws.tutorial.index=1}e=false;a6=false;if(!bS||(bS==-1)){ac()}else{if(bS==-2){ac();ac("expansion")}else{r=bS;gws.storage.set("lastGamePlayed",r);if(bW){bU((bS===2)||(gws.account.expansions))}else{if(bS===27){gws.client.getGame(bU)}else{bY=gws.storage.getObject("currentGame");if(bY){if(bY.sparetiles){bY.spareTiles=bY.sparetiles}if(bY.limitedtiles){bY.limitedTiles=bY.limitedtiles}if(!bY.local){gws.storage.remove("currentGame")}else{if((bY.game==bS)&&(bV==1)&&(bY.seed)){L('<span style="font-size: 1.8em">Otvaram spasio igra ...</span>',5000);gws.replay(bY.game,bY.seed,bY.moves,true,true,function(b1){if(!b1){gws.storage.remove("currentGame");bU((bS===2)||(gws.account.expansions))}});return}}}b0=gws.vars.engine.localStorage.keys.oldPreloadedGames;for(var bT=0;bT<b0.length;bT++){if(gws.storage.get(b0[bT]+bS)){gws.storage.remove(b0[bT]+bS)}}bU((bS===2)||(gws.account.expansions));return}}}}}})(gws);function bF(bQ,e){gws.beginGame(bQ,e,false,true,function(){if(gws.tutorial.index){gws.tutorial.show()}else{setTimeout(function(){gws.ads.show()},7000)}gws.trackPage("/entanglement-game-"+r);var bR=gws.storage.get("gamesPlayed");if(!bR){bR=1}else{bR=(+bR)+1}gws.storage.set("gamesPlayed",bR);if(aq){gws.showDialog(gws.currentGame.instructions);aq=false}})}gws.logOffTimeout=new function(){this.timeout=false;this.reset=function(){if(gws.account.loggedIn){clearTimeout(this.timeout);this.timeout=setTimeout(function(){gws.account.signOut()},3600000)}else{clearTimeout(this.timeout)}}};var n=2;var bG=7;var be=1;var bc=0;var bB=1;var W=false;var aL=0;function bC(e){if(W){aL=e}else{switch(+e){case 0:bc=2;bB=3;break;case 1:bc=0;bB=1;break;case 2:bc=0;bB=2;break;case 3:bc=0;bB=3;break}}af()}function aU(){if(be==1){document.getElementById("hs-score").innerHTML="<span>Duljina</span>";be=2}else{document.getElementById("hs-score").innerHTML="<span>Rezultat</span>";be=1}af()}function af(bS,bR,bQ){var e=W?aL:-1;if(bS){n=+bS}if(bR){bG=+bR}if(bQ){be=+bQ}gws.highScoreTable.innerHTML='<br /><br /><div class="scoreboard-error">Učitavanje...</div>';if(gws.account.expansions||(n==2)){document.getElementById("scoreboard-ad").style.display="none"}else{document.getElementById("scoreboard-ad").style.display="block"}gws.client.getHighScores(n,bG,e,be+bc,bB,function(bW){var bU,bV=bK(n,be),bX;if(!gws.client.online){if(bV){bU=bV.sort(function(bZ,bY){return(bY[1]-bZ[1])})}else{bU=[]}Z(bU,(+r==+n)?((W&&aL)?false:a6):false,'<div class="scoreboard-error">Morate biti online da biste vidjeli sve rezultate.</div>')}else{if(typeof bW==="string"){bX=JSON.parse(bW);bU=bX.HighScores;if(bc==2){var bT;for(bT in bV){if(bV[bT][3]){bU.splice(0,0,bV[bT])}}bU.sort(function(bZ,bY){return(bY[1]-bZ[1])})}Z(bU,(+r==+n)?((W&&aL)?false:a6):false,"")}else{ak(bW)}}})}function ak(bR){var bT="",bQ,bV,bW="",bX="",bY="",e=0,bS=bR.items,bU={developer:"Ovaj igrač razvio Entanglement","debugger":"Ovaj igrač pomogao nam je riješiti problem s isprepletenosti",excombo:"Zaplitanja manijak",extranquil:"Ovaj igrač uživa u mirnom vrtu",exclassic:"Ovaj igrač uživa Classic proširenje",exsampler:"Ovaj igrač ima ekspanzije Sampler"};if(a6&&(be==1)){recentScore=false}bT+="<table>";for(bV in bS){if(bR.playerScore&&bR.playerScore.player&&(bR.playerScore.player.playerId===bS[bV].player.playerId)){bQ=" highlight";bW=" icon-star";bY="";e=bV}else{bQ="";if(bS[bV].player.recognition){if(bS[bV].player.recognition==="plus"){bX='<img src="'+bS[bV].player.avatarImageUrl+'"/>';bY=bS[bV].player.displayName;bW=""}else{bX="&nbsp;";bW=" icon-"+bS[bV].player.recognition;bY=bU[bS[bV].player.recognition]}}else{bX="&nbsp;";bW="";bY=""}}bT+='<tr><td class="scoreboard-icon'+bW+'" title="'+bY+'">'+bX+"</td>";bT+='<td class="scoreboard-rankings"><div>'+bS[bV].scoreRank+"</div></td>";bT+='<td class="scoreboard-player-titles'+bQ+'"><div class="scoreboard-player-name"><div>'+bS[bV].player.displayName+"</div></div></td>";bT+='<td class="scoreboard-player-scores'+bQ+'"><div>'+bS[bV].formattedScore+"</div></td>";bT+="</tr>"}bT+="</table>";gws.highScoreTable.innerHTML=bT;gws.highScoreTable.scrollTop=34*(+e-3)}function Z(bW,bR,bT){var bV="",bS,bZ,b1="",bU="",b0,bY="",b2=true,bQ=0;if(bR&&(be==1)){b2=false}bV+="<table>";for(b0 in bW){b1="";bU="";if(bW[b0][0].length==3){bW[b0][0]=gws.lang.getName(0,bW[b0][0][0])+" "+gws.lang.getName(1,bW[b0][0][1])+" "+gws.lang.getName(2,bW[b0][0][2])}if(+bW[b0][2]==1){bS=" highlight";try{if(bW[b0][3]&&(typeof bW[b0][3]!="string")){bZ="offline"}else{bZ="online"}}catch(bX){bZ="online"}if(b2){b1=bZ}else{if((bR[0]==bW[b0][0])&&(bR[1]==bW[b0][1])&&(bR[2]==bW[b0][2])){b1="star";b2=true;bQ=b0}else{b1=bZ}}bY="<div>"+bW[b0][1]+"</div>"}else{bS="";if(bW[b0][5]){if(bW[b0][5]&1){b1="developer";bU="Ovaj igrač razvio Entanglement"}else{if(bW[b0][5]&2){b1="debugger";bU="Ovaj igrač pomogao nam je riješiti problem s isprepletenosti"}}}else{if(bW[b0][6]){if((bW[b0][6]&13)==13){b1="excombo";bU="Zaplitanja manijak"}else{if(bW[b0][6]&4){b1="extranquil";bU="Ovaj igrač uživa u mirnom vrtu"}else{if(bW[b0][6]&8){b1="exclassic";bU="Ovaj igrač uživa Classic proširenje"}else{if(bW[b0][6]&1){b1="exsampler";bU="Ovaj igrač ima ekspanzije Sampler"}}}}}}bY="<div>"+bW[b0][1]+"</div>"}bV+='<tr><td class="scoreboard-icon icon-'+b1+'" title="'+bU+'">&nbsp;</td>';bV+='<td class="scoreboard-rankings"><div>'+(+b0+1)+"</div></td>";bV+='<td class="scoreboard-player-titles'+bS+'"><div class="scoreboard-player-name"><div>'+bW[b0][0]+"</div></div></td>";bV+='<td class="scoreboard-player-scores'+bS+'">'+bY+"</td>";bV+="</tr>"}if(!b2){bV+='<tr><td class="scoreboard-icon icon-star">&nbsp;</td>';bV+='<td class="scoreboard-rankings"><div>'+(bW.length+1)+"</div></td>";bV+='<td class="scoreboard-player-titles highlight"><div class="scoreboard-player-name"><div>'+bR[0]+"</div></div></td>";bV+='<td class="scoreboard-player-scores highlight"><div>'+bR[1]+"</div></td>";bV+="</tr>";bQ=bW.length}bV+="</table>";gws.highScoreTable.innerHTML=bV+bT;gws.highScoreTable.scrollTop=34*(+bQ-3)}var a6=false;function a7(e){if(e||!gws.client.online){var bQ=new Date().getTime();P(r,C,s,aW[0].score,aW[0].segments,1,bQ);a6=[s,aW[0].score,1,1,r];f()}else{gws.client.setScore(gws.currentGame.id,aW[aY].score,aW[aY].segments,gws.currentGame.randomseed||gws.currentGame.randomSeed,bj,function(bR){if(bR.formattedScore&&!bR.beatenScoreTimeSpans){var bS=document.createElement("div");bS.innerHTML='<br /><br /><b style="font-size: 13em; text-shadow: 0 0 0.4em #ffffff;">'+aW[0].score+'</b><br /><br /><br /><br /><span class="submit-score-text">Vaš najbolji rezultat: '+bR.unbeatenScores[2].formattedScore+"! </span>";bS.appendChild(gws.LOW_SCORE);gws.showDialog(bS)}else{gws.scoreboard.show(r)}});a6=[s,aW[0].score,1,0,r];P(r,C,s,aW[0].score,aW[0].segments,0,new Date().getTime())}}var v=false;function ad(e){if((e.length>15)||(e=="paypal")){v=e;N();gws.showDialog(gws.LOGIN_FOR_PURCHASE,true);gws.trackPage("/entanglement-purchase-key")}return v}var ap=0;var aq=false;(function(bQ){var e=function(bR,bS){if(bR){gws.client.setPurchase("hr",(v&&(v!="paypal"))?v:false,function(bV){try{var bT=JSON.parse(bV);gws.account.expansions=bT.expansions;gws.storage.set("expansions",gws.account.expansions);gws.trackPage("/entanglement-purchase-complete");if(bS){bS()}}catch(bU){N();if(bV.substring(0,50)=="The order you are requesting either does not exist"){if(ap<5){ap++;setTimeout(function(){e(true,bS)},8000);if(ap==1){gws.showDialog("Vaša narudžba još uvijek se obrađuje.<br />Pričekajte...",true)}}else{gws.showDialog('Narudžba koju tražite ne postoji, još se obrađuje ili je već dovršena.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Ako ste upravo postavili narudžbu, pregledajte svoj račun e-pošte za Google Checkout radi obavijesti o statusu narudžbe. Ako ne primite odgovor u roku od 15 minuta, kontaktirajte <a href="mailto:feedback@gopherwoodstudios.com">feedback@gopherwoodstudios.com</a>.',true)}}else{if(bV!=""){gws.showDialog(bV,true)}}}})}else{gws.showDialog(gws.LOGIN_FOR_PURCHASE,true)}};bQ.confirmPurchase=function(bR){e(true,bR)}})(gws);function a9(){displayNames()}createNameSelections=function(){var bT=0;var bQ=15;var bS=0;var bR={};bR.a1=[];bR.a2=[];bR.n1=[];for(var e=0;e<gws.lang.NAMES.length;e++){bT=gws.lang.NAMES[e].length;bS=Math.floor(Math.random()*bT);for(var bU=0;bU<bQ;bU++){bS++;bS%=bT;if(e==0){bR.a1[bU]=bS}else{if(e==1){bR.a2[bU]=bS}else{bR.n1[bU]=bS}}}}return bR};var bz,by,bw;var bN=[],bM=[],z=[];displayNames=function(){var bS=createNameSelections();var bQ,bR=[[],[]],e=[[],[]],bT=[[],[]];for(bQ in bS.a1){bR[0].splice(0,0,gws.lang.NAMES[0][bS.a1[bQ]]);bR[1].splice(0,0,bS.a1[bQ])}for(bQ in bS.a2){e[0].splice(0,0,gws.lang.NAMES[1][bS.a2[bQ]]);e[1].splice(0,0,bS.a2[bQ])}for(bQ in bS.n1){bT[0].splice(0,0,gws.lang.NAMES[2][bS.n1[bQ]]);bT[1].splice(0,0,bS.n1[bQ])}bz=new bH("adj1",bR[0],bR[1],function(bU){bN=bU});by=new bH("adj2",e[0],e[1],function(bU){bM=bU});bw=new bH("noun",bT[0],bT[1],function(bU){z=bU});bN=[bR[0][0],bR[1][0]];bM=[e[0][0],e[1][0]];z=[bT[0][0],bT[1][0]]};function bm(){s=bN[0]+" "+bM[0]+" "+z[0];gws.client.setName([(bN[1]||1),(bM[1]||1),(z[1]||1)],s,function(e){bt(true)})}function I(e){J(e);if(e){a7()}else{gws.scoreboard.show(r)}}function J(bQ){var e=null;if(bQ){aI(bQ)}else{e=document.createElement("a");e.style.fontSize="1.8em";e.innerHTML="Prijava nije bila moguća. Pokušajte ponovo.";e.addEventListener("click",function(){gws.account.beginSignIn()},false);L(e,3000)}}function aI(bQ){var e=null;if(bQ){e=document.createElement("a");e.style.fontSize="1.8em";e.innerHTML=s;e.addEventListener("click",function(){bt=aI;gws.showDialog(gws.NAME_PICKER);a9()},false);L(e)}}var bO=bO||[];(function(bQ){window._gaq=bO;bO.push(["_setAccount","UA-1007897-6"]);bO.push(["_trackPageview","/entanglement-v"+aQ.settings.version]);bQ.trackPage=function(bS){bO.push(["_trackPageview",bS])};bQ.trackEvent=function(bT,bV,bS,bU){bO.push(["_trackEvent",bT,bV,bS,bU])};if(!(window.chrome&&chrome.app&&chrome.app.runtime)){var bR=document.createElement("script");bR.type="text/javascript";bR.async=true;bR.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(bR,e)}else{console.log("Google Analytics not loaded.")}})(gws);gws.buttonsBar=function(bX,bU){this.showMenuRight="-6.37em";this.hideMenuRight="-12.61em";this.element=gws.createElement(bX,"div",false,"button-bar");this.menuButtonLocked=false;var bW="sfx-on";this.sfxPlay=function(){document.getElementById(bW).style.visibility="visible";gws.audio.play("click")};this.sfxMute=function(){document.getElementById(bW).style.visibility="hidden";gws.audio.play("click")};var bT=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("bar-button",0,0),onClickFunction:function(){if(gws.audio.playSFX){gws.audio.playSFX();if(bU){gws.audio.playMusic()}}},altText:"Uključi zvučne efekte"},{id:"default",generalStyle:"button-default",specificStyle:bW,image:gws.assets.copyTile("bar-button",0,1),onClickFunction:function(){if(gws.audio.muteSFX){gws.audio.muteSFX();if(bU){gws.audio.muteMusic()}}},altText:"Isključi zvučne efekte"}];new gws.classes.button(this.element,"button-bar-button","sfx-button",bT);var e="music-on";this.musicPlay=function(){document.getElementById(e).style.visibility="visible";gws.audio.play("click")};this.musicMute=function(){document.getElementById(e).style.visibility="hidden";gws.audio.play("click")};var bV=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("bar-button",1,0),onClickFunction:function(){if(gws.audio.playMusic){gws.audio.playMusic()}},altText:"Uključi glazbu"},{id:"default",generalStyle:"button-default",specificStyle:e,image:gws.assets.copyTile("bar-button",1,1),onClickFunction:function(){if(gws.audio.muteMusic){gws.audio.muteMusic()}},altText:"Isključi glazbu"}];new gws.classes.button(this.element,"button-bar-button","music-button",bV);var bZ="log-in-on";this.showLoggedOff=function(){document.getElementById(bZ).style.visibility="hidden"};this.showLoggedOn=function(){document.getElementById(bZ).style.visibility="visible"};var bY=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("bar-button",2,0),onClickFunction:function(){gws.account.beginSignIn();gws.audio.play("click")},altText:"Prijava"},{id:"default",generalStyle:"button-default",specificStyle:bZ,image:gws.assets.copyTile("bar-button",2,1),onClickFunction:function(){gws.account.beginSignOut();gws.audio.play("click")},altText:"Odjava"}];new gws.classes.button(this.element,"button-bar-button","log-in-button",bY);var bS="bb-menu-on";this.menuShow=function(){};this.menuShow=function(){if(!this.menuButtonLocked){gws.sideMenu.show()}};this.menuHide=function(){if(!this.menuButtonLocked){gws.sideMenu.hide();bI();bl()}};var bR=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("bar-button",3,0),onClickFunction:this.menuShow},{id:"default",generalStyle:"button-default",specificStyle:bS,image:gws.assets.copyTile("bar-button",3,1),onClickFunction:this.menuHide}];new gws.classes.button(this.element,"button-bar-button","bb-menu-button",bR);var bQ=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("bar-button",4,0),onClickFunction:function(){gws.loadURL("http://www.gopherwoodstudios.com/")}}];new gws.classes.button(this.element,"button-bar-button","gopher-button",bQ)};gws.buttonsBar.prototype.showMenuButton=function(){if(gws.browser.mobile){this.menuButtonLocked=false;this.element.style.right=this.showMenuRight}};gws.buttonsBar.prototype.hideMenuButton=function(){if(gws.browser.mobile){this.menuButtonLocked=true;this.element.style.right=this.hideMenuRight}};gws.classes.buyPage=(function(){var e=function(bU,bR){var bS=this;this.parent=bU;this.isMobile=bR||false;this.isLoggedIn=false;this.currentItemIndex=0;this.showing=false;this.page=gws.createElement(this.parent,"div",false,"buy-page");if(!gws.browser.phonegap){gws.createImage(this.page,"img",false,"buy-page-divider","i/line.png")}this.titlePanel=gws.createElement(this.page,"div",false,"title-panel");gws.createTextBlock(this.titlePanel,"div",false,"buy-page-title","Tržište");gws.createImage(this.titlePanel,"img",false,"buy-page-title-underline","i/line.png");this.buttonDefs=gws.vars.view.buyPage.buttons;this.buttonPanel=gws.createElement(this.page,"div",false,"button-panel");this.buttons=[];this.buttonItemKey=[];this.detailDefs=gws.vars.view.buyPage.details;this.detailPanel=gws.createElement(this.page,"div",false,"detail-panel");this.itemTitle=undefined;this.itemSubTitle=undefined;this.tiedToAccountMessage=gws.createTextBlock(this.page,"div",false,"tied-to-account","Kupnje su vezane uz vaš Google Račun.");var bT=[];bT[0]={id:"default",generalStyle:"button-default",image:gws.assets.copyTile("exit",0,0),onClickFunction:function(){gws.buyPage.hide()}};bT[1]={id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile("exit",1,0),onClickFunction:function(){gws.buyPage.hide()}};new gws.classes.button(this.page,false,"buy-page-exit-button",bT);this.buyMessage=undefined;this.loginMessage=undefined};var bQ=e.prototype;bQ.refresh=function(){if(this.showing){this.show()}};bQ.show=function(bT){var bS=this,bU=0;this.showing=true;this.isLoggedIn=gws.account.loggedIn;this.page.style.display="block";setTimeout(function(){bS.page.style.opacity=1},10);gws.controlBar.hideMenuButton();if(this.isLoggedIn){this.tiedToAccountMessage.innerHTML="Kupnje su vezane uz vaš Google Račun."}else{this.tiedToAccountMessage.innerHTML="Kupnje su vezane uz vaš Google Račun. Prijavite se ako ga već imate."}this.buttonPanel.innerHTML="";this.buttons=[];this.buttonItemKey=[];for(var bR=0;bR<this.buttonDefs.length;bR++){this.createMainButton(this.buttonDefs[bR])}if(bT){this.toggleItem(bT)}else{if(this.currentItemIndex){this.toggleItem(this.currentItemIndex)}else{this.toggleButton(0)}}};bQ.createMainButton=function(bU){var bT=this.buttons.length;var bW=bU;var bX=bW.special?2:0;var bS=bW.special?3:1;var bR=(gws.account.expansions&bW.itemIndex)==bW.itemIndex;var bV=[];bV[0]={id:"default",generalStyle:"button-default",image:gws.assets.copyTile("main-menu-buttons",0,bX),text:bW.text,textStyle:"buy-page-menu-button-text",onClickFunction:function(){gws.buyPage.toggleButton(bT)}};bV[1]={id:"selected",generalStyle:"button-default",image:gws.assets.copyTile("main-menu-buttons",0,bS),text:bW.text,textStyle:"buy-page-menu-button-text",onClickFunction:function(){gws.buyPage.toggleButton(bT)}};if(!this.isMobile){bV[2]={id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile("main-menu-buttons",0,bS),text:bW.text,textStyle:"buy-page-menu-button-text",onClickFunction:function(){gws.buyPage.toggleButton(bT)}}}if(typeof bU.iconColumn!=="undefined"){bV[this.isMobile?2:3]={id:"icon",generalStyle:bR?"buy-page-button-icon":"buy-page-button-icon-faded",image:gws.assets.copyTile("menu-icons",7,2),onClickFunction:function(){gws.buyPage.toggleButton(bT)}}}this.buttons.push(new gws.classes.button(this.buttonPanel,"buy-page-menu-button",bW.id,bV));this.buttons[bT].hideLayer("selected");this.buttonItemKey[bT]=bW.itemIndex};bQ.toggleButton=function(bS){for(var bR=0;bR<this.buttons.length;bR++){if(bR==bS){this.buttons[bR].showLayer("selected");gws.buyPage.showDetailPanel(this.buttonItemKey[bR])}else{this.buttons[bR].hideLayer("selected")}}};bQ.toggleItem=function(bS){for(var bR=0;bR<this.buttonItemKey.length;bR++){if(this.buttonItemKey[bR]==bS){this.toggleButton(bR);return}}this.toggleButton(0)};bQ.showDetailPanel=function(bR){var b2=this;var bS=undefined;var bV=null;gws.trackPage("/buy-page-"+bR);if(this.buyMessage){this.buyMessage.innerHTML=""}if(this.loginMessage){this.loginMessage.innerHTML=""}this.detailPanel.innerHTML="";switch(bR){case 1:bS=gws.vars.view.buyPage.details.oldSakura;this.currentItemIndex=1;break;case 8:bS=gws.vars.view.buyPage.details.classic;this.currentItemIndex=8;break;case 13:bS=gws.vars.view.buyPage.details.combo;this.currentItemIndex=13;break;case 4:default:bS=gws.vars.view.buyPage.details.newSakura;this.currentItemIndex=4;break}this.itemTitle=gws.createTextBlock(this.detailPanel,"div",false,"buy-details-title",bS.title);this.itemSubTitle=gws.createTextBlock(this.detailPanel,"div",false,"buy-details-subtitle",bS.subtitle);if(typeof bS.iconColumn!=="undefined"){var bZ=gws.assets.copyTile("menu-icons",bS.iconColumn,bS.iconRow);bZ.className="buy-details-icon";this.detailPanel.appendChild(bZ)}bV=new gws.classes.pageSwipe({className:"page-swipe buy-page-swipe",parent:this.detailPanel,pages:bS.pages,onSwipe:function(b4,b3){}});if(this.isLoggedIn&&!navigator.mozPay){this.buyMessage=gws.createElement(this.detailPanel,"div",false,"buy-message");if((gws.account.expansions&bR)==bR){var bW=gws.createElement(this.detailPanel,"div",false,"trial-message");bW.style.right="50%";bW.style.marginRight="-12.5em";gws.createTextBlock(bW,"div",false,"buy-page-try-trial","Vi već posjedujete to. Probajte ga danas!");var b1=[];b1[0]={id:"default",generalStyle:"button-default",text:"Pokušajte ga!",textStyle:"buy-page-trial-button-text",image:gws.assets.copyTile("button-tiny",0,0)};b1[1]={id:"hover",generalStyle:"button-hover",text:"Pokušajte ga!",textStyle:"buy-page-trial-button-text",image:gws.assets.copyTile("button-tiny",1,0),onClickFunction:function(){gws.buyPage.hide();bF(bV.getValue(),1)}};new gws.classes.button(bW,false,"buy-page-trial-button",b1)}else{if(gws.account.expansionPrices){if(gws.browser.phonegap){gws.createTextBlock(this.buyMessage,"div",false,"buy-page-purchase-for","Ovo proširenje može se kupiti online.")}else{if(window.chrome&&chrome.app&&chrome.app.runtime){gws.createTextBlock(this.buyMessage,"div",false,"buy-page-purchase-for","Ovo proširenje može se kupiti u Chrome web-trgovini.")}else{gws.createTextBlock(this.buyMessage,"div",false,"buy-page-purchase-for","Kupnja za "+gws.account.expansionPrices[bS.priceIndex])}}}var bU=gws.createElement(this.buyMessage,"div",false,"buy-buttons-box");if(gws.browser.phonegap){new gws.classes.button(this.buyMessage,false,"buy-page-buy-button",[{id:"default",generalStyle:"button-default",text:"Kupite sad",textStyle:"buy-page-buy-button-text",image:gws.assets.copyTile("button-tiny",0,0)},{id:"hover",generalStyle:"button-hover",text:"Kupite sad",textStyle:"buy-page-buy-button-text",image:gws.assets.copyTile("button-tiny",1,0),onClickFunction:function(){gws.loadURL("http://entanglement.gopherwoodstudios.com/?item="+bR)}}])}else{if(window.chrome&&chrome.app&&chrome.app.runtime){new gws.classes.button(this.buyMessage,false,"buy-page-buy-button",[{id:"default",generalStyle:"button-default",text:"Kupite sad",textStyle:"buy-page-buy-button-text",image:gws.assets.copyTile("button-tiny",0,0)},{id:"hover",generalStyle:"button-hover",text:"Kupite sad",textStyle:"buy-page-buy-button-text",image:gws.assets.copyTile("button-tiny",1,0),onClickFunction:function(){gws.loadURL("https://chrome.google.com/webstore/detail/entanglement/cmnpffgfpcohhpoddjankjanolcekbni")}}])}else{if(gws.payments.firefox){new gws.classes.button(this.buyMessage,false,"buy-page-buy-button",[{id:"default",generalStyle:"button-default",text:"Kupite sad",textStyle:"buy-page-buy-button-text",image:gws.assets.copyTile("button-tiny",0,0)},{id:"hover",generalStyle:"button-hover",text:"Kupite sad",textStyle:"buy-page-buy-button-text",image:gws.assets.copyTile("button-tiny",1,0),onClickFunction:function(){var b3=bV.getValue();gws.payments.firefox.buy(bS.buyIndex,function(){if((bR==4)||(bR==1)){aq=true}b2.hide();bF(b3,1)})}}])}else{if(gws.payments.paypal){var bT=gws.createElement(bU,"a",false,"buy-page-PPP");bT.onclick=function(){var b3=bV.getValue();gws.payments.paypal.buy(bS.buyIndex,function(){if((bR==4)||(bR==1)){aq=true}b2.hide();bF(b3,1)})};bT.style.cursor="pointer";gws.createImage(bT,"img",false,"buy-page-PPP-img","https://www.paypal.com/en_US/i/btn/btn_dg_pay_w_paypal.gif","Kupite sad");var b0=gws.createElement(bU,"a",false,"buy-page-CWS");b0.onclick=function(){gws.loadURL("https://chrome.google.com/webstore/detail/entanglement/cmnpffgfpcohhpoddjankjanolcekbni")};b0.style.cursor="pointer";gws.createImage(b0,"img",false,"buy-page-CWS-img","i/chrome-web-store.png","Kupite sad")}}}}this.buyMessage.style.left="50%";this.buyMessage.style.marginLeft="-12.5em"}}else{if(gws.payments.firefox){this.loginMessage=gws.createElement(this.detailPanel,"div",false,"login-message");new gws.classes.button(this.loginMessage,false,"buy-page-cio-button",[{id:"default",generalStyle:"button-default",text:"Check it out",textStyle:"buy-page-menu-button-text",image:gws.assets.copyTile("main-menu-buttons",0,0)},{id:"hover",generalStyle:"button-hover",text:"Check it out",textStyle:"buy-page-menu-button-text",image:gws.assets.copyTile("main-menu-buttons",0,1),onClickFunction:function(){gws.loadURL("http://entanglement.gopherwoodstudios.com/?item="+bR)}}]);gws.createTextBlock(this.loginMessage,"div","buy-page-sample-1",false,"Ekspanzija dostupni samo online.")}else{this.loginMessage=gws.createElement(this.detailPanel,"div",false,"login-message");var bX=gws.createElement(this.loginMessage,"div","med-button login-button");bX.innerHTML="Prijava";var bY=gws.createElement(bX,"a");bY.innerHTML="Prijava";bY.addEventListener("click",function(){gws.account.beginSignIn(function(){gws.buyPage.show()})},false);gws.createTextBlock(this.loginMessage,"div","buy-page-sample-1",false,"Prijavite se ako ga već imate.")}}};bQ.hide=function(){var bR=this;this.showing=false;this.page.style.opacity=0;setTimeout(function(){bR.page.style.display="none"},1000);bl();if(c[c.length-1]=="game-over"){gws.controlBar.showMenuButton()}};bQ.showSlide=function(bS,bR){this.expansionImageBarText.innerHTML=bS;this.expansionImage.style.left=-bR*this.expansionImageClipWidth+"em"};return e})();var aS=new Image();aS.src="i/rotate-buttons.png";function bA(b5,ca,b4,b2,b6,bR,bS,b8){try{var bZ=0.75;var bX=bZ*ca;if(b6){bX*=1.15}if(bS){bX*=0.9}var bW=bZ*ca;if(bR){bW*=1.15}if(b8){bW*=0.9}var bY=((1-bW)*b4)/6;var b3=(b4*2/3)+((1-bX)*b4)/6;var bT=b2*0.66+(1-bW)*b2/6;var bQ=b2*0.66+(1-bX)*b4/6;var b0=b4*bW/3;var b1=b2*bW/3;var bV=b4*bX/3;var bU=b2*bX/3;var b9=b5.globalAlpha;b5.globalAlpha=bX*ca;b5.drawImage(aS,aS.width/2,0,aS.width/2,aS.height,b3,bQ,bV,bU);b5.globalAlpha=bW*ca;b5.drawImage(aS,0,0,aS.width/2,aS.height,bY,bT,b0,b1);b5.globalAlpha=b9}catch(b7){}}(function(bQ){var e="";bQ.client=function(bR){this.address=bR||e};bQ.client.prototype.get=function(bV,bW){var bT=new XMLHttpRequest(),bR=this;var bS=new Date().getTime();var bU="?";this.online=true;if(this.plus&&this.plus.id){bS+="&p="+this.plus.id}if(bV.indexOf("?")>0){bU="&"}bT.open("GET",this.address+bV+bU+"nocache="+bS,true);bT.onreadystatechange=function(){if(this.readyState==4){bR.online=(this.responseText!=="offline");bW(this.responseText)}};bT.withCredentials=true;bT.send(null)};bQ.client.prototype.post=function(bW,bV,bY){var bR="",bU="",bT=null,bX=new XMLHttpRequest(),bS=new Date().getTime();if(typeof bV==="string"){bR=bV}else{for(bT in bV){bR+=bU+bT+"="+bV[bT];bU="&"}}if(bW.indexOf("?")>0){bU="&"}else{bU="?"}bX.open("POST",this.address+bW+bU+"nocache="+bS,true);bX.responseType="text";bX.setRequestHeader("Content-type","application/x-www-form-urlencoded");bX.onload=function(bZ){if(this.status===200){self.online=(this.responseText!=="offline");bY(this.responseText)}};bX.withCredentials=true;bX.send(bR)};bQ.client.prototype.getGame=function(bR){this.get("dailychallenge",function(bT){var bS=null;try{bS=JSON.parse(bT);if(bS&&bS.access){bR(bS)}else{bR(false)}}catch(bU){bR(false)}})};bQ.client.prototype.connectPlus=function(bR,bS){this.post("plus",{code:bR,gplus_id:""},bS)};bQ.client.prototype.getHighScores=function(bT,bV,bU,bS,bR,bW){this.get("engine?g="+bT+"&daysago="+bU+"&h="+bS+"&d="+bR,bW)};bQ.client.prototype.setScore=function(bT,bW,bS,bR,bU,bV){this.get("engine?x=1&v="+bU+"&s="+bW+"&l="+bS+"&g="+bT+"&c="+(bR||-1)+"&sme=v2",bV)};bQ.client.prototype.setPurchase=function(bT,bR,bS){if(bR){this.get("authenticate?lang="+bT+"&order="+bR,bS)}else{this.get("iap-confirm?lang="+bT,bS)}};bQ.client.prototype.getPurchase=function(bU,bR,bS,bT){this.get("iap-jwt?lang="+bU+"&item="+bR+"&sys="+(bS||""),bT)};bQ.client.prototype.setName=function(bR,bT,bS){this.get("engine?a1="+bR[0]+"&a2="+bR[1]+"&n="+bR[2]+"&u="+bT,bS)};bQ.client.prototype.getUser=function(bR){this.get("engine?o=1&ffm="+!!(navigator.mozPay),bR)};bQ.client.prototype.hasExpansionSet=(function(){var bR=false;return function(bS){if(bR){bS(bR)}else{this.get("expansion",function(bV){var bT=null;try{bT=JSON.parse(bV)}catch(bU){}if(bT&&(bT.access>0)){bR=true}bS(bR)})}}})()})(gws.classes);gws.classes=gws.classes||{};(function(){if(typeof gapi!=="undefined"){throw new Error("gapi already defined.")}if(!(window.chrome&&chrome.app&&chrome.app.runtime)){if(location.host.search("gopherwoodstudios.com")>=0){var e=document.createElement("script");e.src="https://apis.google.com/js/client.js?onload=plusReady";document.getElementsByTagName("head")[0].appendChild(e)}return}window.gapi={};gapi.auth={};gapi.client={};var bQ=undefined;gapi.auth.authorize=function(bT,bU){if(typeof bU!=="function"){throw new Error("callback required")}var bR={};bR.interactive=bT.immediate===false||false;console.assert(!bT.response_type||bT.response_type=="token");var bS=function(bV){bQ=bV;if(typeof bQ!=="undefined"){bU({access_token:bQ})}else{bU()}};if(window.chrome&&chrome.identity){chrome.identity.getAuthToken(bR,bS)}};gapi.client.request=function(bS){if(typeof bS!=="object"){throw new Error("args required")}if(typeof bS.callback!=="function"){throw new Error("callback required")}if(typeof bS.path!=="string"){throw new Error("path required")}var bU="https://www.googleapis.com"+bS.path;if(typeof bS.params==="object"){var bR="?";for(var bT in bS.params){bU+=bR+encodeURIComponent(bT)+"="+encodeURIComponent(bS.params[bT]);bR="&"}}var bV=new XMLHttpRequest();bV.open(bS.method||"GET",bU);bV.setRequestHeader("Authorization","Bearer "+bQ);if(typeof bS.body!=="undefined"){bV.setRequestHeader("content-type","application/json");bV.send(JSON.stringify(bS.body))}else{bV.send()}bV.onerror=function(){};bV.onload=function(){var bZ={gapiRequest:{data:{status:this.status,statusText:this.statusText}}};var bX=null;try{bX=JSON.parse(this.response)}catch(bY){}var bW=JSON.stringify(bZ);bS.callback(bX,bW)}};setTimeout(function(){plusReady()},0)})();(function(b9){var bX=false,b0=null,bT=false,b4=false,bQ=function(cb,cc){var ca=new Date(cb);ca.setDate(cb.getDate()+cc);return ca},e=function(cd){var cc=0,ca=null,cb=null,ce=function(){cc-=1;if(!cc){b0(ca,cb,bT)}};console.log("Hooray! You're logged in!");if((gws.storage.get("google-games")==="yes")||(!gws.storage.get("google-games"))){if(!gws.storage.get("google-games")){gws.storage.set("google-games","yes")}cc+=1;b5("/games/v1/players/me",null,function(cf){if(cf.error){console.log("Google Games not connected.")}else{bT=true}ce()})}cc+=1;b5("/oauth2/v2/userinfo",null,function(cf){console.log(cf);ca=cf.id;cb=cf.email;ce()});cc+=1;b5("/appstate/v1/states",{includeData:true},function(ch){var cg={},cf=null;if(ch&&ch.items&&ch.items.length){cf=ch.items[0]}else{cf={}}console.log("DATA",cf);if(cf.data){try{cg=JSON.parse(cf.data)}catch(ci){}}if(!cg.accept){cg.accept=bQ(new Date(),7).getTime();console.log("JSON",cg);setTimeout(function(){if(gws.account){cg.userName=s;cg.access=gws.account.expansions;bU("/appstate/v1/states/0",{stateKey:0,currentStateVersion:cf.currentStateVersion||""},{kind:"appstate#updateRequest",data:JSON.stringify(cg)},function(cj){});b7()}},15000)}else{if(cg.accept<new Date().getTime()){b4=true}}ce()});if(cd.error){console.log("error:"+cd.error)}},bS={client_id:"225754014403.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/games https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/appstate",immediate:true},b2=function(){setTimeout(function(){console.log("Trying silent auth");gapi.auth.authorize(bS,bY)},1)},bV=false,bY=function(cc){console.log("We are in handle auth result",cc);if(cc&&(cc.error!=="immediate_failed")){e(cc);bV=true}else{b0(false);console.log("Plus disconnected.");var ca=document.createElement("a"),cb=function(){bS.immediate=false;gapi.auth.authorize(bS,bY)};gws.plusLogin=cb}},b3=function(ca){b0=ca||b0;if(bX){b2()}else{bX=true}},b8=function(cb,ca){if(ca){return function(cc,cd){if(cc&&cc.error){console.log("Response: ",cc);if(bV&&(cc.error.code===401)){bS.immediate=true;gapi.auth.authorize(bS,function(ce){ca()});return}}cb(cc,cd)}}else{return function(cc,cd){if(cc&&cc.error){console.log("Response: ",cc)}cb(cc,cd)}}},b5=function(ca,cc,cb){gapi.client.request({path:ca,params:cc||{},callback:b8(cb,function(){gapi.client.request({path:ca,params:cc||{},callback:b8(cb)})})})},b1=function(cb,cd,ca,cc){gapi.client.request({path:cb,params:cd||{},method:"post",body:ca||null,callback:b8(cc,function(){gapi.client.request({path:cb,params:cd||{},method:"post",body:ca||null,callback:b8(cc)})})})},bU=function(cb,cd,ca,cc){gapi.client.request({path:cb,params:cd||{},method:"put",body:ca||null,callback:b8(cc,function(){gapi.client.request({path:cb,params:cd||{},method:"put",body:ca||null,callback:b8(cc)})})})},bW=function(cb,ca){ca.getHighScores(cb.gameId,null,-1,3,3,function(cf){var cc=null,ce=0;console.log(cf);try{cc=JSON.parse(cf)}catch(cd){cc={}}if(cc.HighScores&&cc.HighScores[0]){console.log("Found map "+cb.gameId+" high score: "+JSON.stringify(cc.HighScores[0]));ce=cc.HighScores[0][1];gws.client.setPlusScore(cb.gameId,ce,function(cg){console.log("Added high score from map "+cb.gameId+" to Google Games leaderboard.")})}})},b7=function(){var ca=0,cb=gws.vars.view.leaderboard.maps;for(ca=0;ca<cb.length;ca++){bW(cb[ca],gws.client.gameServer||gws.client)}},bR=function(cb,cc){var ca=this;this.gameServer=cb;this.gameServer.plus=this;this.id=false;this.email=false;this.online=true;b3(function(ce,cd){console.log("Plus ID: "+ce);ca.id=ce;ca.email=cd;cc(!!ce)})},bZ=bR.prototype,b6={};window.plusReady=function(){b3();delete window.plusReady};window.plusCallback=function(ca){console.log("plus Call back!",ca);bY(ca)};bZ.getGame=function(ca){this.gameServer.getGame(ca)};bZ.getHighScores=function(ci,ca,ch,cd,cg,ce){var cj=this,cc=0,cb=gws.vars.view.leaderboard.maps,cf="";if(bT&&b4&&(ci!==27)){for(;cc<cb.length;cc++){if(cb[cc].gameId==ci){cf=cb[cc].plusId;break}}if(!cf){cf=cb[0].plusId}b5("/games/v1/leaderboards/"+cf+"/window/"+[0,"PUBLIC","PUBLIC","SOCIAL","SOCIAL"][cd],{collection:[0,"PUBLIC","PUBLIC","SOCIAL","SOCIAL"][cd],timeSpan:[0,"DAILY","WEEKLY","ALL_TIME"][cg],leaderboardId:cf},function(co){var cm=0,ck=co.items,cn=[],cl=function(){var cp=0,cq=null;for(;cp<ck.length;cp++){cq=b6[ck[cp].player.playerId];if(cq){ck[cp].player.displayName=cq.displayName;ck[cp].player.recognition=cq.recognition}}ce(co)};if(!ck){co.items=ck=[]}for(;cm<ck.length;cm++){if(!b6[ck[cm].player.playerId]){cn.push(ck[cm].player.playerId)}}if(cn.length){cj.gameServer.post("plus-players",{ids:JSON.stringify(cn)},function(cq){var cp=0;cq=JSON.parse(cq);for(;cp<ck.length;cp++){if(cq[cp]){b6[cq[cp].playerId]={displayName:cq[cp].displayName,recognition:cq[cp].recognition}}}cl()})}else{cl()}})}else{this.gameServer.getHighScores(ci,ca,ch,cd,cg,ce)}};bZ.setPlusScore=function(cd,ch,cg){var cc=0,ce=gws.vars.view.leaderboard.maps,cf=false,cb=null,ca=false;for(;cc<ce.length;cc++){if(ce[cc].gameId===cd){ca=ce[cc].plusId;cf=ce[cc].achievements;break}}if(ca){b1("/games/v1/leaderboards/"+ca+"/scores",{leaderboardId:ca,score:ch},null,cg)}if(cf){for(cc=0;cc<cf.length;cc++){if(cf[cc].score&&(cf[cc].score<=ch)){cb=cf[cc].plusId;b1("/games/v1/achievements/"+cb+"/unlock",{achievementId:cb},null,function(ci){console.log("ach award: "+cf[cc].title)})}else{break}}}};bZ.setScore=function(cc,cg,cb,ca,ce,cf){var cd=0;if(bT){cd+=1;this.setPlusScore(cc,cg,function(ch){cd-=1;if(!cd){cf(ch)}})}if(!bT||!b4||(cc===27)){cd+=1;this.gameServer.setScore(cc,cg,cb,ca,ce,cf)}};bZ.setPurchase=function(cc,ca,cb){this.gameServer.setPurchase(cc,ca,cb)};bZ.getPurchase=function(cd,ca,cb,cc){this.gameServer.getPurchase(cd,ca,cb,cc)};bZ.setName=function(ca,cc,cb){this.gameServer.setName(ca,cc,cb)};bZ.hasExpansionSet=(function(){var ca=0,cb=false,cc=window.chrome&&chrome.app&&chrome.app.runtime;return function(ce,cf){var cd=this;if(cb){cf(ca)}else{cb=true;if(cc&&gws.storage.get("full-version")){ca=15;cf(ca)}else{if(ce>0){ca=15;if(cc){gws.storage.set("full-version",true)}cf(ca)}else{if(cc){b5("/chromewebstore/v1.1/userlicenses/"+chrome.runtime.id,null,function(cg){if(cg&&cg.accessLevel&&(cg.accessLevel==="FULL")){ca=15;gws.storage.set("full-version",true);cd.gameServer.post("plus-sync",{email:cd.email,plusId:cd.id,app:"true"},function(ch){})}cf(ca)})}else{cf(ca)}}}}}})();bZ.getUser=function(cb){var ca=this;this.gameServer.get("engine?o=1&ffm="+!!(navigator.mozPay),function(ce){var cc=null;try{cc=JSON.parse(ce)}catch(cd){}if(cc){ca.hasExpansionSet(cc.expansions,function(cf){if(cf){cc.expansions=cf;ce=JSON.stringify(cc)}cb(ce)})}else{ca.gameServer.post("plus-sync",{email:ca.email,plusId:ca.id},function(cg){try{cc=JSON.parse(cg)}catch(cf){}if(cc){ca.hasExpansionSet(cc.expansions,function(ch){if(ch){cc.expansions=ch;cg=JSON.stringify(cc)}cb(cg)})}else{cb(cg)}})}})};b9.classes=b9.classes||{};b9.classes.plusClient=bR})(gws);(function(e){e.addToHomeScreen=function(){var bS=false,bQ=e.browser,bR=e.storage.get("offered-shortcut");className="";if(!bR&&bQ.iOS&&!bQ.chrome){e.storage.set("offered-shortcut","true");bS=document.createElement("div");bS.innerHTML='Dodirnite IOSSHARE i odaberite "Dodaj u početni zaslon" dodati zaplitanja na svoj početni zaslon!'.replace("IOSSHARE",'<img src="i/ios-share.png" />');if(bQ.iPad){className="add-to-homescreen ipad"}else{className="add-to-homescreen ipod"}bS.className=className;e.bodyClip.appendChild(bS);setTimeout(function(){bS.className=className+" slide-in";setTimeout(function(){bS.className=className;setTimeout(function(){e.bodyClip.removeChild(bS)},1000)},10000)},1000)}}})(gws);gws.lang={NAMES:[["slatki","uskihani","blještavi","veseli","meki","nervozni","šašavi","suglasni","oprezni","tajanstveni","skupocjeni","uzvišeni","tajni","prvi","smioni","empatični","radosni","bistri","neurotični"],["bistrooki","hrskavi","uredni","ljuskasti","prašnjavi","tvrdi","slobodni","pustolovni","spori","zajedljivi","zaposleni","posljednji","plemeniti","lukavi","ambiciozni","pospani","sočni","čangrizavi","ljigavi"],["daždevnjak","vrč","vlak","brat","lakrdijaš","kauboj","šešir","jastuk","papagaj","kauč","kojot","pokrivač","motorkotač","voćnjak","stol","krater","planet","lakat","snjegović"]],getName:function(bQ,e){var bR=gws.lang.NAMES[bQ];return bR[e%bR.length]}};(function(){var e=Date.now();if(Math){Math.randomSeed=function(bR){var bQ=10000;if(!isNaN(bR)){e=bR-1}e=(e%2147483647)+1;bQ*=Math.sin(e);return bQ-Math.floor(bQ)}}}());function D(e){if(isNaN(e)){return 0}else{return(e)?(+e):0}}function t(bR){var e=bR[0]*Math.cos(bR[1]);var bQ=bR[0]*Math.sin(bR[1]);return[e,bQ]}function aB(bR){var e=Math.sqrt(Math.pow(bR[0],2)+Math.pow(bR[1],2));var bQ=0;if(e!=0){var bQ=Math.acos(bR[0]/e);if(bR[1]<0){bQ=(Math.PI*2)-bQ}}return[e,bQ]}function m(bR,bQ){var bT=0;var bS=0;var e=0;if(bR.length==7){if(bR.charAt(0)=="#"){bT=parseInt(bR.charAt(1)+bR.charAt(2),16);bS=parseInt(bR.charAt(3)+bR.charAt(4),16);e=parseInt(bR.charAt(5)+bR.charAt(6),16)}}return"rgba("+bT+","+bS+","+e+","+bQ+")"}function ao(e){return Math.abs(((e*1711)%1311)/1311)}function a2(e){return(location.search.substring(location.search.indexOf(e+"=")+e.length+1)+"& ").split("&")[0]}gws.secondsToHM=function(bR){var bQ=Math.floor(bR/3600);var e=Math.floor(bR%3600/60);return((bQ>0?bQ+":":"0:")+(e>=0?(e<10?"0":"")+e:"0"))};try{if(!window.console){window.console={log:function(bQ,e){},error:function(bQ,e){},warn:function(bQ,e){},info:function(bQ,e){}}}}catch(a5){}gws.zeroify=function(e){if(isNaN(e)){return 0}else{return(e)?(+e):0}};gws.copyObject=function(e){return JSON.parse(JSON.stringify(e))};gws.polarToCartesian=function(bS){var bQ=bS||{m:0,a:0};var e=bQ.m*Math.cos(bQ.a);var bR=bQ.m*Math.sin(bQ.a);return{x:e,y:bR}};gws.cartesianToPolar=function(bS){var bR=bS||{x:0,y:0};var e=Math.sqrt(Math.pow(bR.x,2)+Math.pow(bR.y,2));var bQ=0;if(e!=0){bQ=Math.acos(bR.x/e);if(bR.y<0){bQ=(Math.PI*2)-bQ}}return{m:e,a:bQ}};gws.getDistance=function(bQ,e){return gws.cartesianToPolar({x:bQ.x-e.x,y:bQ.y-e.y}).m};gws.choose=function(bR,bQ,bV,bU,bT,bS){if(typeof bR!="undefined"){return bR}if(typeof bQ!="undefined"){return bQ}if(typeof bV!="undefined"){return bV}if(typeof bU!="undefined"){return bU}if(typeof bT!="undefined"){return bT}if(typeof bS!="undefined"){return bS}};function a2(e){return(location.search.substring(location.search.indexOf(e+"=")+e.length+1)+"& ").split("&")[0]}gws.createElement=function(bS,e,bR,bT){var bQ=document.createElement(e);bR?bQ.className=bR:false;bT?bQ.id=bT:false;bS?bS.appendChild(bQ):false;return bQ};gws.createImage=function(bT,e,bS,bV,bQ,bU){var bR=gws.createElement(bT,e,bS,bV);bR.src=bQ;if(bU){bR.setAttribute("alt",bU)}return bR};gws.createTextBlock=function(bS,e,bR,bV,bU,bT){var bQ=gws.createElement(bS,e,bR,bV);bQ.innerHTML=bU;if(bT){bQ.setAttribute("title",bT)}return bQ};function aF(bQ){var bR="",e,bS;bR+="<table>";for(bS in bQ){bR+="<tr>";for(e in bQ[bS]){if(bS==0){bR+="<th>"+bQ[bS][e]+"</th>"}else{bR+="<td>"+bQ[bS][e]+"</td>"}}bR+="</tr>"}bR+="</table>";return bR}function u(){var bQ=[];for(e in aW){bQ[e]=[];bQ[e][0]=0;bQ[e][1]=aW[e].segments;bQ[e][2]=aW[e].score;bQ[e][3]=aW[e].team.toLowerCase();bQ[e][4]=+e}bQ.sort(function(bU,bT){return(bT[2]-bU[2])});for(e in bQ){bQ[e][0]=(+e+1)}var bR="<table>",e,bS;bR+="<tr><th><div>Mjesto</div></th><th><div>Duljina</div></th><th><div>Rezultat</div></th><th></th></tr>";for(bS in bQ){bR+="<tr>";bR+='<td class="scoreboard-rankings"><div>'+bQ[bS][0]+"</div></td>";bR+='<td class="scoreboard-player-results"><div>'+bQ[bS][1]+"</div></td>";bR+='<td class="scoreboard-player-results"><div>'+bQ[bS][2]+"</div></td>";bR+='<td class="scoreboard-icon icon-person-'+bQ[bS][4]+'">&nbsp;</td>';bR+="</tr>"}bR+="</table>";return bR}var a4=false;var O=true;var o=0;var av=false;var am=false;var at=false;var ai=false;var ba=false;var bj="";var bp="";var bh=0;var F=[0,0];function ab(bQ,e){if(U){gws.tileController.rotateTile(bQ);if(!e){if(gws.tutorial.index==1){gws.tutorial.show(2)}if(bg){gws.audio.play("Turn"+bg[bd]);bd=(bd+1)%bg.length}else{gws.audio.play("Turn"+Math.floor(Math.random()*3))}}F[bh]=(F[bh]+bQ+6)%6}}var bv=0;function aM(bT,bX,bR){var bU=gws.storage.getObject("currentGame");if(!bT&&(gws.currentGame.id<100000)&&bU&&bU.local&&(gws.currentGame.randomSeed===bU.seed)&&(bU.moves.length>bj.length)){L('<span style="font-size: 1.8em">Otvaram spasio igra ...</span>',2000);gws.replay(bU.game,bU.seed,bU.moves,!bR,true,function(bY){if(!bY){gws.storage.remove("currentGame")}})}else{if(!aE&&(!S||bT)){o=0;if((gws.tutorial.index>2)&&(gws.tutorial.index<6)){gws.tutorial.hide();gws.tutorial.index++}if(gws.tutorial.index==2){gws.tutorial.show(3)}if(gws.tutorial.index==6){gws.tutorial.show(6)}ae.setType("path",aW[aY].tiles[0].pairs.slice());ae.colors=["gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray"];ae.paint();ae.render();var bV=0;for(bV in aW){var bS=aW[bV].segments;var bW=aW[bV].startTile.countSegments(aW[bV].startPath,0,aW[bV],bX);aW[bV].segments=bW.iSegments;bS=aW[bV].segments-bS+1;if((+bV==+aY)&&(bS>1)&&!bX){switch(bW.sBonusType){case"points":gws.audio.play("bonus-points");break;case"tile":gws.audio.play("bonus-tile");break;case"unlock":gws.audio.play("bonus-unlock");break;default:var bQ=[5,2,2,2,2,2,1,1,1,2];var e=Math.min(10,bS-1);if(aG&&(e===1)){gws.audio.play("Line"+e+aG[bs]);bs=(bs+1)%aG.length}else{gws.audio.play("Line"+e+Math.floor(Math.random()*bQ[e-1]))}}}aW[bV].score+=(Math.pow(bS,2)-bS)/2;aW[bV].score+=bW.iPoints}if(an==1){if(!bR){bj+=bp+F[bh];if(gws.currentGame.randomSeed||gws.currentGame.randomseed){gws.storage.setObject("currentGame",{game:gws.currentGame.id,seed:gws.currentGame.randomSeed||gws.currentGame.randomseed,moves:bj,local:true})}}}bp="";F[bh]=0;if(aW[aY].aTileReserve.length>0){aW[aY].tiles[0].pairs=aW[aY].aTileReserve[0].slice();aW[aY].aTileReserve.splice(0,1);if((aW[aY].aTileReserve.length>0)&&(aW[aY].tiles.length==1)){aW[aY].addTile(new gws.classes.polygonTile(0,0,0,0,null)).pairs=aW[aY].aTileReserve[0].slice();aW[aY].aTileReserve.splice(0,1)}}else{if(bv<w.length){aW[aY].tiles[0].pairs=w[bv].slice();bv++}else{aW[aY].removeTile()}}H(bX)}}}function aD(){if(U){gws.tileController.swapTile();aW[aY].swapTiles();if(aW[aY].tiles.length>1){gws.audio.play("swap-tile")}if(bp=="s"){bp=""}else{bp="s"}bh=1-bh;document.getElementById("swap").setAttribute("title","")}}(function(bR){var bW=0,b8=0,ca=true,bV=false,bS=false,bT={placers:[],swappers:[],rights:[],lefts:[]},e=function(cb){},b7=function(cb){var cc=0;if(!cb){cb=window.event}cc=cb.wheelDelta||-cb.detail;cc=cc/Math.abs(cc);ab(cc);b8++;if(cb.preventDefault){cb.preventDefault()}cb.returnValue=false},bY=function(cc){var cb=cc||window.event;switch(cb.keyCode){case 90:case 46:aD();break;case 13:case 32:aM();return false;case 37:ab(-1);bW++;return false;case 38:ab(-1);bW++;return false;case 39:ab(+1);bW++;return false;case 40:ab(+1);bW++;return false}},b6=function(cb){aD();return false},b9=function(cb){if(cb.button!==2){bS=true;bV=false}else{bS=false;bV=true}cb.preventDefault();return false},b3=function(cb){if(bS){aM()}if(bV){aD()}bS=false;bV=false;return false},bQ=function(cb){return function(cc){cb(cc);cc.preventDefault();cc.stopPropagation()}},bU=function(cb){ab(-1);return false},b0=function(cb){ab(1);return false},b1=bQ(b9),bZ=bQ(b3),b5=bQ(b6),bX=bQ(bU),b4=bQ(b0),b2=function(cb){cb.preventDefault();return false};bR.enableInput=function(cd,cb){var cc=0;ca=!(bR.browser.android||bR.browser.phonegap),document.onkeydown=bY;window.addEventListener("mousewheel",b7,false);window.addEventListener("DOMMouseScroll",b7,false);if(cd){for(cc in bT){if(cd[cc]){bT[cc]=bT[cc].concat(cd[cc])}}}for(cc=0;cc<bT.placers.length;cc++){if(ca){bT.placers[cc].addEventListener("mousedown",b9,false);bT.placers[cc].addEventListener("mouseup",b3,false)}bT.placers[cc].addEventListener("touchstart",b1,false);bT.placers[cc].addEventListener("touchend",bZ,false);bT.placers[cc].addEventListener("contextmenu",b2,false)}for(cc=0;cc<bT.swappers.length;cc++){if(ca){bT.swappers[cc].addEventListener("mousedown",b6,false)}bT.swappers[cc].addEventListener("touchstart",b5,false);bT.swappers[cc].addEventListener("contextmenu",b2,false)}for(cc=0;cc<bT.lefts.length;cc++){if(ca){bT.lefts[cc].addEventListener("mousedown",bU,false)}bT.lefts[cc].addEventListener("touchstart",bX,false);bT.lefts[cc].addEventListener("contextmenu",b2,false)}for(cc=0;cc<bT.rights.length;cc++){if(ca){bT.rights[cc].addEventListener("mousedown",b0,false)}bT.rights[cc].addEventListener("touchstart",b4,false);bT.rights[cc].addEventListener("contextmenu",b2,false)}};bR.disableInput=function(){var cb=0;document.onkeydown=e;document.onmousewheel=e;window.removeEventListener("DOMMouseScroll",b7);for(cb=0;cb<bT.placers.length;cb++){if(ca){bT.placers[cb].removeEventListener("mousedown",b9);bT.placers[cb].removeEventListener("mouseup",b3)}bT.placers[cb].removeEventListener("touchstart",b1);bT.placers[cb].removeEventListener("touchend",bZ);bT.placers[cb].removeEventListener("contextmenu",b2)}for(cb=0;cb<bT.swappers.length;cb++){if(ca){bT.swappers[cb].removeEventListener("mousedown",b6)}bT.swappers[cb].removeEventListener("touchstart",b5);bT.swappers[cb].removeEventListener("contextmenu",b2)}for(cb=0;cb<bT.lefts.length;cb++){if(ca){bT.lefts[cb].removeEventListener("mousedown",bU)}bT.lefts[cb].removeEventListener("touchstart",bX);bT.lefts[cb].removeEventListener("contextmenu",b2)}for(cb=0;cb<bT.rights.length;cb++){if(ca){bT.rights[cb].removeEventListener("mousedown",b0)}bT.rights[cb].removeEventListener("touchstart",b4);bT.rights[cb].removeEventListener("contextmenu",b2)}}})(gws);function G(e){return[+gws.storage.get("Entanglement"+e+"-segments"),+gws.storage.get("Entanglement"+e+"-score")]}function bE(e,bQ,bS){var bR=G(e);gws.storage.set("Entanglement"+e+"-segments",Math.max(+bQ,+bR[0]));gws.storage.set("Entanglement"+e+"-score",Math.max(+bS,+bR[1]))}function bK(bQ,bV){var bT=gws.storage.get("Entanglement"+bQ);var bS=0;if(bT){var bR=JSON.parse(bT);if(bV){var e,bU=[];for(e in bR){bS=(+bR[e][0]==+C)?1:0;bU.splice(0,0,[bR[e][1],bR[e][1+bV],bS,bR[e][4]])}return bU}else{return bR}}else{return false}}function P(bX,bQ,e,bR,bT,bW,bV){var bU=bK(bX);if(bU){bU.splice(0,0,[bQ,e,bR,bT,bW,bV])}else{bU=[[bQ,e,bR,bT,bW,bV]]}bU.sort(function(bZ,bY){return(bY[2]>bZ[2])});var bS=bU.slice(0,6);gws.storage.set("Entanglement"+bX,JSON.stringify(bS));bE(bX,bT,bR)}var l=+100;var j=+173;var az=l*3;var ay=j*2;var an=0;var aY=0;var aW=[];var w=[];var r="1";var bi="";var au="";var U=false;var S=false;gws.getInstructions=function(e,bQ){switch(+e){case 21:case 28:case 36:case 35:case 29:return"<div class='instructions'>Sakura Grove istražuje vrtove Kolopleta i postavlja nove izazove ubacujući par novih smicalica u izvornu igru.<br /><br />Imate ograničeni broj pločica. Središnja pločica pokazuje koliko pločica još imate.<br /><br />Možete dobiti više pločica ako svoj put provučete kroz pločice trešnjinog drva. U načinu jednog igrača, dodatnu pločicu dobivate svaki put kad prođete kroz pločicu trešnjinog drva. U načinu više igrača, dodatnu pločicu dobivate svaki drugi put kad igrač prođe kroz pločicu trešnjinog drva.<br /><br />Provlačenje puta kroz središnju pločicu donosi bonus bodove. Što češće to napravite, dobivate više bonus bodova.</div>";break;case 27:return"<div class='instructions'>Svaki dan, dnevni izazov svim igračima predstavlja identičnu slagalicu (jednaka ploča, jednaka pravila i jednake pločice). Kad se ukloni sva nasumičnost, vaš se rezultat temelji isključivo na vašem umijeću.<br /><br />Aktualni rekorder prikazan je u kutu zaslona, zajedno sa satom koji pokazuje koliko je preostalo do kraja dana i nove slagalice.</div>";break;default:if(an<2){if(bQ){return"<div class='instructions'>Postići najviše bodova moguće stvaranjem dugu liniju. Zaradite bodova za svaku pločicu prođete kroz. Proći kroz više od jedne u jednom potezu kako bi zaradili još više bodova! </ P> <p> Koristite tipke sa strelicama za rotirati pločice. Dodirnite igraću ploču staviti svoj pločica i gledati vaša linija raste. </ P> <p> Izbjegavajte zidova ili igra će završiti.</div>"}else{if(navigator.onLine){return gws.YOUTUBE_INSTRUCTIONS}else{return"<div class='instructions'>Strelicama ili kotačićem miša okrećite šesterokutnu pločicu.<br /><br />Kad namjestite pločicu, pritisnite razmaknicu ili kliknite mišem da biste je položili.<br /><br />Vijugajte po ploči i pokušajte napraviti najdulji put, a da pritom ne udarite u zid.<br /><br />Pravljenjem petlji kroz više pločica dobivate još više bodova!</div>"}}}else{if(bQ){return"<div class='instructions'>Postići najviše bodova moguće stvaranjem dugu liniju. Zaradite bodova za svaku pločicu prođete kroz. Proći kroz više od jedne u jednom potezu kako bi zaradili još više bodova! </ P> <p> Koristite tipke sa strelicama za rotirati pločice. Dodirnite igre odbora da bi se Vaš pločica i gledati svoje linije raste. </ P> <p> Izbjegavajte zidova i linije drugih igrača, ili vaša igra će završiti. Nakon što su svi igrači stavili onoliko pločice kao što su oni u mogućnosti, igrač s najviše bodova pobjeđuje!</div>"}else{return"<div class='instructions'>Povucite najdulju moguću liniju. Što linija ima više segmenata, to postižete više bodova.</p><p>Pločicu okrećite strelicama ili kotačićem miša. Kliknite mišem ili pritisnite razmaknicu da položite pločicu i gledajte kako linija raste.</p><p>Izbjegavajte zidove i linije drugih igrača, inače igra završava. Kad svi igrači polože najveći mogući broj pločica, igrač s najviše bodova pobjeđuje!</div>"}}break}};var k=0;var aT=0;var bb=1;var bD=0;var a1=0;var aZ=[-1,-1];var aP=false;var bP="";var aA=0;gws.drawStartTile=false;gws.stepper={pulse:0,render:function(bQ){if(U){if(gws.drawStartTile){if(gws.currentGame.limitedTiles){q(aW[aY].startTile,aW[aY].aTileReserve.length+aW[aY].tiles.length,"Ostalo pločica",aW[aY].color,this.pulse)}else{q(aW[aY].startTile,aW[aY].segments,"Segmenti",aW[aY].color,this.pulse)}gws.drawStartTile=false}var bR;for(bR in bn.animatingTiles){if(bn.animatingTiles[bR].animate){bn.animatingTiles[bR].render()}}}var e;for(e in bn.incrementalScores){if(bn.incrementalScores[e].killMe){document.getElementById("moving-scores").removeChild(bn.incrementalScores[e].element);bn.incrementalScores.splice(e,1)}else{bn.incrementalScores[e].update(bQ)}}if(aP){if(an<2){if(bL==aW[0].score){aP=false;gws.storage.remove("currentGame");if(gws.currentGame.unplayable){f()}else{if(gws.account.loggedIn||!gws.client.online){a7()}else{if(aW[0].score>12){var bS=document.createElement("div");bS.innerHTML='<br /><br /><b style="font-size: 13em; text-shadow: 0 0 0.4em #ffffff;">'+aW[0].score+'</b><br /><br /><span class="submit-score-text">'+bP+"</span>";bS.appendChild(gws.SUBMIT_SCORE);gws.showDialog(bS)}else{f()}gws.addToHomeScreen()}}}}else{aP=false;gws.scoreboard.show("results")}}},update:function(bQ){var bR=bQ-aA,e=1;aA=bQ;this.pulse=0.13+0.03*Math.cos(aT/33);if((bb>1)&&(!(aT%5))){bb--}if(U){if(k>0){k--;this.pulse-=0.03*Math.cos(k/2)}if(a4){if(o<6){o++}}else{if(o>0){o-=2}}}aT++;if(aT>=400000){aT=0}}};var g=(function(){var bR=false,e=false,bQ=null;return function(bT,bS){bR=bT||bR;e=(!!bS)||e;bQ=bS||bQ;if(bR&&e){bQ()}}})();window.addEventListener("load",function(){var bQ=gws.vars.view;gws.view={addEvent:function(){},resize:function(){},};if(window.document&&document.domain&&document.domain.indexOf("gopherwoodstudios.com")>=0){document.domain="gopherwoodstudios.com"}try{if(window.top&&(window.top!==window)&&top.gws&&top.gws.payments&&top.gws.payments.paypal&&top.gws.payments.paypal.success){top.gws.payments.paypal.success()}}catch(bS){}gws.browser=gws.browserCheck();gws.body=document.getElementsByTagName("body")[0];gws.bodyClip=document.getElementById("body-clip");if(gws.browser.mobile){gws.body.className="mobile";gws.windows.mobile=true}if(gws.browser.canvas){gws.storage.initialize(function(){var bW=a2("n");r=+bW;if(!r){r=+gws.storage.get("lastGamePlayed")}if(!r){r=2;gws.tutorial.index=1}var bY=gws.vars.map;bn=new gws.classes.entMap(document.getElementById("game"),0,0,bY.width,bY.height,bY.scale);var bT=function(){if((gws.browser.safari)&&(gws.browser.iPod||gws.browser.iPhone)){var bZ=window.orientation?"268px":"416px";if(gws.bodyClip.style.height!=bZ){gws.bodyClip.style.height=bZ}}gws.body.style.fontSize=Math.max(bQ.unit.bodyMinimum,bQ.unit.bodyMaximum*Math.min(1,Math.min(gws.bodyClip.offsetWidth/bQ.unit.bodyWidth,gws.bodyClip.offsetHeight/bQ.unit.bodyHeight)))+"px";bn.rescale();bn.rescale();gws.view.resize();gws.background.reposition();if(gws.browser.mobile){window.scrollTo(0,1)}if(aW.length>0){if(aW[aY].tiles.length>1){bx()}else{aR()}}};window.addEventListener("resize",bT,false);window.addEventListener("orientationchange",bT,false);bT();window.addEventListener("focus",function(){S=true;setTimeout(function(){S=false},400)},false);if(gws.browser.progress){gws.progressBar=new gws.classes.progressBar(document.getElementById("loading-panel"))}else{gws.progressBar=false}var e=[],bX=[],bV="",bU;for(bU in gws.settings.assets){bV=gws.settings.assets[bU].src;if(bV.indexOf("m4a")>0){e.push(bV);e.push(bV.replace(".m4a",".ogg"));e.push(bV.replace(".m4a",".mp3"))}else{bX.push(bV)}}gws.assets.saveScaledImages=false;gws.assets.load(bX,function(b0,bZ){if(gws.progressBar){gws.progressBar.update(b0);gws.progressBar.render()}},function(){document.getElementById("loading-panel").style.display="none";gws.assets.createSpriteSheet("main-menu-buttons","i/main-menu-buttons.png",1,4);gws.assets.createSpriteSheet("side-menu-buttons","i/side-menu-buttons.png",1,2);gws.assets.createSpriteSheet("menu-icons","i/menu-icons-2.png",8,4);gws.assets.createSpriteSheet("side-icons","i/side-icons.png",5,1);gws.assets.createSpriteSheet("back-button","i/back-button.png",2,1);gws.assets.createSpriteSheet("bar-button","i/bar-buttons1.png",5,2);gws.assets.createSpriteSheet("exit","i/exit.png",2,1);gws.assets.setImageName(gws.assets.copyImage("i/button-tiny.png"),"button-tiny-ss");gws.assets.createSpriteSheet("button-tiny","button-tiny-ss",2,1);gws.assets.createSpriteSheet("pap-icons","i/post-game-buttons.png",2,2);gws.controlBar=new gws.buttonsBar(gws.bodyClip,gws.browser.mobile);var b1=gws.controlBar;gws.client=new gws.classes.client(gws.vars.engine.server.address);gws.account=new gws.classes.account({onLogOn:function(){b1.showLoggedOn();gws.buyPage.refresh();gws.mainMenu.refresh()},onLogOff:function(){b1.showLoggedOff();gws.buyPage.refresh();L("<div style='font-size:1.8em'>"+s+" Odjavljeni ste.</div>",3000)},client:gws.client});gws.mainMenu=new gws.classes.menu(document.getElementById("main-menu"),gws.browser.mobile,gws.vars.view.mainMenu);if(gws.browser.mobile){var b4=gws.createElement(gws.bodyClip,"div",false,"side-menu");gws.sideMenu=new gws.classes.menu(b4,gws.browser.mobile,gws.vars.view.sideMenu)}else{var b4=gws.createElement(gws.bodyClip,"div",false,"side-menu");gws.createElement(b4,"a","side-menu-tab","fake-tab");var b2=gws.createElement(b4,"a","side-menu-tab","main-tab");gws.createTextBlock(gws.createElement(b2,"div","vertical-text"),"span","",false,"Izbornik");var bZ=gws.createElement(b4,"a","side-menu-tab","more-tab");gws.createTextBlock(gws.createElement(bZ,"div","vertical-text"),"span","",false,"Nabavite više ");var b0=gws.createElement(b4,"div","return");gws.createElement(b0,"a");var b3=gws.createElement(b4,"div",false,"inner-side-menu");gws.sideMenu=new gws.classes.menu(b3,gws.browser.mobile,gws.vars.view.sideMenu);b0.onclick=function(){gws.sideMenu.hide()};b2.onclick=function(){gws.sideMenu.show("main")};bZ.onclick=function(){gws.sideMenu.show("more")}}gws.playAgain=new gws.classes.playAgainPanel(gws.bodyClip);gws.buyPage=new gws.classes.buyPage(gws.bodyClip,gws.browser.mobile);ad(a2("key"));gws.audio={play:function(){}};gws.view=new gws.classes.view(gws.bodyClip,gws.assets,gws.audio,gws.browser.mobile);gws.loop.addRender(gws.view);gws.loop.addRender(gws.stepper);gws.loop.start();var b5=a2("item");switch(b5){case"1":case"4":case"8":case"13":case"15":ac();gws.buyPage.show(+b5);break;default:bF(r,1)}setTimeout(function(){g(!gws.browser.phonegap,function(){e=gws.assets.referenceAudio(gws.assets.filterAudio(e,gws.browser),gws.browser);gws.assets.load(e,function(b7,b6){if((b6.indexOf("ogg")>0)||(b6.indexOf("mp3")>0)||(b6.indexOf("m4a")>0)){this.setSoundName(this.getSound(b6),b6.replace("a/","").replace(".mp3","").replace(".m4a","").replace(".ogg",""))}},function(){var cc=0,cb,b7=gws.vars.view.sounds,ca=(gws.browser.android||gws.browser.iOS)?0.75:0;gws.audio=new gws.classes.audioManager({assets:gws.assets,musicTracks:[["Layer1_1","Layer1_2","Layer1_3","Layer1_4","Layer1_5","Layer1_6"],["Layer2_1","Layer2_2","Layer2_3","Layer2_4","Layer2_5"]],musicOffset:16000,offsetTracks:true,onPlayMusic:function(){gws.controlBar.musicPlay();gws.storage.set("mute-music","false")},onMuteMusic:function(){gws.controlBar.musicMute();gws.storage.set("mute-music","true")},onPlaySFX:function(){gws.controlBar.sfxPlay();gws.storage.set("mute-sfx","false")},onMuteSFX:function(){gws.controlBar.sfxMute();gws.storage.set("mute-sfx","true")},musicMuted:(gws.storage.get("mute-music")=="true"),sfxMuted:(gws.storage.get("mute-sfx")=="true")});for(cc in b7){cb=b7[cc];gws.audio.addSoundSegment(cb.source,cb.title,cb.start,(cb.length?cb.length+ca:0),(cb.end?cb.end+ca:0))}if(!gws.audio.sfxMuted){gws.controlBar.sfxPlay()}if(!gws.audio.musicMuted){gws.controlBar.musicPlay()}gws.loop.addUpdate(gws.audio);gws.view.audio=gws.audio;if(gws.browser.iOS){gws.enableAudio({element:gws.view.animationLayer.canvas,audio:gws.audio.sounds.sfx.sound,})}var b9=["i/mid_1.png","i/rock.png","i/mid_0.png","i/mid_2.png","i/gameboard_glow.png","i/corner_shadow.png","i/top_0.png","i/top_1.png","i/top_2.png","i/left-trim.png","i/right_trim.png"],b8=["bgTL1","bgL","bgTL2","bgTR1","bgGlow","","bgT","bgBL","bgTR2","bgTL3","bgTR3"],b6=false;if(gws.browser.mobile){b9=["i/mid_0.png","i/gameboard_glow.png","i/corner_shadow.png","i/top_0.png","i/top_1.png","i/top_2.png","i/left-trim.png","i/right_trim.png"];b8=["bgTL2","bgGlow","","bgT","bgBL","bgTR2","bgTL3","bgTR3"]}setTimeout(function(){gws.assets.load(b9,function(cf,ce){var cd,cg=0;for(;cg<b9.length;cg++){if(b9[cg]==ce){if(ce=="i/corner_shadow.png"){cd=this.copyImage("",this.images[ce]);cd.setAttribute("id","bgSBR");cd.className="background-image";gws.bodyClip.appendChild(cd);gws.background.images.bgSBR=cd;cd=this.copyImage("",this.images[ce]);cd.setAttribute("id","bgSBL");cd.className="background-image";gws.bodyClip.appendChild(cd);gws.background.images.bgSBL=cd;cd=this.copyImage("",this.images[ce]);cd.setAttribute("id","bgSTR");cd.className="background-image";gws.bodyClip.appendChild(cd);gws.background.images.bgSTR=cd;cd=this.copyImage("",this.images[ce]);cd.setAttribute("id","bgSTL");cd.className="background-image";gws.bodyClip.appendChild(cd);gws.background.images.bgSTL=cd}else{cd=this.images[ce];cd.setAttribute("id",b8[cg]);cd.className="background-image";gws.bodyClip.appendChild(cd);gws.background.images[b8[cg]]=cd}b8.splice(cg,1);clearTimeout(b6);b6=setTimeout(function(){gws.background.reposition()},200);break}}})},10)})})},10)})})}else{var bR="";bR+='<li><a href="http://www.apple.com/safari/" title="Apple Safari" class="safari"><span>Apple Safari</span></a></li>';bR+='<li><a href="http://www.google.com/chrome/" title="Google Chrome" class="chrome"><span>Google Chrome</span></a></li>';bR+='<li><a href="http://www.mozilla.com/firefox/" title="Mozilla Firefox" class="firefox"><span>Mozilla Firefox</span></a></li>';bR+='<li><a href="http://www.opera.com/" title="Opera" class="opera"><span>Opera</span></a></li>';bR+='<li><a href="http://windows.microsoft.com/en-us/internet-explorer/products/ie/home" title="Microsoft Internet Explorer" class="ie-icon"><span>Microsoft Internet Explorer</span></a></li>';gws.showDialog('<h2>Još jedan korak</h2><p><b>Koloplet</b>  upotrebljava najsuvremeniju tehnologiju preglednika, HTML5, koju vaš preglednik izgleda ne podržava. Ali još uvijek možete igrati! Najnovije verzije svih ovih preglednika podržavaju HTML5:</p><ul id="browsers">'+bR+"</ul>")}});function H(e){var bQ=0;aY=(aY+1)%an;gws.windows.showScores();var bR=false;if(aW[aY].tiles.length<1){bR=true}else{ae=aW[aY].startTile.appendTo(aW[aY].startPath);if(!ae||(ae.sTileType=="start-empty")||(ae.sTileType=="start-wall")||(ae.sTileType=="start-bonus")||(ae.pairs=="wall")){bR=true}}if(bR){aX+=1;if(aX>=an){aE=true;U=false;gws.tileController.destroy();gws.tileController=null;bn.render();bl("game-over");gws.audio.play("end-game");if(an<2){aW[0].highScore=aV;aW[0].highSegments=a;bP="";if(aW[0].score>aW[0].highScore){aW[0].highScore=aW[0].score;if(aV){bP="Osobni rekord! "}}if(aW[0].segments>aW[0].highSegments){aW[0].highSegments=aW[0].segments;if((bP=="")&&(aV)){bP=" I "+aW[0].highSegments+" : Vaša najdulja linija do sada! "}}if(!gws.currentGame.limitedTiles){q(aW[aY].startTile,aW[aY].segments,"Segmenti",aW[aY].color)}aP=true}else{aP=true}aR();ae=false}else{H()}}else{aX=0;bn.rescale(ae.x,ae.y);gws.background.reposition();ae.setType("turnstile");ae.render();k=40;if(gws.currentGame.limitedTiles){bQ=aW[aY].aTileReserve.length+aW[aY].tiles.length;if((bQ==1)&&!e){bn.incrementalScores.splice(0,0,new a8(ae.windowX(),ae.windowY(),"Posljednja pločica!",aW[aY]))}}if(an<2){aW[0].highScore=aV;aW[0].highSegments=a;if(aW[0].score>aW[0].highScore){aW[0].highScore=aW[0].score}if(aW[0].segments>aW[0].highSegments){aW[0].highSegments=aW[0].segments}}gws.drawStartTile=true;gws.tileController.updatePads(aY,aW[aY].tiles,ae.x,ae.y,((bQ<10)?bQ:0));if(aW[aY].tiles.length>1){bx()}else{aR()}}}var ag=new Date(),bs=0,bd=0,bg=false,aG=false;if((ag.getDate()==25)&&(ag.getMonth()==11)){aG="222222240123333322211214";bg="1012"}var aV;var a;var ae;var aE;var aX;var bn;var aC;gws.loadURL=function(e){gws.trackEvent("Exit","URL",e,0);window.open(e)};(function(bQ){var bW=["empty","wall","bonus"],bV=["#FE3F46","#38FFF8","#FFF869","#00FE5E","#FFA425","#D568FF"],e=["Red","Blue","Yellow","Green","Orange","Purple"],bU=function(b1,b3,b2){var bX=[],b5=0,b4=0,bY=null;if(b1&&(b1!=="-")){b4=b2*300;bX.push(b4);if(Math.abs(b2)%2){b5=(b3+0.5)*346;bX.push(b5)}else{b5=b3*346;bX.push(b5)}switch(b1[0]){case"w":bX.push(1);break;case"6":bX.push(2);bX.push([0,7,2,9,4,11,6,1,8,3,10,5]);bX.push(gws.generateTiles(6,6));break;case"3":bX.push(2);bX.push([0,7,2,9,4,11,6,1,8,3,10,5]);bX.push(gws.generateTiles(3,6));break;case"p":bX.push(2);bX.push([0,1,2,3,4,5,6,7,8,9,10,11]);bX.push([0,1,2,3,4,5,6,7,8,9,10,11]);break;case"?":b1=b1.replace("?","");default:bX.push(0);break}if(b1.length>1){bY=[];var b0=b1.length-1;for(var bZ=0;bZ<b0;bZ++){if(b1[bZ+1]!=="0"){bY.push([[b4,b5,+bZ],e[+b1[bZ+1]-1],bV[+b1[bZ+1]-1],+b1[bZ+1]])}}}return{players:bY,kind:bX}}else{return false}},bS=function(b6){var b0=b6.replace(/\|/g,"\n").split("\n"),b5=0,b4=0,b2=0,b1=b0.length,bY=[],bZ=[],bX=0,b3=0;for(bX=0;bX<b0.length;bX++){if(b0[bX][0]===" "){b0[bX].replace(" ","")}b0[bX]=b0[bX].split(" ");b2=Math.max(b2,b0[bX].length)}b2=Math.floor(b2/2);b1=Math.floor(b1/2);for(b4=0;b4<b0.length;b4++){for(b5=0;b5<b0[b4].length;b5++){b3=bU(b0[b4][b5],+b5-b2,+b4-b1);if(b3){bY.push(b3.kind);if(b3.players){bZ=bZ.concat(b3.players)}}}}bZ=bZ.sort(function(b8,b7){return b8[3]-b7[3]});for(bX=0;bX<bZ.length;bX++){bZ[bX].length=3}return{players:bZ,map:bY}},bT=function(bZ,bY,b2,b0,bX,b1){this.canvas=bZ;this.canvas.code=this;this.top=0;this.left=0;this.bottom=0;this.right=0;this.softTop=0;this.softLeft=0;this.softBottom=0;this.softRight=0;this.viewScale=(window.devicePixelRatio||1);this.tileSheet=0;this.animatingTiles=[];this.setWindow(b0,bX);this.setFocus(bY,b2,b1);this.mouseX=0;this.mouseY=0;this.canvas.onmousemove=function(b3){if(b3.offsetX){this.code.mouseX=b3.offsetX;this.code.mouseY=b3.offsetY}else{if(b3.layerX){this.code.mouseX=b3.layerX;this.code.mouseY=b3.layerY}else{this.code.mouseX=b3.clientX;this.code.mouseY=b3.clientY}}};this.context=this.canvas.getContext("2d");this.incrementalScores=[];this.map=[];this.isZ=false;this.playerLocations=null},bR=bT.prototype;bR.setWindow=function(bY,bX){if(bY&&bX){this.width=bY;this.height=bX}else{this.canvas.width=this.canvas.offsetWidth*this.viewScale;this.canvas.height=this.canvas.offsetHeight*this.viewScale;this.width=this.canvas.offsetWidth;this.height=this.canvas.offsetHeight}};bR.setFocus=function(bX,bZ,bY){this.scale=bY;this.x=bX+((this.width)/(2*bY));this.y=bZ+((this.height)/(2*bY))};bR.setSize=function(bX,bZ,bY){if(bX){if(bY){if(bX>this.right){this.right=bX}if(bX<this.left){this.left=bX}}if(bX>this.softRight){this.softRight=bX}if(bX<this.softLeft){this.softLeft=bX}}if(bZ){if(bY){if(bZ>this.bottom){this.bottom=bZ}if(bZ<this.top){this.top=bZ}}if(bZ>this.softBottom){this.softBottom=bZ}if(bZ<this.softTop){this.softTop=bZ}}};bR.rescale=function(bX,b0){this.setSize(bX,b0,true);var bY=this.right-this.left+2*az;var bZ=this.bottom-this.top+2*ay;if((bY/bZ)>(this.width/this.height)){this.setWindow();this.setFocus(-(this.right+this.left)/2,-(this.bottom+this.top)/2,this.width/bY);this.render()}else{this.setWindow();this.setFocus(-(this.right+this.left)/2,-(this.bottom+this.top)/2,this.height/bZ);this.render()}};bR.add=function(bX,bY){this.assignNeighbors(bX);switch(this.tileSheet){case 1:if(bX.pairs!="empty"){this.setSize(bX.x,bX.y,bY)}break;default:if(bX.pairs!="wall"){this.setSize(bX.x,bX.y,bY)}break}if(bX.eBonus){this.map.splice(this.map.length,0,bX);this.animatingTiles.splice(0,0,bX)}else{this.map.splice(0,0,bX)}this.isZ=false;return bX};bR.remove=function(bX){for(x in this.map){if(bX==this.map[x]){this.map.splice(x,1)}}};bR.world2windowX=function(bY,bX){return((this.x+bY)+bX)*this.scale};bR.world2windowY=function(bY,bX){return((this.y+bY)+bX)*this.scale};bR.window2worldX=function(bX){return(bX/this.scale)-this.x};bR.window2worldY=function(bX){return(bX/this.scale)-this.y};bR.update=function(){for(x in this.map){this.map[x].update()}if(!this.isZ){this.map.sort(function(bY,bX){return(bY.offsetZ)-(bX.offsetZ)});this.isZ=true}};bR.render=function(){this.context.clearRect(0,0,this.width,this.height);for(x in this.map){this.map[x].render()}};bR.drawHexagon=function(b5,b4,bZ,b0,b1){var b6=b1||this.context;var b3=(this.x+b5)*this.scale*this.viewScale;var b2=(this.y+b4)*this.scale*this.viewScale;var bX=j*bZ*this.viewScale;var bY=l*bZ*this.viewScale;bZ=this.scale*this.viewScale;b6.fillStyle=b0;b6.strokeStyle=b0;b6.lineWidth=bZ;b6.beginPath();b6.moveTo(b3-bY,b2-bX);b6.lineTo(b3+bY,b2-bX);b6.lineTo(b3+2*bY,b2);b6.lineTo(b3+bY,b2+bX);b6.lineTo(b3-bY,b2+bX);b6.lineTo(b3-2*bY,b2);b6.lineTo(b3-bY,b2-bX);b6.closePath();b6.fill()};bR.assignNeighbors=function(b1){var b2=b1.x+","+(b1.y-ay);var b0=(b1.x+az)+","+(b1.y-j);var bY=(b1.x+az)+","+(b1.y+j);var bX=b1.x+","+(b1.y+ay);var b5=(b1.x-az)+","+(b1.y+j);var b4=(b1.x-az)+","+(b1.y-j);var bZ=this.map;for(var b3 in bZ){switch(bZ[b3].description){case b2:b1.connect("A",bZ[b3]);break;case b0:b1.connect("B",bZ[b3]);break;case bY:b1.connect("C",bZ[b3]);break;case bX:b1.connect("D",bZ[b3]);break;case b5:b1.connect("E",bZ[b3]);break;case b4:b1.connect("F",bZ[b3]);break}}return b1};bR.getTile=function(bX,b1){var bY=false;var b0=this.map;var bZ=bX+","+b1;for(index in b0){if(b0[index].description==bZ){bY=b0[index]}}return bY};bR.load=function(b0,bX,b2,bY){this.playerLocations=null;if(typeof b0==="string"){b0=bS(b0);this.playerLocations=b0.players;b0=b0.map}this.top=0;this.left=0;this.bottom=0;this.right=0;this.softTop=0;this.softLeft=0;this.softBottom=0;this.softRight=0;this.tileSheet=b2;this.map=[];this.animatingTiles=[];var b3;var b1=false;var bZ;for(tile in b0){if(b0[tile].length>3){b3=b0[tile][3];if(b0[tile].length>4){if(typeof b0[tile][4]==="number"){b1=bX.splice(0,b0[tile][4])}else{b1=b0[tile][4]}}else{b1=false}}else{b3=bW[b0[tile][2]];b1=false}bZ=new gws.classes.polygonTile(b0[tile][0],b0[tile][1],"",b3,this,bW[b0[tile][2]],b1);this.add(bZ,!bY)}this.rescale(0,0)};bQ.entMap=bT})(gws.classes);gws.classes=gws.classes||{};gws.classes.mapNode=function(e){this.contains=e.contains||false;this.edges=[]};gws.classes.mapNode.prototype.update=function(){return false};gws.classes.mapNode.prototype.setState=function(e){};gws.classes.mapNode.prototype.getState=function(){return false};gws.classes.mapNode.prototype.setEdge=function(e,bQ){this.edges[e]=bQ};gws.classes.mapNode.prototype.getEdge=function(e){return this.edges[e]};gws.classes.mapEdge=function(){this.nodes=[false,false]};gws.classes.mapEdge.prototype.update=function(){return false};gws.classes.mapEdge.prototype.setState=function(e){};gws.classes.mapEdge.prototype.getState=function(){return false};gws.classes.mapEdge.prototype.setNode=function(e){if(!this.nodes[0]){this.nodes[0]=e}else{this.nodes[1]=e}};gws.classes.mapEdge.prototype.getNode=function(e){if(e==this.nodes[0]){return this.nodes[1]}else{return this.nodes[0]}};gws.classes.map=function(bX){var bQ=bX||{};this.mapType=bQ.mapType||"grid";this.nodeClass=bQ.nodeClass||gws.classes.mapNode;this.edgeClass=bQ.edgeClass||gws.classes.mapEdge;this.manager=bQ.manager||false;this.onStateChange=bQ.onStateChange||function(){};this.nodes=[];this.edges=[];this.grid=false;switch(this.mapType){case"grid":this.grid=bQ.structure||[[{},{}],[{},{}]];for(var bW in this.grid){for(var bV in this.grid[bW]){this.grid[bW][bV]=new this.nodeClass(this.grid[bW][bV]);this.grid[bW][bV].x=bW;this.grid[bW][bV].y=bV;this.addNode(this.grid[bW][bV])}}var e=+bW+1;var bZ=+bV+1;var bR,bY,bT,bS;for(var bW in this.grid){for(var bV in this.grid[bW]){bY=[+bV>0,+bW<e-1,+bV<bZ-1,+bW>0];bT=[+bW,+bW+1,+bW,+bW-1];bS=[+bV-1,+bV,+bV+1,+bV];for(var bU=0;bU<4;bU++){bR=false;if(bY[bU]){bR=this.grid[bT[bU]][bS[bU]].getEdge((+bU+2)%4)}if(!bR){bR=new this.edgeClass();this.addEdge(bR)}bR.setNode(this.grid[bW][bV]);this.grid[bW][bV].setEdge(+bU,bR)}}}break;case"line":this.line=bQ.structure||[{},{}];for(var bW in this.line){this.line[bW]=new this.nodeClass(this.line[bW]);this.addNode(this.line[bW]);bR=false;if((+bW-1)>=0){bR=new this.edgeClass();this.addEdge(bR);bR.setNode(this.line[bW-1]);bR.setNode(this.line[bW]);this.line[bW-1].setEdge(1,bR);this.line[bW].setEdge(0,bR)}}break}this.onStateChange()};gws.classes.map.prototype.addNode=function(e){this.nodes.push(e);return e};gws.classes.map.prototype.removeNode=function(e){for(var bQ in this.nodes){if(e==this.nodes[bQ]){this.nodes.splice(bQ,1)}}};gws.classes.map.prototype.addEdge=function(e){this.edges.splice(0,0,e);return e};gws.classes.map.prototype.removeEdge=function(e){for(var bQ in this.edges){if(e==this.edges[bQ]){this.edges.splice(bQ,1)}}};gws.classes.map.prototype.update=function(e){var bR=false;for(var bS in this.nodes){bR=this.nodes[bS].update()||bR}for(var bQ in this.edges){bR=this.edges[bQ].update()||bR}if(bR){this.onStateChange()}return bR};gws.classes.map.prototype.getState=function(){var e={nodes:[],edges:[]};for(var bR in this.nodes){e.nodes[bR]=this.nodes[bR].getState()}for(var bQ in this.edges){e.edges[bQ]=this.edges[bQ].getState()}return e};gws.classes.map.prototype.setState=function(e){var bR=false;if(e.nodes){for(var bS in e.nodes){if(this.nodes[bS]){bR=bR||this.nodes[bS].setState(e.nodes[bS])}}}if(e.edges){for(var bQ in e.edges){if(this.edges[bQ]){bR=bR||this.edges[bQ].setState(e.edges[bQ])}}}if(bR){this.onStateChange()}return bR};gws.classes.menu=function(bQ,e,bR){this.element=bQ;this.isMobile=e;this.pages=[];this.currentPage="";this.currentHoverIcon="default";this.showing=false;this.showFunction=undefined;this.hideFunction=undefined;if(this.isMobile){this.setup(bR.mobile,true)}else{this.setup(bR.pc)}this.showPage("main")};gws.classes.menu.prototype.setup=function(b1,bR){var b2=this,bS=b1.type,b7=b1.buttonType||bS,e=function(cc,cd){var ca=cd.buttons,cb=function(cg){if(!cg){cg="default"}cc.hoverIcons[b2.currentHoverIcon].style.opacity=0.01;b2.currentHoverIcon=cg;cc.hoverIcons[b2.currentHoverIcon].style.opacity=1},cf=new gws.classes.pageSwipe({parent:cc.element,pages:ca,onSwipe:function(ch,cg){if(!ch.access||(gws.account.expansions&ch.access)){ce.setText("default","Igrati");ce.setText("hover","Igrati")}else{ce.setText("default","Check it out");ce.setText("hover","Check it out")}cb(ch.icon)}}),ce=new gws.classes.button(cc.element,"play-game "+bS+"-menu-button","",[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile(b7+"-menu-buttons",0,b5),text:"Igrati",textStyle:b7+"-menu-button-text"},{id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile(b7+"-menu-buttons",0,bY),text:"Igrati",textStyle:b7+"-menu-button-text",onClickFunction:function(){var cg=cf.getValue();if(!cg.access||(gws.account.expansions&cg.access)){bF(cg.gameId,cg.players)}else{gws.buyPage.show(cg.access)}}}]);cf.setIndex(0)},b4=function(cj,cf){var ch=cf.buttons,cg=function(cl){if(!cl){cl="default"}cj.hoverIcons[b2.currentHoverIcon].style.opacity=0.01;b2.currentHoverIcon=cl;cj.hoverIcons[b2.currentHoverIcon].style.opacity=1},cd=new gws.classes.pageSwipe({parent:cj.element,pages:ch,onSwipe:function(cm,cl){if(!cm.access||(gws.account.expansions&cm.access)){ci.hideLayer("lock");ce.hideLayer("lock");cc.hideLayer("lock");cb.hideLayer("lock");ca.hideLayer("lock")}else{ci.showLayer("lock");ce.showLayer("lock");cc.showLayer("lock");cb.showLayer("lock");ca.showLayer("lock")}cg(cm.icon)}}),ck=function(cl){var cm=function(){var cn=cd.getValue();if(!cn.access||(gws.account.expansions&cn.access)){bF(cn.gameId,cl)}else{gws.buyPage.show(cn.access)}};return new gws.classes.button(cj.element,"mini-menu-button","",[{id:"border",generalStyle:"mini-button-border"},{id:"default",generalStyle:"mini-button-players mini-button-"+cl,onClickFunction:cm},{id:"border-hover",generalStyle:"mini-button-border-hover"},{id:"hover",generalStyle:"mini-button-players-hover mini-button-"+cl+"-hover",onClickFunction:cm},{id:"lock",generalStyle:"mini-button-lock",onClickFunction:cm}])},ci=ck(2),ce=ck(3),cc=ck(4),cb=ck(5),ca=ck(6);cd.setIndex(0)};this.showFunction=b1.show;this.hideFunction=b1.hide;for(var bZ=0;bZ<b1.pages.length;bZ++){var b9=b1.pages[bZ];this.pages[b9.id]=[];var b6=this.pages[b9.id];b6.element=document.createElement("div");b6.element.className=bS+"-menu-page";b6.titleBar=gws.createElement(b6.element,"div",false,bS+"-menu-title-box");b6.hoverIconContainer=gws.createElement(b6.titleBar,"div",false,b9.hoverIconContainerClass);b6.hoverIcons=[];for(var bW=0;bW<b9.hoverIcons.length;bW++){var bQ=gws.assets.copyTile(b9.hoverIconImage,b9.hoverIcons[bW].imageX,b9.hoverIcons[bW].imageY);bQ.className="hover-icon";b6.hoverIconContainer.appendChild(bQ);b6.hoverIcons[b9.hoverIcons[bW].id]=bQ}if(b9.titleImage){gws.createImage(b6.titleBar,"img",false,b9.titleImage.styleId,b9.titleImage.image)}if(b9.title){gws.createTextBlock(b6.titleBar,"div",bS+"-menu-title",false,b9.title)}if(b9.line){gws.createImage(b6.titleBar,"img",bS+"-menu-title-line",false,b9.line)}if(b9.back){var bU=this.createBackFunction(b9.back);var b0=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("back-button",0,0),onClickFunction:bU},{id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile("back-button",1,0),onClickFunction:bU}];new gws.classes.button(b6.element,bS+"-menu-back-button",false,b0)}if(b1.pages[bZ].style==="page-swipe"){e(b6,b1.pages[bZ])}else{if(b1.pages[bZ].style==="page-swipe-multiplayer"){b4(b6,b1.pages[bZ])}else{for(var bX=0;bX<b1.pages[bZ].buttons.length;bX++){var b8=b9.buttons[bX];var b5=b8.special?2:0;var bY=b8.special?3:1;var b3=b8.hoverIcon||"default";var bT=[];bT[0]={id:"default",generalStyle:"button-default",image:gws.assets.copyTile(b7+"-menu-buttons",0,b5),text:b8.text,textStyle:b7+"-menu-button-text",onClickFunction:b8.onClickFunction};if(!bR){var bV=this.createMouseOverFunction(b3);bT[1]={id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile(b7+"-menu-buttons",0,bY),text:b8.text,textStyle:b7+"-menu-button-text",onClickFunction:b8.onClickFunction,onMouseOverFunction:bV,onMouseOutFunction:function(){b2.showHoverIcon("default")}}}new gws.classes.button(b6.element,bS+"-menu-button",b8.id,bT)}}}}};gws.classes.menu.prototype.createMouseOverFunction=function(bQ){var e=this;var bR=bQ;return function(){e.showHoverIcon(bR)}};gws.classes.menu.prototype.createBackFunction=function(bQ){var e=this;var bR=bQ;return function(){e.showPage(bR)}};gws.classes.menu.prototype.showHoverIcon=function(e){if(!e){e="default"}this.pages[this.currentPage].hoverIcons[this.currentHoverIcon].style.opacity=0.01;this.currentHoverIcon=e;this.pages[this.currentPage].hoverIcons[this.currentHoverIcon].style.opacity=1};gws.classes.menu.prototype.refresh=function(){if(this.showing){this.showPage("main")}};gws.classes.menu.prototype.show=function(e){if(!this.showing){this.showing=true;this.showFunction()}if(!e||!this.pages[e]){e="main"}this.showPage(e)};gws.classes.menu.prototype.showPage=function(bR){var bQ=undefined;gws.trackPage("/entanglement-"+bR);if(!bR||!this.pages[bR]){bR="main"}this.currentPage=bR;bQ=this.element.firstChild;if(bQ){this.element.removeChild(bQ)}this.element.appendChild(this.pages[bR].element);this.currentHoverIcon="default";for(var e in this.pages[this.currentPage].hoverIcons){this.pages[this.currentPage].hoverIcons[e].style.opacity=0.01}this.showHoverIcon()};gws.classes.menu.prototype.hide=function(bQ){var e=this;if(this.showing){this.showing=false;this.hideFunction(bQ)}};gws.classes.menu.prototype.tryToPlay=function(bQ,e){if(gws.account.loggedIn){if(gws.account.expansions&bQ){bF(e)}else{gws.buyPage.show(bQ)}}else{gws.buyPage.show(bQ)}};(function(){var e=function(bS){var bW=[0,1,2,3,4,5,6,7,8,9,10,11];var bV,bT,bU;for(bV=1;bV<bW.length;bV++){bT=Math.floor(Math.randomSeed()*(1+bV));if(bT!==bV){bU=bW[bV];bW[bV]=bW[bT];bW[bT]=bU}}bW.length=(bS||6)*2;return bW},bR=function(bU,bT){var bV=[];var bS=0;for(bS=0;bS<bU;bS++){bV.push(e(bT))}return bV},bQ=function(bT){this.options=bT;this.id=bT.id;this.title=bT.title;this.instructions=bT.instructions||"";this.spareTiles=bT.spareTiles||0;this.limitedTiles=bT.limitedTiles||0;this.players=bT.players;this.map=bT.map;this.randomSeed=bT.randomSeed||bT.randomseed||Date.now();this.timeleft=bT.timeleft;this.highscorename=bT.highscorename;this.highscorevalue=bT.highscorevalue;Math.randomSeed(this.randomSeed);if(bT.limitedTiles){this.tiles=bR((bT.limitedTiles+this.spareTiles+1)*this.players,bT.tileLines||6)}else{this.tiles=bR(this.map.length,bT.tileLines||6)}var bU;for(var bS in this.map){bU=this.map[bS];if(bU[4]){if(typeof bU[4]==="number"){bU[4]=bR(bU[4],bT.tileLines||6)}}}};gws.generateTiles=bR;gws.createLocalGame=function(bU,bT,bS){var bV=gws.vars.engine.maps[bU];if(bV){return gws.loadGame(bV,bT,bS)}else{return false}};gws.loadGame=function(bS,bU,bT){return new bQ({id:r,title:bS.title,spareTiles:bS.spareTiles,limitedTiles:bS.limitedTiles,tileLines:bS.tileLines,map:bS.map,players:bU,tiles:bS.tiles,timeleft:bS.timeleft,highscorename:bS.highscorename,highscorevalue:bS.highscorevalue,randomSeed:bS.randomSeed||bS.randomseed||bT})}})();gws.applicationCache=window.applicationCache;gws.applicationCacheUpdateReady=function(){try{gws.applicationCache.swapCache()}catch(bQ){}L('<a href="/" style="font-size: 1.8em">Dostupno je ažuriranje: reload za najnoviju verziju.</a>',10000)};try{gws.applicationCache.addEventListener("updateready",gws.applicationCacheUpdateReady,false);gws.applicationCache.update()}catch(a5){}window.popupManager={};popupManager.constants={darkCover:"popupManager_darkCover_div",darkCoverStyle:["position:absolute;","top:0px;","left:0px;","padding-right:0px;","padding-bottom:0px;","background-color:#000000;","opacity:0.5;","-moz-opacity:0.5;","filter:alpha(opacity=0.5);","z-index:10000;","width:100%;","height:100%;"].join(""),openidSpec:{identifier_select:"http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select",namespace2:"http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0"}};popupManager.getWindowInnerSize=function(){var bQ=0;var e=0;var bR=null;if("innerWidth" in window){bQ=window.innerWidth;e=window.innerHeight}else{if(("BackCompat"===window.document.compatMode)&&("body" in window.document)){bR=window.document.body}else{if("documentElement" in window.document){bR=window.document.documentElement}}if(bR!==null){bQ=bR.offsetWidth;e=bR.offsetHeight}}return[bQ,e]};popupManager.getParentCoords=function(){var bQ=0;var e=0;if("screenLeft" in window){bQ=window.screenLeft;e=window.screenTop}else{if("screenX" in window){bQ=window.screenX;e=window.screenY}}return[bQ,e]};popupManager.getCenteredCoords=function(bQ,e){var bU=this.getWindowInnerSize();var bT=this.getParentCoords();var bS=bT[0]+Math.max(0,Math.floor((bU[0]-bQ)/2));var bR=bT[1]+Math.max(0,Math.floor((bU[1]-e)/2));return[bS,bR]};popupManager.darkenScreen=function(){var e=window.document.getElementById(window.popupManager.constants.darkCover);if(!e){e=window.document.createElement("div");e.id=window.popupManager.constants.darkCover;e.setAttribute("style",window.popupManager.constants.darkCoverStyle);window.document.body.appendChild(e)}e.style.visibility="visible"};popupManager.createPopupOpener=(function(e){var bX=null;var b6=null;var bV=this;var b4=("shouldEncodeUrls" in e)?e.shouldEncodeUrls:true;var bS=function(b8){return(b4?encodeURIComponent(b8):b8)};var b1=("identifier" in e)?bS(e.identifier):this.constants.openidSpec.identifier_select;var b7=("identity" in e)?bS(e.identity):this.constants.openidSpec.identifier_select;var bU=("namespace" in e)?bS(e.namespace):this.constants.openidSpec.namespace2;var bT=(("onOpenHandler" in e)&&("function"===typeof(e.onOpenHandler)))?e.onOpenHandler:this.darkenScreen;var bR=(("onCloseHandler" in e)&&("function"===typeof(e.onCloseHandler)))?e.onCloseHandler:null;var bZ=("returnToUrl" in e)?e.returnToUrl:null;var bY=("realm" in e)?e.realm:null;var b2=("opEndpoint" in e)?e.opEndpoint:null;var bQ=("extensions" in e)?e.extensions:null;var bW=function(b9){var b8="";for(key in b9){b8+=["&",key,"=",bS(b9[key])].join("")}return b8};var b5=function(){urlToOpen=b2;return urlToOpen};var b0=function(){return(!b6||b6.closed)};var b3=function(){if(b0()){b6=null;var b8=window.document.getElementById(window.popupManager.constants.darkCover);if(b8){b8.style.visibility="hidden"}if(bR!==null){bR()}if((null!==bX)){window.clearInterval(bX);bX=null}}};return{popup:function(b9,b8){var ca=b5();if(bT!==null){bT()}var cb=bV.getCenteredCoords(b9,b8);b6=window.open(ca,"","width="+b9+",height="+b8+",status=1,location=1,resizable=yes,left="+cb[0]+",top="+cb[1]);bX=window.setInterval(b3,80);return true}}});gws.classes.pageSwipe=(function(){var bQ=function(bS){this.element=document.createElement("div");bS.parent.appendChild(this.element);if(bS.image){if(typeof bS.image==="string"){this.element.style.background="url('"+bS.image+"') no-repeat";this.element.style.backgroundSize="100%"}else{this.image=bS.image;this.image.style.width=this.element.style.width;this.element.appendChild(this.image)}}if(bS.className){this.element.className=bS.className}if(bS.text){this.textDiv=document.createElement("div");this.textDiv.innerHTML=bS.text;this.element.appendChild(this.textDiv)}if(bS.onSwipe){this.onSwipe=bS.onSwipe(this.value)}this.value=bS.value},bR=function(bV){var bU=this,bX=0,bT=bV.pages,bS=[],bW=bV.element,bZ=bV.parent,bY=bV.className||"page-swipe";if(bV.onSwipe){this.onSwipe=bV.onSwipe}if(bW){this.element=document.getElementById(bW)}else{this.element=document.createElement("div");bZ.appendChild(this.element)}this.element.className=bY;this.innerDiv=document.createElement("div");this.innerDiv.className="page-swipe-slider";this.element.appendChild(this.innerDiv);this.rightDiv=document.createElement("div");this.rightDiv.className="right-arrow";this.rightDiv.onclick=function(){bU.swipe(1)};this.element.appendChild(this.rightDiv);this.leftDiv=document.createElement("div");this.leftDiv.className="left-arrow";this.leftDiv.onclick=function(){bU.swipe(-1)};this.element.appendChild(this.leftDiv);for(;bX<bT.length;bX++){bT[bX].parent=this.innerDiv;bS.push(new bQ(bT[bX]))}this.pages=bS;this.index=0},e=bR.prototype;e.swipe=function(bS){var bT=this.pages.length;this.swipeTo((this.index+bS+bT)%bT)};e.setIndex=e.swipeTo=function(bS){this.index=bS;this.innerDiv.style.left=(-bS*100)+"%";if(this.pages[bS].onSwipe){this.pages[bS].onSwipe()}if(this.onSwipe){this.onSwipe(this.pages[bS].value,bS)}};e.getIndex=function(){return this.index};e.setValue=function(bT){for(var bS=0;bS<this.pages.length;bS++){if(this.pages[bS].value===bT){this.swipeTo(bS);return true}}return false};e.getValue=function(){return this.pages[this.index].value};return bR})();(function(bQ){var bS={google:null,paypal:null,firefox:null};if(navigator.mozPay){bS.firefox={items:[],buy:function(e,bX){var bT=this,bV=new Date().getTime(),bW=this.items[e],bU=function(bY){var bZ=null;bZ=navigator.mozPay([bY.jwt]);bZ.onsuccess=function(){gws.confirmPurchase(bX)};bZ.onerror=function(){gws.confirmPurchase(bX)}};gws.trackEvent("Purchase","Begin","Firefox",e);if(bW&&(bW.expires>bV)){bU(bW.item)}else{gws.client.getPurchase("hr",e,"firefox",function(bY){var bZ=undefined;try{bZ=JSON.parse(bY)}catch(b0){}if(bZ){bT.items[e]={item:bZ.firefox,expires:new Date().getTime()+3600000};bU(bT.items[e].item)}})}}}}else{if(this.console){console.log("Firefox payments package not loaded.")}}bS.paypal={items:[],onSuccess:null,success:function(){bS.paypal.flow.closeFlow();gws.confirmPurchase(this.onSuccess)},failure:function(){bS.paypal.flow.closeFlow();gws.confirmPurchase(this.onSuccess)},buy:function(e,bX){var bT=this,bV=new Date().getTime(),bW=this.items[e],bU=function(bY){bS.paypal.flow.startFlow("https://www.paypal.com/incontext?token="+bY.TOKEN)};gws.trackEvent("Purchase","Begin","PayPal",e);bT.onSuccess=bX;if(bW&&(bW.expires>bV)){bU(bW.item)}else{gws.client.getPurchase("hr",e,"paypal",function(bY){var bZ=undefined;try{bZ=JSON.parse(bY)}catch(b0){}if(bZ){bT.items[e]={item:bZ.paypal,expires:new Date().getTime()+3600000};bU(bT.items[e].item)}})}}};try{bS.paypal.flow=new PAYPAL.apps.DGFlow()}catch(bR){try{bS.paypal.flow=new PAYPAL.apps.DGFlow()}catch(bR){bS.paypal=null;if(this.console){console.log("PayPal payments package not loaded.")}}}bQ.payments=bS})(gws);gws.classes.playAgainPanel=(function(){var e=function(bR){this.parent=bR;this.showHeightNormal=-14;this.hideHeight=-30;this.panel=gws.createElement(this.parent,"div",false,"pap-panel");this.playAgainButtonFunction=function(){gws.scoreboard.hide();ah();bF(r)};this.mapChangeButtonFunction=function(){gws.scoreboard.hide();ah();if(gws.currentGame.players.length>1){gws.mainMenu.show("multiplayer")}else{gws.mainMenu.show("solitaire")}};var bT=[];bT[0]={id:"default",generalStyle:"button-default",image:gws.assets.copyTile("pap-icons",0,0)};bT[1]={id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile("pap-icons",1,0),onClickFunction:this.playAgainButtonFunction,altText:"Kliknite ovdje da se opet igrati!"};new gws.classes.button(this.panel,"pap-button","pap-play-again",bT);var bS=[];bS[0]={id:"default",generalStyle:"button-default",image:gws.assets.copyTile("pap-icons",0,1)};bS[1]={id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile("pap-icons",1,1),onClickFunction:this.mapChangeButtonFunction,altText:"Kliknite ovdje za promjenu karte!"};new gws.classes.button(this.panel,"pap-button","pap-change-map",bS)};var bQ=e.prototype;bQ.show=function(){this.panel.style.bottom=this.showHeightNormal+"em"};bQ.hide=function(){this.panel.style.bottom=this.hideHeight+"em"};return e})();function br(bU,bR,e,bQ,bT,bS){this.id=bU;if(bR){this.description=bU+" - "+bR+" team";this.team=bR}else{this.description=bU;this.team=bU}if(e){this.color=e}else{this.color="rgb("+(155+Math.floor(Math.random()*100))+","+(155+Math.floor(Math.random()*100))+","+(155+Math.floor(Math.random()*100))+")"}this.startTile=bQ;this.startPath=bT;this.startTile.colors[this.startPath]=this.color;this.startTile.setType("start");this.startTile.aStartEndpoints.splice(0,0,this.startPath);this.parent=bS;this.parent.rescale(bQ.x,bQ.y);this.update=function(){};this.aTileReserve=[];this.tiles=[];this.addTile=function(bV){this.tiles.splice(0,0,bV);return bV};this.removeTile=function(bV){if(!bV){bV=this.tiles[0]}for(x in this.tiles){if(bV==this.tiles[x]){this.tiles.splice(x,1);return bV}}return false};this.swapTiles=function(){if(this.tiles.length>1){return this.addTile(this.removeTile(this.tiles[this.tiles.length-1]))}return false};this.highScore=0;this.score=0;this.segments=0;this.highSegments=0}(function(){document.addEventListener("deviceready",function(){var bV=window.plugins.gaPlugin,e=window.plugins.ChildBrowser,bU=gws.vars.engine.server.address,bQ=true,bT=null,bW=null,bS={closed:false},bR=function(){};gws.body.style.overflow="visible";gws.bodyClip.style.overflow="visible";gws.body.addEventListener("touchmove",function(bX){bX.preventDefault()});bV.init(function(){gws.trackPage=function(bX){bV.trackPage(bR,bR,bX)};gws.trackEvent=function(bY,b0,bX,bZ){bV.trackEvent(bR,bR,bY,b0,bX,bZ)};gws.trackPage("/entanglement-v"+aQ.settings.version+"-phonegap")},bR,"UA-1007897-6",15);e.onLocationChange=function(bX){clearTimeout(bT);if(bX.indexOf(bU+"verify")===0){if(bQ){bQ=false;bT=setTimeout(function(){e.close()},1000)}else{e.close()}}else{if(bX.indexOf(bU+"close")===0){e.close()}}};e.onClose=function(){bS.closed=true;bQ=true;if(bW){bW();bW=null}};window.open=function(bZ,b1,b0,bY){var bX=document.location.href;bW=bY||null;if(bZ.indexOf("http://")===-1){bX=bX.split("index.html").join(bZ);bX=bX.split(" ").join("%20")}else{bX=bZ}bS.closed=false;e.showWebPage(bX,{showLocationBar:true});return bS};g(true);if(navigator&&navigator.app&&navigator.app.loadUrl){gws.loadURL=function(bX){navigator.app.loadUrl(bX,{openExternal:true})}}if(navigator&&navigator.splashscreen&&navigator.splashscreen.hide){navigator.splashscreen.hide()}},false)})();(function(e){var bQ=function(bU,bR,bY,bT){var bX=0,bW=(bR?0:1000),bV=function(bZ,b0){if(bZ.length>0){setTimeout(function(){var b1=bZ[0];if(bT!==(e.currentGame.randomSeed||e.currentGame.randomseed)){b0()}else{if(b1=="s"){aD();bV(bZ.substr(1),b0)}else{for(bX=0;bX<+b1;bX++){ab(1,bR)}setTimeout(function(){if(bT!==(e.currentGame.randomSeed||e.currentGame.randomseed)){b0()}else{aM(true,bR,bY);bV(bZ.substr(1),b0)}},bW)}}},bW)}else{b0()}},bS=function(b0){var bZ=0;if(b0=="s"){aD()}else{for(bZ=0;bZ<+b0;bZ++){ab(1,bR)}aM(true,bR,bY)}};e.disableInput();H(bR);if(bW){bV(bU,function(){e.enableInput()})}else{for(bX=0;bX<bU.length;bX++){bS(bU[bX])}e.enableInput()}};e.replay=function(bV,bT,bS,bW,bR,bU){if(!bT){if(bU){bU(false)}return false}gws.beginGame(bV,1,bT,bW,function(bX){if(bT===(bX.seed||bX.randomseed||bX.randomSeed)){gws.trackPage("/entanglement-"+(bW?"playable-":"")+"replay-"+r);bQ(bS,bR,!bW,bT);if(bR&&bW){setTimeout(function(){gws.ads.show()},7000)}if(bU){bU(true)}}else{if(bU){bU(false)}}});return true}})(gws);function bH(bR,bW,bQ,bY,bU){var bT=25.9;if(typeof bR==="string"){this.parent=document.getElementById(bR)}else{this.parent=bR;bR=bR.id||"selector"}this.parent.className="selection-box";this.parent.selectBox=this;this.titles=bW.slice();this.values=bQ.slice();this.index=0;this.size=bW.length;this.selectFunction=bY;var bV='<div id="'+bR+'-inside-window" class="selection-box-inside"><table><tr>';var bX=0;for(bX in this.titles){bV+='<td><div class="selection-box-item"><span>'+this.titles[bX]+"</span></div></td>"}bV+="</tr></table></div>";var e="<img src='i/arrow-left.png' alt='Prethodno' id='"+bR+"-left' class='selection-box-left-arrow' />";var bS="<img src='i/arrow-right.png' alt='Sljedeće' id='"+bR+"-right' class='selection-box-right-arrow' />";this.parent.innerHTML="<table><tr><td>"+e+'</td><td class="selection-box-window-outer"><div id="'+bR+'-window" class="selection-box-window-inner">'+bV+"</div></td><td>"+bS+"</td></tr></table>";this.leftButton=document.getElementById(bR+"-left");this.rightButton=document.getElementById(bR+"-right");this.innerWindow=document.getElementById(bR+"-inside-window");this.leftButton.selectBox=this;this.rightButton.selectBox=this;this.rightButton.onclick=function(bZ){this.selectBox.scroll(1)};this.leftButton.onclick=function(bZ){this.selectBox.scroll(-1)};if(bU){this.index=bU%this.size;this.innerWindow.style.left=(-bT*this.index)+"em"}this.scroll=function(bZ){this.index=(this.index+bZ+this.size)%this.size;this.innerWindow.style.left=(-bT*this.index)+"em";this.selectFunction([this.titles[this.index],this.values[this.index]])};this.getSelection=function(){return[this.titles[this.index],this.values[this.index]]};this.setSelectionByTitle=function(b0){var bZ=0;for(bZ in this.titles){if(this.titles[bZ]==b0){this.setIndex(bZ)}}};this.setSelectionByValue=function(b2){var bZ=0;var b0=false;for(bZ in this.values){if(this.values[bZ]==b2){this.setIndex(bZ);b0=true}}if(!b0){try{for(bZ in this.values){if(this.values[bZ][0]==b2){this.setIndex(bZ)}}}catch(b1){}}};this.setIndex=function(bZ){this.index=+bZ;this.scroll(0)}}gws.classes=gws.classes||{};imgSparks=[new Image(),new Image()];imgSparks[0].src="i/sparks1.png";imgSparks[1].src="i/sparks2.png";function a8(e,bS,bR,bQ){this.speed=gws.vars.view.flyingScoreSpeed;this.x=e;this.y=bS;this.value=bR;if(bQ){this.team=bQ;this.color=bQ.color}else{this.color="#fff582"}this.parent=document.getElementById("moving-scores");this.element=document.createElement("div");this.element.className="gameboard-message";this.element.style.position="absolute";this.element.style.top=this.y+"px";this.element.style.left=this.x+"px";this.element.style.color=this.color;this.element.style.textShadow="0px 0px 3px #ffffff";if(an>1){this.element.style.textShadow="0px 0px 3px #000000"}this.element.style.display="none";this.element.object=this;this.parent.insertBefore(this.element,null);this.element.innerHTML=this.value;this.killMe=false;this.counter=0;this.update=function(){this.counter+=this.speed;if(this.counter>=1){this.element.style.display="block"}if(this.counter<50){this.element.style.opacity=(50-this.counter)/50}else{this.killMe=true}}}function R(e){this.speed=gws.vars.view.flyingScoreSpeed;this.value=e;this.parent=document.getElementById("moving-scores");this.element=document.createElement("div");this.element.className="big-gameboard-message";this.element.style.display="none";this.element.object=this;this.parent.insertBefore(this.element,null);this.element.innerHTML=this.value;this.killMe=false;this.counter=0;this.update=function(){this.counter+=this.speed;if(this.counter>=1){this.element.style.display="block"}if(this.counter<15){this.element.style.opacity=this.counter/15}else{if(this.counter<65){this.element.style.opacity=(65-this.counter)/50}else{this.killMe=true}}}}function V(bT,e,bR,bU,bQ,bS){this.speed=gws.vars.view.flyingScoreSpeed;this.iDelay=bS;if(!this.iDelay){this.iDelay=75}this.kTile=bT;this.sDescription=bU;this.team=bQ;this.fScale=bT.parent.scale*e;this.iNumber=bR;this.iStartWidth=Math.floor(this.fScale*l*3);this.iEndWidth=Math.floor(this.fScale*l*5);this.iWidthRange=this.iEndWidth-this.iStartWidth;this.iStartHeight=Math.floor(this.fScale*j*1.5);this.iEndHeight=Math.floor(this.fScale*j*2.5);this.iHeightRange=this.iEndHeight-this.iStartHeight;this.parent=document.getElementById("moving-scores");this.element=document.createElement("canvas");this.element.className="bonus-note";this.element.style.position="absolute";this.element.style.zIndex="52";this.element.style.top=(this.kTile.windowY()-(this.iStartHeight/2))+"px";this.element.style.left=(this.kTile.windowX()-(this.iStartWidth/2))+"px";this.element.style.width=this.iStartWidth+"px";this.element.style.height=this.iStartHeight+"px";this.element.width="200";this.element.height="173";this.element.style.display="block";this.element.style.opacity="0.01";this.element.object=this;this.parent.insertBefore(this.element,null);this.image=document.getElementById("bonus-tiles");this.imageX=0;this.imageY=0;if(bU=="Bonus Tile"){this.imageX=200}this.ctx=this.element.getContext("2d");this.killMe=false;this.firstStep=parseInt(0.15*this.iDelay);this.secondStep=this.iDelay-this.firstStep;this.counter=0;this.counterStart=0;this.counterEnd=this.iDelay;this.update=function(){this.counter+=this.speed;if(this.counter>=this.counterEnd){this.killMe=true}else{if(this.counter<=this.firstStep){this.element.style.opacity=(this.counter/this.firstStep);if(this.team.startTile==this.kTile){var b0=this.iHeightRange*(this.counter/this.firstStep);var bX=this.iWidthRange*(this.counter/this.firstStep);this.element.style.top=(this.kTile.windowY()-((this.iStartHeight+b0)/2))+"px";this.element.style.left=(this.kTile.windowX()-((this.iStartWidth+bX)/2))+"px";this.element.style.width=(this.iStartWidth+bX)+"px";this.element.style.height=(this.iStartHeight+b0)+"px"}else{this.element.style.top=(this.kTile.windowY()-(this.iStartHeight/2))+"px";this.element.style.left=(this.kTile.windowX()-(this.iStartWidth/2))+"px";this.element.style.width=this.iStartWidth+"px";this.element.style.height=this.iStartHeight+"px"}if(!this.drawn){this.drawn=true;if(an==1){this.ctx.drawImage(this.image,this.imageX,this.imageY,200,173,0,0,this.element.width,this.element.height)}else{var bZ=0.45;var b2=l;var b1=j/2;var bV=j*bZ;var bW=l*bZ;ctx=this.ctx;ctx.fillStyle=this.team.color;ctx.shadowOffsetX=0;ctx.shadowOffsetY=0;ctx.shadowBlur=30*bZ;ctx.shadowColor="#ffffdd";ctx.beginPath();ctx.moveTo(b2-bW,b1-bV);ctx.lineTo(b2+bW,b1-bV);ctx.lineTo(b2+2*bW,b1);ctx.lineTo(b2+bW,b1+bV);ctx.lineTo(b2-bW,b1+bV);ctx.lineTo(b2-2*bW,b1);ctx.lineTo(b2-bW,b1-bV);ctx.closePath();ctx.fill()}this.ctx.textAlign="center";this.ctx.textBaseline="middle";var b4=j/2;this.ctx.font=b4+"px Fontin-SmallCaps";this.ctx.fillStyle="#ffffdd";this.ctx.shadowOffsetX=0;this.ctx.shadowOffsetY=0;var bY=0.15;this.ctx.shadowBlur=b4*bY;this.ctx.shadowColor=this.ctx.fillStyle;if(an>1){ctx.shadowColor="#000000"}this.ctx.fillText(this.iNumber,this.element.width/2,this.element.height/2-(b4*0.14));b4=parseInt(b4*0.2);this.ctx.shadowBlur=b4*bY;this.ctx.font=b4+"px Fontin-SmallCaps";this.ctx.fillText(this.sDescription,this.element.width/2,this.element.height/2+(b4*2));this.ctx.shadowColor="transparent"}}else{if(this.counter>=(this.counterEnd-this.secondStep)){var b3=((this.counterEnd-this.counter)/this.secondStep);this.element.style.opacity=b3;if(this.team.startTile==this.kTile){var b0=Math.floor((this.iStartHeight+this.iHeightRange*(2-b3))/2)*2;var bX=Math.floor((this.iStartWidth+this.iWidthRange*(2-b3))/2)*2;this.element.style.top=(this.kTile.windowY()-(b0/2))+"px";this.element.style.left=(this.kTile.windowX()-(bX/2))+"px";this.element.style.width=bX+"px";this.element.style.height=b0+"px"}else{this.element.style.top=((this.team.startTile.windowY()*(1-b3)+this.kTile.windowY()*b3)-(this.iStartHeight/2))+"px";this.element.style.left=((this.team.startTile.windowX()*(1-b3)+this.kTile.windowX()*b3)-(this.iStartWidth/2))+"px";this.counter+=(3*this.speed)}}}}}}function b(bR,e,bQ){this.speed=gws.vars.view.flyingScoreSpeed;this.iDelay=bQ;if(!this.iDelay){this.iDelay=50}this.kTile=bR;this.fScale=bR.parent.scale*e;this.iStartWidth=Math.floor(this.fScale*l*3);this.iEndWidth=Math.floor(this.fScale*l*5);this.iWidthRange=this.iEndWidth-this.iStartWidth;this.iStartHeight=Math.floor(this.fScale*j*1.5);this.iEndHeight=Math.floor(this.fScale*j*2.5);this.iHeightRange=this.iEndHeight-this.iStartHeight;this.parent=document.getElementById("moving-scores");this.element=document.createElement("canvas");this.element.className="throw-sparks";this.element.style.position="absolute";this.element.style.top=(this.kTile.windowY()-(this.iStartHeight/2))+"px";this.element.style.left=(this.kTile.windowX()-(this.iStartWidth/2))+"px";this.element.style.width=this.iStartWidth+"px";this.element.style.height=this.iStartHeight+"px";this.element.width="200";this.element.height="173";this.element.style.display="block";this.element.style.opacity="0.01";this.element.object=this;this.parent.insertBefore(this.element,null);this.image=imgSparks[0];this.ctx=this.element.getContext("2d");this.killMe=false;this.firstStep=parseInt(0.15*this.iDelay);this.secondStep=this.iDelay-this.firstStep;this.counter=0;this.counterStart=0;this.counterEnd=this.iDelay;this.update=function(){this.counter+=this.speed;if(this.counter>=this.counterEnd){this.killMe=true}else{if(this.counter<=this.firstStep){this.element.style.opacity=(this.counter/this.firstStep);var bS=this.iHeightRange*(this.counter/this.firstStep);var bU=this.iWidthRange*(this.counter/this.firstStep);this.element.style.top=(this.kTile.windowY()-((this.iStartHeight+bS)/2))+"px";this.element.style.left=(this.kTile.windowX()-((this.iStartWidth+bU)/2))+"px";this.element.style.width=(this.iStartWidth+bU)+"px";this.element.style.height=(this.iStartHeight+bS)+"px";if(!this.drawn){this.drawn=true;this.ctx.drawImage(this.image,0,0,this.element.width,this.element.height)}}else{if(this.counter>=(this.counterEnd-this.secondStep)){var bT=((this.counterEnd-this.counter)/this.secondStep);this.element.style.opacity=bT;var bS=Math.floor((this.iStartHeight+this.iHeightRange*(2-bT))/2)*2;var bU=Math.floor((this.iStartWidth+this.iWidthRange*(2-bT))/2)*2;this.element.style.top=(this.kTile.windowY()-(bS/2))+"px";this.element.style.left=(this.kTile.windowX()-(bU/2))+"px";this.element.style.width=bU+"px";this.element.style.height=bS+"px"}}}}}var Y=0;var y="";var bJ=8;function A(e){return K(T(bu(e),e.length*bJ))}function bq(e){return Q(T(bu(e),e.length*bJ))}function aJ(e){return aj(T(bu(e),e.length*bJ))}function aO(e,bQ){return K(h(e,bQ))}function bk(e,bQ){return Q(h(e,bQ))}function aw(e,bQ){return aj(h(e,bQ))}function aH(){return A("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function T(b3,bX){b3[bX>>5]|=128<<(24-bX%32);b3[((bX+64>>9)<<4)+15]=bX;var b4=Array(80);var b2=1732584193;var b1=-271733879;var b0=-1732584194;var bZ=271733878;var bY=-1009589776;for(var bU=0;bU<b3.length;bU+=16){var bW=b2;var bV=b1;var bT=b0;var bS=bZ;var bQ=bY;for(var bR=0;bR<80;bR++){if(bR<16){b4[bR]=b3[bU+bR]}else{b4[bR]=a0(b4[bR-3]^b4[bR-8]^b4[bR-14]^b4[bR-16],1)}var b5=p(p(a0(b2,5),aK(bR,b1,b0,bZ)),p(p(bY,b4[bR]),E(bR)));bY=bZ;bZ=b0;b0=a0(b1,30);b1=b2;b2=b5}b2=p(b2,bW);b1=p(b1,bV);b0=p(b0,bT);bZ=p(bZ,bS);bY=p(bY,bQ)}return Array(b2,b1,b0,bZ,bY)}function aK(bQ,e,bS,bR){if(bQ<20){return(e&bS)|((~e)&bR)}if(bQ<40){return e^bS^bR}if(bQ<60){return(e&bS)|(e&bR)|(bS&bR)}return e^bS^bR}function E(e){return(e<20)?1518500249:(e<40)?1859775393:(e<60)?-1894007588:-899497514}function h(bR,bU){var bT=bu(bR);if(bT.length>16){bT=T(bT,bR.length*bJ)}var e=Array(16),bS=Array(16);for(var bQ=0;bQ<16;bQ++){e[bQ]=bT[bQ]^909522486;bS[bQ]=bT[bQ]^1549556828}var bV=T(e.concat(bu(bU)),512+bU.length*bJ);return T(bS.concat(bV),512+160)}function p(e,bS){var bR=(e&65535)+(bS&65535);var bQ=(e>>16)+(bS>>16)+(bR>>16);return(bQ<<16)|(bR&65535)}function a0(e,bQ){return(e<<bQ)|(e>>>(32-bQ))}function bu(bS){var bR=Array();var e=(1<<bJ)-1;for(var bQ=0;bQ<bS.length*bJ;bQ+=bJ){bR[bQ>>5]|=(bS.charCodeAt(bQ/bJ)&e)<<(32-bJ-bQ%32)}return bR}function aj(bR){var bS="";var e=(1<<bJ)-1;for(var bQ=0;bQ<bR.length*32;bQ+=bJ){bS+=String.fromCharCode((bR[bQ>>5]>>>(32-bJ-bQ%32))&e)}return bS}function K(bR){var bQ=Y?"0123456789ABCDEF":"0123456789abcdef";var bS="";for(var e=0;e<bR.length*4;e++){bS+=bQ.charAt((bR[e>>2]>>((3-e%4)*8+4))&15)+bQ.charAt((bR[e>>2]>>((3-e%4)*8))&15)}return bS}function Q(bS){var bR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var bU="";for(var bQ=0;bQ<bS.length*4;bQ+=3){var bT=(((bS[bQ>>2]>>8*(3-bQ%4))&255)<<16)|(((bS[bQ+1>>2]>>8*(3-(bQ+1)%4))&255)<<8)|((bS[bQ+2>>2]>>8*(3-(bQ+2)%4))&255);for(var e=0;e<4;e++){if(bQ*8+e*6>bS.length*32){bU+=y}else{bU+=bR.charAt((bT>>6*(3-e))&63)}}}return bU}var a3;function L(e,bQ,bU){var bT=document.getElementById("subtle-message");var bV=document.getElementById("subtle-message-content");bV.innerHTML="";var bS=undefined;if(typeof e==="string"){var bS=document.createElement("div");bS.innerHTML=e}else{bS=e}bV.appendChild(bS);clearTimeout(a3);if(bQ){a3=setTimeout(function(){aa()},bQ)}else{if(gws.browser.mobile){var bR=[{id:"default",generalStyle:"button-default",image:gws.assets.copyTile("exit",0,0),},{id:"hover",generalStyle:"button-hover",image:gws.assets.copyTile("exit",1,0),onClickFunction:function(){aa();if(bU){bU()}}}];new gws.classes.button(bV,"subtle-message-button",false,bR)}else{var bW=gws.createElement(bV,"a","subtle-exit");bW.innerHTML="X";bW.onclick=function(){aa();if(bU){bU()}}}}bT.style.top="0"}function aa(){document.getElementById("subtle-message").style.top="-50em"}gws.tutorial={index:0,show:function(bS){var e=this;var bR="";var bQ=document.createElement("div");bQ.className="tutorial-text";if(bS){e.index=bS}switch(e.index){case 1:if(gws.browser.conduitTilt){bR="Koristite strelice na vašem telefonu za zakretanje pločica."}else{if(gws.browser.mobile){bR="Koristite tipke sa strelicama za rotirati pločice."}else{bR="Strelicama ili kotačićem miša okrećite šesterokutnu pločicu."}}bQ.innerHTML=bR;L(bQ);break;case 2:if(gws.browser.conduitTilt){bR="Dodirnite telefonu za postavljanje pločica na svoje mjesto."}else{if(gws.browser.mobile){bR="Dodirnite odbora za zaključavanje pločicu na mjesto."}else{bR="Kad namjestite pločicu, pritisnite razmaknicu ili kliknite mišem da biste je položili."}}bQ.innerHTML=bR;L(bQ);break;case 3:bQ.innerHTML="Vijugajte po ploči i pokušajte napraviti najdulji put, a da pritom ne udarite u zid.";L(bQ);break;case 6:bQ.innerHTML="Pravljenjem petlji kroz više pločica dobivate još više bodova!";L(bQ);setTimeout(function(){e.index=0;e.hide()},5000);break;default:setTimeout(function(){e.hide()},10);break}},hide:function(){aa()}};(function(bQ){var e=Math.PI/3,bT=function(bU){var bV=bU%2;if(bV){return(bU+5)%12}else{return(bU+7)%12}},bS=function(bU,b0,bV,bY,bW,bX,bZ){this.x=bU;this.y=b0;this.description=bU+","+b0;this.team=bV;this.parent=bW;if(!bX){this.sTileType=bY}else{this.sTileType=bX}this.eBonusType={NONE:false,TILES_3:{points:0,tiles:0.5,addition:true},TILES_6:{points:0,tiles:1,addition:true},POINTS:{points:1,tiles:0,addition:true}};this.eBonus=this.eBonusType.NONE;this.aBonus=[];if(bZ){this.aBonus=bZ}if(this.aBonus.length>0){if(this.aBonus.length==3){this.eBonus=this.eBonusType.TILES_3}if(this.aBonus.length==6){this.eBonus=this.eBonusType.TILES_6}if(this.aBonus.length==12){this.eBonus=this.eBonusType.POINTS}}this.colors=["gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray"];this.aStartEndpoints=[];if(bY=="generate"){this.generate()}else{this.pairs=bY}this.showJewelry=false;this.animate=0;this.frame=0;this.numberOfFrames=8;this.rotating=0;this.rotationCount=0},bR=bS.prototype;bR.generate=function(){this.pairs=[0,1,2,3,4,5,6,7,8,9,10,11];var bW,bU,bV;for(bW=1;bW<12;bW++){bU=Math.floor(Math.random()*(1+bW));if(bU!=bW){bV=this.pairs[bW];this.pairs[bW]=this.pairs[bU];this.pairs[bU]=bV}}};bR.connect=function(bU,bV){switch(bU){case"A":this.sideA=bV;bV.sideD=this;break;case"B":this.sideB=bV;bV.sideE=this;break;case"C":this.sideC=bV;bV.sideF=this;break;case"D":this.sideD=bV;bV.sideA=this;break;case"E":this.sideE=bV;bV.sideB=this;break;case"F":this.sideF=bV;bV.sideC=this;break}};bR.setType=function(bU,bV){if(bU=="start"){if(this.sTileType.substring(0,5)!="start"){this.sTileType="start-"+this.sTileType;if(bV){this.pairs=bV}}}else{this.sTileType=bU;if(bV){this.pairs=bV}}};bR.paint=function(){var bU;for(bU in this.colors){if(this.colors[bU]=="gray"){if(this.getPartnerColor(+bU)!="gray"){this.colors[bU]=this.getPartnerColor(+bU)}}}for(bU in this.colors){if(this.colors[bU]!="gray"){this.paintTrack(bU,this.colors[bU])}}};bR.paintTrack=function(bU,bW){var bX=0;var bV=true;var bY;for(bY in this.aStartEndpoints){if(this.aStartEndpoints[bY]==bU){bV=false}}if(bV){for(bX in this.pairs){if(this.pairs[bX]==bU){if(bX%2){this.colors[this.pairs[bX]]=bW;if(this.colors[this.pairs[+bX-1]]=="gray"){this.colors[this.pairs[+bX-1]]=bW;if(this.getPartner(this.pairs[+bX-1])){this.getPartner(this.pairs[+bX-1]).paintTrack(bT(this.pairs[+bX-1]),bW)}}}else{this.colors[this.pairs[bX]]=bW;if(this.colors[this.pairs[+bX+1]]=="gray"){this.colors[this.pairs[+bX+1]]=bW;if(this.getPartner(this.pairs[+bX+1])){this.getPartner(this.pairs[+bX+1]).paintTrack(bT(this.pairs[+bX+1]),bW)}}}break}}}};bR.appendTo=function(bX){var bW=0;var b0=this.getPartner(bX);if(b0){if((b0.pairs=="wall")||(b0.pairs=="empty")){return b0}else{var bZ;var bV=bT(+bX);for(bZ in b0.aStartEndpoints){if(b0.aStartEndpoints[bZ]==bV){return b0}}for(bW in b0.pairs){if(b0.pairs[+bW]==bV){if((+bW)%2){for(bZ in b0.aStartEndpoints){if(b0.aStartEndpoints[bZ]==b0.pairs[+bW-1]){return b0}}return b0.appendTo(b0.pairs[+bW-1])}else{for(bZ in b0.aStartEndpoints){if(b0.aStartEndpoints[bZ]==b0.pairs[+bW+1]){return b0}}return b0.appendTo(b0.pairs[+bW+1])}}}return false}}else{var bU=0;var b1=0;switch(bX){case 0:case 1:bU=this.x;b1=this.y-ay;break;case 2:case 3:bU=this.x+az;b1=this.y-j;break;case 4:case 5:bU=this.x+az;b1=this.y+j;break;case 6:case 7:bU=this.x;b1=this.y+ay;break;case 8:case 9:bU=this.x-az;b1=this.y+j;break;case 10:case 11:bU=this.x-az;b1=this.y-j;break}var bY=this.parent.add(new bS(bU,b1,0,0,this.parent),true);this.parent.rescale();return bY}};bR.countSegments=function(bX,bZ,bY,b5,bW,b3,b8){var b6=this,b2=0,bV=this.getPartner(bX);if(!bW){bW=0}if(!b3){b3=false}var b4=bZ-bY.segments;if(b4>0){if(b5){bL+=b4;gws.windows.showScores()}else{gws.view.addEvent("score-tile",{x:b6.windowX(),y:b6.windowY(),score:b4,color:bY.color,delay:b4*150,onFinished:function(){bL+=b4;gws.windows.showScores()}})}switch(this.eBonus){case this.eBonusType.TILES_3:var b7=6-this.pairsMatching("gray");var bU=3-Math.floor(b7/2);if(bU<this.aBonus.length){this.bTileBonusIcon=false;if(!b5){this.parent.incrementalScores.splice(0,0,new V(this,1,1,"Bonus pločica",bY));this.parent.incrementalScores.splice(0,0,new b(this,0.8))}bY.aTileReserve.splice(0,0,this.aBonus[0]);this.aBonus.splice(0,1);b3="tile"}else{if(b7%2){this.bTileBonusIcon=true;if(b7==1){this.animate=1}b3="unlock"}else{this.bTileBonusIcon=false;b3="tile"}}this.showJewelry=true;break;case this.eBonusType.TILES_6:if(this.pairsMatching("gray")<this.aBonus.length){if(this.pairsMatching("gray")==5){this.animate=1}this.bTileBonusIcon=false;if(!b5){this.parent.incrementalScores.splice(0,0,new V(this,1,1,"Bonus pločica",bY));this.parent.incrementalScores.splice(0,0,new b(this,0.8))}bY.aTileReserve.splice(0,0,this.aBonus[0]);this.aBonus.splice(0,1);b3="tile"}this.showJewelry=false;break;case this.eBonusType.POINTS:var b1=(this.pairsMatching(bY.color)*10);bW+=b1;if(b5){bL+=b1;gws.windows.showScores()}else{gws.view.addEvent("score-tile",{x:b6.windowX(),y:b6.windowY(),score:b1,color:bY.color,delay:500,onFinished:function(){bL+=b1;gws.windows.showScores()}});this.parent.incrementalScores.splice(0,0,new V(this,1,b1,"Bonus bodovi",bY))}b3="points";break;default:}}if(b8){for(i in this.aStartEndpoints){if(this.aStartEndpoints[i]==bX){return{iSegments:bZ,iPoints:bW,sBonusType:b3}}}}if(bV){if((bV.pairs=="wall")||(bV.pairs=="empty")){return{iSegments:bZ,iPoints:bW,sBonusType:b3}}else{for(b2 in bV.pairs){if(bV.pairs[+b2]==bT(+bX)){var b0;if((+b2)%2){b0=bV.pairs[+b2-1]}else{b0=bV.pairs[+b2+1]}if(this.colors[bX]!=bV.colors[b0]){return{iSegments:bZ,iPoints:bW,sBonusType:b3}}else{return bV.countSegments(b0,bZ+1,bY,b5,bW,b3,true)}}}return{iSegments:bZ,iPoints:bW,sBonusType:b3}}}else{return{iSegments:bZ,iPoints:bW,sBonusType:b3}}};bR.pairsMatching=function(bU){var bX=0;for(var bV in this.colors){if(bU==this.colors[bV]){bX++}}var bW=Math.floor(bX/2);return bW};bR.getPartnerColor=function(bU){if(this.getPartner(bU)){return this.getPartner(bU).colors[bT(bU)]}else{return"gray"}};bR.getPartner=function(bU){switch(bU){case 0:case 1:if(this.sideA){return this.sideA}break;case 2:case 3:if(this.sideB){return this.sideB}break;case 4:case 5:if(this.sideC){return this.sideC}break;case 6:case 7:if(this.sideD){return this.sideD}break;case 8:case 9:if(this.sideE){return this.sideE}break;case 10:case 11:if(this.sideF){return this.sideF}break}return false};bR.update=function(){};bR.render=function(bV,bU){if(!bV){bV=this.parent.scale}if(!this.view){this.view=new gws.classes.polygonTileView({reference:this,parent:this.parent,context:bU||this.parent.context})}this.view.render()};bR.rotate=function(bV){var bW=0,bU=0;if(bV>0){this.rotationCount=(this.rotationCount+1)%6;bW=2}else{this.rotationCount=(this.rotationCount+5)%6;bW=10}for(;bU<this.pairs.length;bU++){this.pairs[bU]=(this.pairs[bU]+bW)%12}this.rotating-=(bV*e)};bR.windowX=function(){return(this.parent.x+this.x)*this.parent.scale};bR.windowY=function(){return(this.parent.y+this.y)*this.parent.scale};bQ.polygonTile=bS})(gws.classes);(function(bX){var bW=gws.vars.map.offsetX/3,bS=gws.vars.map.offsetY/3,bV="",e=function(b0,b1){var bZ=b0.style,b2=b1+bV;bZ.webkitTransform=b2;bZ.mozTransform=b2;bZ.msTransform=b2;bZ.OTransform=b2;bZ.transform=b2},bQ=function(b2,bZ,b1,b3){var b0=document.createElement(bZ);b1?b0.className=b1:false;b3?b0.id=b3:false;b2?b2.appendChild(b0):false;return b0},bT=function(bZ,b4,b0,b1){var b3=bW,b2=bS;b0.shadowOffsetX=0;b0.shadowOffsetY=0;b0.shadowBlur=24;b0.shadowColor=b1;b0.fillStyle=b1;b0.strokeStyle=b1;b0.lineWidth=6;b0.beginPath();b0.moveTo(bZ-b3,b4-b2);b0.lineTo(bZ+b3,b4-b2);b0.lineTo(bZ+2*b3,b4);b0.lineTo(bZ+b3,b4+b2);b0.lineTo(bZ-b3,b4+b2);b0.lineTo(bZ-2*b3,b4);b0.lineTo(bZ-b3,b4-b2);b0.closePath();b0.globalAlpha=0.2;b0.fill();b0.globalAlpha=1;b0.stroke()},bY=function(b1,bZ,b4,b3,b0,b6){var b5=new gws.classes.entMap(bQ(b1,"canvas","tile-pad"),0,0,200,200,+0.4),b2=new gws.classes.polygonTile(0,0,0,[0,1,2,3,4,5,6,7,8,9,10,11],b5,"path");b5.add(b2,true);b5.canvas.width=200*(window.devicePixelRatio||1);b5.canvas.height=200*(window.devicePixelRatio||1);if(bZ){b5.canvas.onmouseover=bZ}if(b4){b5.canvas.onmouseout=b4}if(b3){b5.canvas.onclick=b3}if(b0){b5.canvas.oncontextmenu=b0}if(b6){b5.canvas.ontouchstart=b6}b5.setFocus(0,0,0.5);this.map=b5;this.tile=b2;this.x=0;this.y=0;this.scale=1;this.rotation=0},bR=function(b2){var b1=0,b0=null,b4=null,bZ=null,b3="#8ef0c1";bV=(gws.browser.css3dTransforms?" translateZ(0)":"");this.parentElement=b2.parentElement;this.parentMap=b2.parentMap;this.onResize=b2.onResize||false;this.onDestroy=b2.onDestroy||false;this.glowElements=[];for(b1=0;b1<b2.players.length;b1++){b0=b2.players[b1];this.glowElements[b1]=b4=bQ(this.parentElement,"canvas","tile-glow");b4.width=180;b4.height=180;bZ=b4.getContext("2d");if(b2.players.length!==1){b3=b0.color}bT(90,90,bZ,b3)}this.pads=[];for(b1=0;b1<b2.tiles;b1++){this.pads[this.pads.length]=new bY(this.parentElement,b2.onHover,b2.onHoverOut,b2.onClick,b2.onRightClick,b2.onTouch)}this.messageLayer=bQ(this.parentElement,"div","tile-message");if(b2.onHover){this.messageLayer.onmouseover=b2.onHover}if(b2.onHoverOut){this.messageLayer.onmouseout=b2.onHoverOut}if(b2.onClick){this.messageLayer.onclick=b2.onClick}if(b2.onRightClick){this.messageLayer.oncontextmenu=b2.onRightClick}if(b2.onTouch){this.messageLayer.ontouchstart=b2.onTouch}this.activePlayer=0;this.activeIndex=0;this.activeX=0;this.activeY=0;this.swapShowing=1},bU=bR.prototype;bU.updatePads=function(b3,b6,b0,b5,bZ){var b2=0,b1=this,b4=null;this.activePlayer=b3;this.message=bZ;if(b6.length<2){this.swapShowing=-1}else{this.swapShowing=1}for(;b2<this.pads.length;b2++){b4=this.pads[b2];b4.rotation=0;this.activeIndex=+b2;this.rotateTile(0);if(b6[b2]){b4.tile.pairs=b6[b2].pairs}b4.tile.render();b4.map.canvas.className="tile-pad"}this.activeX=b0;this.activeY=b5;this.activeIndex=0;this.resize();setTimeout(function(){var b7=0;for(;b7<b6.length;b7++){b1.pads[b7].map.canvas.className="tile-pad tile-pad-transition"}},1)};bU.resize=function(){var b2=0,b3=null,b0=this.parentMap.world2windowX(this.activeX,0),bZ=this.parentMap.world2windowY(this.activeY,0),b4=this.parentMap.scale*1.9,b1=parseFloat(gws.body.style.fontSize);for(b2=0;b2<this.pads.length;b2++){b3=this.pads[b2];if(b2==this.activeIndex){b3.x=b0;b3.y=bZ;b3.scale=b4}else{b3.x=9*b1;b3.y=window.innerHeight-8*b1*this.swapShowing;b3.scale=0.085*b1}this.render(this.pads[b2])}this.renderGlow();this.renderMessage(this.message);if(this.onResize){this.onResize(b0,bZ,this.parentMap.scale)}};bU.swapTile=function(){var b0=this.pads[this.activeIndex],bZ=b0.x,b3=b0.y,b2=b0.scale,b1=null;if(this.swapShowing==1){this.activeIndex=1-this.activeIndex;b1=this.pads[this.activeIndex];b0.x=b1.x;b0.y=b1.y;b0.scale=b1.scale;b1.x=bZ;b1.y=b3;b1.scale=b2;this.render(b0);this.render(b1)}};bU.rotateTile=function(b0){var bZ=this.pads[this.activeIndex];if(b0){bZ.tile.rotate(b0)}bZ.rotation+=b0*60;this.render(bZ)};bU.render=function(bZ){e(bZ.map.canvas,"translate("+bZ.x+"px, "+bZ.y+"px) rotate("+bZ.rotation+"deg) scale("+bZ.scale+", "+bZ.scale+")")};bU.renderGlow=function(){var bZ=0,b0=this.pads[this.activeIndex],b2=b0.scale*1.5,b1="";for(;bZ<this.glowElements.length;bZ++){if(bZ==this.activePlayer){b1="translate("+b0.x+"px, "+b0.y+"px) scale("+b2+", "+b2+")"}else{b1="translate(-200px, -200px) scale(1, 1)"}e(this.glowElements[bZ],b1)}};bU.renderMessage=function(b0){var bZ=-200,b3=-200,b2=1,b1=null;if(b0){if(b0!==this.messageLayer.innerHTML){this.messageLayer.innerHTML=b0}b1=this.pads[this.activeIndex];bZ=b1.x;b3=b1.y;b2=b1.scale*1.6}e(this.messageLayer,"translate("+bZ+"px, "+b3+"px) scale("+b2+", "+b2+")")};bU.destroy=function(){var bZ=0;for(bZ=0;bZ<this.glowElements.length;bZ++){this.parentElement.removeChild(this.glowElements[bZ])}for(bZ=0;bZ<this.pads.length;bZ++){this.parentElement.removeChild(this.pads[bZ].map.canvas)}this.parentElement.removeChild(this.messageLayer);this.glowElements.length=0;this.pads.length=0;if(this.onDestroy){this.onDestroy()}};bX.tileControl=bR})(gws.classes);gws.setUpTileController=function(b0,bW,bR,bS,bX){var b1=0,bZ=0,b4=1,b5=true,bQ=true,b6=true,bY=false,bT=document.getElementById("right-controller"),bV=document.getElementById("left-controller"),bU=(gws.browser.css3dTransforms?" translateZ(0)":""),b3=function(b8,b9){var b7=b8.style,ca=b9+bU;b7.webkitTransform=ca;b7.mozTransform=ca;b7.msTransform=ca;b7.OTransform=ca;b7.transform=ca},b2=function(b8){var b7=b1,ca=b8||bZ,b9="translate("+(b7+180*b4)+"px, "+(ca+200*b4)+"px) scale("+b4+", "+b4+")";b3(bT,b9);b9="translate("+(b7-180*b4)+"px, "+(ca+200*b4)+"px) scale("+b4+", "+b4+")";b3(bV,b9)},e=function(b7){var b8="translateX("+b7+"px)";b3(bT,b8);var b8="translateX("+-b7+"px)";b3(bV,b8)};if(!bS){bT.onmouseover=function(){b6=false;b2(0);if(bY){clearTimeout(bY);bY=false}};bV.onmouseover=function(){bQ=false;b2(0);if(bY){clearTimeout(bY);bY=false}};bT.onmouseout=function(){b6=true;bY=setTimeout(function(){if(b5&&bQ&&b6){b2(-600)}},1000)};bV.onmouseout=function(){bQ=true;bY=setTimeout(function(){if(b5&&bQ&&b6){b2(-600)}},1000)}}if(bS&&bX){e(0)}gws.tileController=new gws.classes.tileControl({parentElement:gws.bodyClip,parentMap:bW,players:bR,tiles:b0.spareTiles+1,onHover:((bS||!bX)?null:function(){b5=false;b2(0);if(bY){clearTimeout(bY);bY=false}}),onHoverOut:((bS||!bX)?null:function(){b5=true;bY=setTimeout(function(){if(b5&&bQ&&b6){b2(-600)}},250)}),onClick:((bS||!bX)?null:function(){aM();return false}),onRightClick:((bS||!bX)?null:function(){aD();return false}),onTouch:((bS&&bX)?function(){aM()}:null),onResize:((bS||!bX)?null:function(b7,b9,b8){b1=b7;bZ=b9;b4=b8;b2(-600)}),onDestroy:((bS&&bX)?function(){e(250)}:null)})};gws.classes=gws.classes||{};gws.classes.view=function(e,bS,bR,bQ){this.parentElement=e;this.assets=bS;this.audio=bR;this.mobile=bQ;this.prepareAssets();this.element=document.createElement("div");this.element.className="map";this.parentElement.appendChild(this.element);this.width=this.element.offsetWidth;this.height=this.element.offsetHeight;this.layers=[];this.images=[];this.events=[];this.prepareView(this.assets,this.audio,this.mobile)};gws.classes.view.prototype.getScoreDestinationX=function(){var e=document.getElementById("single-score")||document.getElementById("inner-scores")||document.getElementById("scores");return e.offsetLeft+e.offsetWidth/2};gws.classes.view.prototype.getScoreDestinationY=function(){var e=document.getElementById("single-score")||document.getElementById("inner-scores")||document.getElementById("scores");return e.offsetTop+e.offsetHeight/2};gws.classes.view.prototype.addLayer=function(bR,bQ,e){var bS=new gws.classes.layer(this,bR,bQ,e,this.usingDivs);this.layers.splice(0,0,bS);return bS};gws.classes.view.prototype.addImage=function(bQ,e){bQ.className=e||"map-layer";this.element.appendChild(bQ);this.images.splice(0,0,bQ)};gws.classes.view.prototype.removeLayer=function(e){for(x in this.layers){if(e==this.layers[x]){this.layers[x].destroy();this.layers.splice(x,1)}}};gws.classes.view.prototype.addEvent=function(e,bQ){this.processEvent(e,bQ)};gws.classes.view.prototype.processEvent=function(e,bQ){switch(e){case"score-tile":this.animateScore(bQ.score,bQ.x,bQ.y,bQ.color,bQ.delay,bQ.onFinished);break;default:break}};gws.classes.view.prototype.update=function(){for(x in this.layers){this.layers[x].update()}};gws.classes.view.prototype.render=function(){for(x in this.layers){this.layers[x].render()}};gws.classes.view.prototype.resize=function(){for(x in this.layers){this.layers[x].width=this.element.offsetWidth;this.layers[x].height=this.element.offsetHeight;this.layers[x].resize()}if(gws.tileController){gws.tileController.resize()}};gws.classes.view.prototype.world2windowX=function(e){return e*this.element.offsetWidth/this.width};gws.classes.view.prototype.world2windowY=function(e){return e*this.element.offsetHeight/this.height};gws.classes.view.prototype.window2worldX=function(e){return e*this.width/this.element.offsetWidth};gws.classes.view.prototype.window2worldY=function(e){return e*this.height/this.element.offsetHeight};gws.classes.view.prototype.query=function(bQ,e){};gws.classes.view.prototype.getElementPosition=function(){var bQ=this.element,bR="",e=0,bS=0;while(bQ&&(typeof(bQ)=="object")&&(typeof(bQ.tagName)!="undefined")){bS+=bQ.offsetTop;e+=bQ.offsetLeft;bR=bQ.tagName.toUpperCase();if(bR=="BODY"){bQ=0}if(typeof(bQ)=="object"){if(typeof(bQ.offsetParent)=="object"){bQ=bQ.offsetParent}}}return{x:e,y:bS}};gws.classes.view.prototype.prepareAssets=function(){var e=new Image();e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAA1JREFUGFdj+P//PwMACPwC/ohfBuAAAAAASUVORK5CYII=";this.assets.setImageName(e,"blank");this.assets.createSpriteSheet("tiles","i/tiles12.png",5,7);this.assets.setImageName(this.assets.images["tiles-0_0"],"floor-1");this.assets.setImageName(this.assets.images["tiles-1_0"],"floor-2");this.assets.setImageName(this.assets.images["tiles-2_0"],"floor-3");this.assets.setImageName(this.assets.images["tiles-3_0"],"floor-4");this.assets.setImageName(this.assets.images["tiles-4_0"],"floor-5");this.assets.setImageName(this.assets.images["tiles-0_1"],"wall-1");this.assets.setImageName(this.assets.images["tiles-1_1"],"wall-2");this.assets.setImageName(this.assets.images["tiles-2_1"],"wall-3");this.assets.setImageName(this.assets.images["tiles-3_1"],"wall-4");this.assets.setImageName(this.assets.images["tiles-4_1"],"wall-5");this.assets.setImageName(this.assets.images["tiles-0_2"],"path-tile");this.assets.setImageName(this.assets.images["tiles-1_2"],"starting-stone-shadow");this.assets.setImageName(this.assets.images["tiles-2_2"],"starting-wall");this.assets.setImageName(this.assets.images["tiles-3_2"],"starting-bonus");this.assets.setImageName(this.assets.images["tiles-0_3"],"path-tile-dc");this.assets.setImageName(this.assets.images["tiles-1_3"],"starting-stone");this.assets.setImageName(this.assets.images["tiles-2_3"],"starting-wall-center");this.assets.setImageName(this.assets.images["tiles-0_4"],"flower-0");this.assets.setImageName(this.assets.images["tiles-1_4"],"flower-animation-1");this.assets.setImageName(this.assets.images["tiles-2_4"],"flower-animation-2");this.assets.setImageName(this.assets.images["tiles-3_4"],"flower-animation-3");this.assets.setImageName(this.assets.images["tiles-4_4"],"flower-animation-4");this.assets.setImageName(this.assets.images["tiles-0_4"],"flower-animation-5");this.assets.setImageName(this.assets.images["tiles-1_4"],"flower-animation-6");this.assets.setImageName(this.assets.images["tiles-2_4"],"flower-animation-7");this.assets.setImageName(this.assets.images["tiles-3_4"],"flower-animation-8");this.assets.setImageName(this.assets.images["tiles-4_5"],"flower-1");this.assets.setImageName(this.assets.images["tiles-0_6"],"flower-2");this.assets.setImageName(this.assets.images["tiles-1_6"],"flower-3");this.assets.setImageName(this.assets.images["tiles-2_6"],"flower-4");this.assets.setImageName(this.assets.images["tiles-3_6"],"flower-5");this.assets.setImageName(this.assets.images["tiles-4_6"],"flower-6");this.assets.createSpriteSheet("jewelry","i/tile-jewelry2.png",3,1);this.assets.setImageName(this.assets.images["jewelry-0_0"],"jewel-flower");this.assets.setImageName(this.assets.images["jewelry-1_0"],"jewel-hex");this.assets.setImageName(this.assets.images["jewelry-2_0"],"jewel-lock")};gws.classes.view.prototype.prepareView=function(bU,bT,bQ){var bS=null,bW=null,bV=gws.createElement(this.parentElement,"div","","swap"),e=gws.createElement(bV,"canvas","","queue"),bR=gws.createElement(this.parentElement,"div","","swap-over");this.animationLayer=this.addLayer();bV.setAttribute("title","Za zamjenu pritisnite Z ili desnu tipku miša.");e.setAttribute("width",180);e.setAttribute("height",180);gws.createElement(bV,"div","swap-text").innerHTML="Zamijeni";gws.createElement(bR,"div","swap-text").innerHTML="Zamijeni";bW=gws.createElement(this.parentElement,"div","rotate-button left","left-controller");bS=gws.createElement(this.parentElement,"div","rotate-button right","right-controller");bU.createSpriteSheet("rotate","i/rotate-buttons.png",2,1);bW.appendChild(bU.getTile("rotate",0,0));bS.appendChild(bU.getTile("rotate",1,0));gws.enableInput({placers:[this.animationLayer.canvas],swappers:[bR],lefts:[bW],rights:[bS]},bQ)};gws.classes.view.prototype.animateScore=function(bR,b0,bZ,bS,bU,bQ){var bX=Math.floor(Math.random()*2+1),b3=parseFloat(gws.body.style.fontSize||"10"),b1=((Math.random()*10+35)*b3)/200,bW=((Math.random()*10+35)*b3)/200,b2=this,bT=gws.createElement(gws.bodyClip,"div","moving-score"),bV=(gws.browser.css3dTransforms?" translateZ(0)":""),bY=function(b5){var b4=bT.style,b6=b5+bV;b4.webkitTransform=b6;b4.mozTransform=b6;b4.msTransform=b6;b4.OTransform=b6;b4.transform=b6},e=function(b7,b6){var b4=false,b5=function(b8){if(!b4){b4=true;b7(b8)}};bT.addEventListener("webkitTransitionEnd",b5,false);bT.addEventListener("msTransitionEnd",b5,false);bT.addEventListener("OTransitionEnd",b5,false);bT.addEventListener("transitionend",b5,false);setTimeout(b5,b6||1050)};bY("translate(-200px, -200px)");bT.innerHTML="+"+bR;if(an!=1){bT.style.color=bS}setTimeout(function(){bY("translate("+b0+"px, "+bZ+"px)");setTimeout(function(){if(gws.browser.transitions){bT.className="moving-score transform-1s-transition";bY("translate("+b0+"px, "+(bZ-6*b3)+"px)");e(function(){b0=b2.getScoreDestinationX();bZ=b2.getScoreDestinationY();bT.className="moving-score transform-05s-transition";bY("translate("+b0+"px, "+bZ+"px)");e(function(){if(bQ){bQ()}bT.className="explosion sparks-"+bX;if(an!=1){bT.style.color="inherit"}bY("translate("+b0+"px, "+bZ+"px) scale(0.05, 0.05)");setTimeout(function(){bT.className="explosion transform-fade-2s-transition sparks-"+bX;bY("translate("+b0+"px, "+bZ+"px) scale("+b1+", "+bW+")");bT.style.opacity="0.01";e(function(){gws.bodyClip.removeChild(bT)},2050)},20)})})}else{setTimeout(function(){if(bQ){bQ()}gws.bodyClip.removeChild(bT)},1000)}},20)},bU)};(function(){var bT=function(bU,bV){bV=bV||l;switch(bU){case -1:return 0;case 0:return(bV*-0.5);case 1:return(bV*0.5);case 2:return(bV*1.25);case 3:return(bV*1.75);case 4:return(bV*1.75);case 5:return(bV*1.25);case 6:return(bV*0.5);case 7:return(bV*-0.5);case 8:return(bV*-1.25);case 9:return(bV*-1.75);case 10:return(bV*-1.75);case 11:return(bV*-1.25)}return bR(bU%12,bV)},bS=function(bU,bV){bV=bV||j;switch(bU){case -1:return 0;case 0:return(bV*-1);case 1:return(bV*-1);case 2:return(bV*-0.75);case 3:return(bV*-0.25);case 4:return(bV*0.25);case 5:return(bV*0.75);case 6:return(bV*1);case 7:return(bV*1);case 8:return(bV*0.75);case 9:return(bV*0.25);case 10:return(bV*-0.25);case 11:return(bV*-0.75)}return bQ(bU%12,bV)},bR=function(bU,bV){bV=bV||l;switch(bU){case -1:return 0;case 0:return(bV*-0.5);case 1:return(bV*0.5);case 2:return(bV*0.5);case 3:return(bV*1);case 4:return(bV*1);case 5:return(bV*0.5);case 6:return(bV*0.5);case 7:return(bV*-0.5);case 8:return(bV*-0.5);case 9:return(bV*-1);case 10:return(bV*-1);case 11:return(bV*-0.5)}},bQ=function(bU,bV){bV=bV||j;switch(bU){case -1:return 0;case 0:return(bV*-0.5);case 1:return(bV*-0.5);case 2:return(bV*-0.5);case 3:return(bV*0);case 4:return(bV*0);case 5:return(bV*0.5);case 6:return(bV*0.5);case 7:return(bV*0.5);case 8:return(bV*0.5);case 9:return(bV*0);case 10:return(bV*0);case 11:return(bV*-0.5)}},e=function(bV){var bU=bV,bX=bU.point1,bW=bU.point2;bU.points=[{x:bT(bX),y:bS(bX)},{x:bT(bW),y:bS(bW)}];bU.bezier=[{x:bR(bX),y:bQ(bX)},{x:bR(bW),y:bQ(bW)}];return bU};gws.classes=gws.classes||{};gws.classes.polygonTileView=function(bW){var bV=bW||{},bU=bV.reference||false;this.parent=bV.parent;this.context=bV.context;this.width=bV.width;this.height=bV.height;this.reference=bU;this.cacheString="";this.cachedImage=document.createElement("canvas");this.cachedImage.width=l*4;this.cachedImage.height=ay;this.cacheContext=this.cachedImage.getContext("2d")};gws.classes.polygonTileView.prototype.render=function(){var b4=this.reference.x+this.parent.x,b1=this.reference.y+this.parent.y,b3=this,bV=this.reference.colors,bW=this.reference.pairs,bY=0,b2=0,bU=bV.toString()+bW.toString()+this.world2windowX(1)+this.reference.frame+this.reference.animate+aE,b0=l*2,bZ=j,b5=function(){b3.paint({x:b4,y:b1,width:l*4,height:ay,image:b3.cachedImage})};if(bU==this.cacheString){bU=true}else{this.cacheString=bU;b3.cachedImage.width=this.world2windowX(l*4);b3.cachedImage.height=this.world2windowX(ay);bU=false}switch(this.reference.sTileType){case"start-empty":if(!bU){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("starting-stone-shadow")});for(bY in bV){if(bV[bY]!="gray"){b3.strokePath(b3.tracePath(e({cache:true,x:b0,y:bZ,point1:+bY,point2:-1,color1:bV[bY]})))}}b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("starting-stone")})}b5();break;case"start-wall":if(!bU){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("starting-wall")});for(bY in bV){if(bV[bY]!="gray"){b3.strokePath(b3.tracePath(e({cache:true,x:b0,y:bZ,point1:+bY,point2:-1,color1:bV[bY]})))}}b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("starting-wall-center")})}b5();break;case"start-bonus":if(!bU){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("starting-bonus")});for(bY=0;bY<12;bY+=2){b3.strokePath(b3.tracePath(e({cache:true,x:b0,y:bZ,point1:bW[+bY],point2:bW[+bY+1],color1:bV[bW[+bY]],color2:bV[bW[+bY+1]],border:"#000000",fade:true})))}}b5();break;case"wall":if(!bU){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("wall-"+((Math.abs(this.reference.x+this.reference.y)%5)+1))})}b5();break;case"bonus":if(!bU){if(this.reference.eBonus===this.reference.eBonusType.POINTS){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("starting-bonus")});for(bY=0;bY<12;bY+=2){b3.strokePath(b3.tracePath(e({cache:true,x:b0,y:bZ,point1:bW[+bY],point2:bW[+bY+1],color1:bV[bW[+bY]],color2:bV[bW[+bY+1]],border:"#000000",fade:true})))}}else{if(this.reference.animate){this.reference.frame+=this.reference.animate;if(this.reference.frame<=0){this.reference.frame=0;this.reference.animate=0}else{if(this.reference.frame>this.reference.numberOfFrames){this.reference.frame=this.reference.numberOfFrames-1;this.reference.animate=0}else{b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("flower-animation-"+this.reference.frame)})}}}if(!this.reference.animate){b2=(6-this.reference.pairsMatching("gray"));if(b2>0){this.drawShadow({x:b4,y:b1,width:l*4,height:ay})}b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage("flower-"+b2)})}for(bY=0;bY<12;bY+=2){b3.strokePath(b3.tracePath(e({cache:true,x:b0,y:bZ,point1:bW[+bY],point2:bW[+bY+1],color1:bV[bW[+bY]],color2:bV[bW[+bY+1]],border:-1})))}if(this.reference.showJewelry){if(this.reference.bTileBonusIcon){this.drawJewelry({cache:true,x:b0,y:bZ,image:"jewel-hex"})}else{this.drawJewelry({cache:true,x:b0,y:bZ,image:"jewel-lock"})}}}}b5();break;case"turnstile":break;case"empty":if(!bU){var bX=false;absX=0,absY=0;if(this.parent.tileSheet===1){absX=Math.abs(this.reference.x);absY=Math.abs(this.reference.y);if((absX<=az)&&(absY<=ay)){bX="floor-3"}else{if((absX<=az*2)&&(absY<=ay*1.9)){bX="floor-"+((Math.abs(this.reference.x+this.reference.y)%2)+4)}}}else{bX="floor-"+((Math.abs(this.reference.x+this.reference.y)%3)+1)}if(bX){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage(bX)})}if(this.parent.tileSheet===1){b3.stroke(b3.traceHexagon({cache:true,x:b0,y:bZ,width:l*4,height:ay,lineWidth:5,color:"#adab93",opacity:Math.max(1-gws.cartesianToPolar({x:this.reference.x,y:this.reference.y}).m/(az*6),0.001)}))}}b5();break;default:if(!bU){b3.paint({cache:true,x:b0,y:bZ,width:l*4,height:ay,image:gws.assets.getImage((gws.currentGame&&gws.currentGame.timeleft)?"path-tile-dc":"path-tile")});for(bY=0;bY<12;bY+=2){b3.strokePath(b3.tracePath(e({cache:true,x:b0,y:bZ,point1:bW[+bY],point2:bW[+bY+1],color1:bV[bW[+bY]],color2:bV[bW[+bY+1]]})))}}b5();break}};gws.classes.polygonTileView.prototype.world2windowX=function(bU){return bU*this.parent.scale*this.parent.viewScale};gws.classes.polygonTileView.prototype.world2windowY=function(bU){return bU*this.parent.scale*this.parent.viewScale};gws.classes.polygonTileView.prototype.stroke=function(bY){var bX=bY,bV=this.world2windowX(bX.lineWidth||1),bW=bX.color,bZ=bX.opacity||1,bU=bX.cache?this.cacheContext:this.context,b0=0;bU.strokeStyle=bW;bU.lineWidth=bV;if(bZ===1){bU.stroke()}else{b0=bU.globalAlpha;bU.globalAlpha=bZ;bU.stroke();bU.globalAlpha=b0}};gws.classes.polygonTileView.prototype.fill=function(bX){var bW=bX,bV=bW.color,bY=bW.opacity||1,bU=bW.cache?this.cacheContext:this.context,bZ=0;bU.fillStyle=bV;if(bY===1){bU.fill()}else{bZ=bU.globalAlpha;bU.globalAlpha=bY;bU.fill();bU.globalAlpha=bZ}};gws.classes.polygonTileView.prototype.paint=function(bX){var b0=bX,bZ=b0.opacity||1,b5=b0.cache?this.cacheContext:this.context,b2=this.world2windowX(b0.x),b1=this.world2windowY(b0.y),bU=this.world2windowX(b0.width),b4=this.world2windowY(b0.height),bV=b0.image,b3=b2-bU/2,bY=b1-b4/2,bW=0;if(bZ===1){b5.drawImage(bV,b3,bY,bU,b4)}else{bW=b5.globalAlpha;b5.globalAlpha=bZ;b5.drawImage(bV,b3,bY,bU,b4);b5.globalAlpha=bW}};gws.classes.polygonTileView.prototype.tracePath=function(b0){var b2=b0,b6=b2.cache?this.cacheContext:this.context,b5=b2.points,bX=this.world2windowX(b2.x+b5[0].x),b4=this.world2windowY(b2.y+b5[0].y),bW=this.world2windowX(b2.x+b5[1].x),b3=this.world2windowY(b2.y+b5[1].y),bY=b2.bezier||false,b1=0,bV=0,bZ=0,bU=0;b6.beginPath();b6.moveTo(bX,b4);if(bY){b1=this.world2windowX(b2.x+bY[0].x);bV=this.world2windowY(b2.y+bY[0].y);bZ=this.world2windowX(b2.x+bY[1].x);bU=this.world2windowY(b2.y+bY[1].y);b6.bezierCurveTo(b1,bV,bZ,bU,bW,b3)}else{b6.lineTo(bW,b3)}b0.x1=bX;b0.y1=b4;b0.x2=bW;b0.y2=b3;return b0};gws.classes.polygonTileView.prototype.strokePath=function(bX){var bZ=bX,bW=bZ.color||bZ.color1,b4=bZ.color1||bZ.color,b3=bZ.color2||bZ.color,bY=bZ.opacity||1,b6=bZ.cache?this.cacheContext:this.context,b2=this.world2windowX(bZ.x),b0=this.world2windowY(bZ.y),bV=bZ.border||false,bU=bZ.fade,b1=false;if((b4=="gray")&&aE){return false}else{if(bV!=-1){if(!bV){if(bW=="gray"){if(gws.currentGame&&gws.currentGame.timeleft){bV="#ffe080"}else{bV="#ffffff"}}else{bV="#000000"}}if(bU){b1=b6.createRadialGradient(b2,b0,this.world2windowY(l),b2,b0,this.world2windowY(j));b1.addColorStop(0,m(bV,0.5));b1.addColorStop(1,bV);bV=b1}this.stroke({cache:bZ.cache,lineWidth:aE?36:22,color:bV,opacity:bY})}var b5=bU?"#ffe776":((gws.currentGame&&gws.currentGame.timeleft)?"#ab7f2e":"#786c44");if(b4=="gray"){b4=b5}if(b3=="gray"){b3=b5}if((!b3)||(b4==b3)){if(bU){b1=b6.createRadialGradient(b2,b0,this.world2windowY(l),b2,b0,this.world2windowY(j));b1.addColorStop(0,m(b4,0.25));b1.addColorStop(1,b4);bW=b1}else{if(bV==-1){b1=b6.createRadialGradient(b2,b0,this.world2windowY(l),b2,b0,this.world2windowY(j));b1.addColorStop(0,m(b4,0));b1.addColorStop(0.5,b4);bW=b1}else{bW=b4}}}else{b1=b6.createLinearGradient(bZ.x1,bZ.y1,bZ.x2,bZ.y2);if(bU){b1.addColorStop(0,b4);b1.addColorStop(0.2,m(b4,0.25));b1.addColorStop(0.8,m(b3,0.25));b1.addColorStop(1,b3)}else{if(bV==-1){b1.addColorStop(0,b4);b1.addColorStop(0.2,m(b4,0));b1.addColorStop(0.8,m(b3,0));b1.addColorStop(1,b3)}else{b1.addColorStop(0.1,b4);b1.addColorStop(0.9,b3)}}bW=b1}this.stroke({cache:bZ.cache,lineWidth:aE?28:14,color:bW,opacity:bY})}};gws.classes.polygonTileView.prototype.traceHexagon=function(bV){var bX=bV,bZ=this.world2windowX(bX.x),bY=this.world2windowY(bX.y),bU=this.world2windowX(bX.width),b1=this.world2windowY(bX.height),b2=bX.cache?this.cacheContext:this.context,b0=bU/4,bW=b1/2;b2.beginPath();b2.moveTo(bZ-b0,bY-bW);b2.lineTo(bZ+b0,bY-bW);b2.lineTo(bZ+2*b0,bY);b2.lineTo(bZ+b0,bY+bW);b2.lineTo(bZ-b0,bY+bW);b2.lineTo(bZ-2*b0,bY);b2.lineTo(bZ-b0,bY-bW);b2.closePath();return bV};gws.classes.polygonTileView.prototype.drawShadow=function(bZ){var bY=bZ,bX=bY.cache?this.cacheContext:this.context,bV=this.world2windowX(bY.x),b1=this.world2windowY(bY.y),b0=this.world2windowX(bY.width),bU=this.world2windowY(bY.height),bW=bV-b0/2;bX.drawImage(gws.assets.getImage("i/bonus-tile-shadow.png"),bW,b1,b0,bU*2/3)};gws.classes.polygonTileView.prototype.drawJewelry=function(bY){var bX=bY,bW=bX.cache?this.cacheContext:this.context,bV=this.world2windowX(bX.x),b1=this.world2windowY(bX.y),bZ=this.world2windowX(112),bU=this.world2windowY(120),b0=bX.image;bW.drawImage(gws.assets.getImage(b0),bV,b1,bZ,bU)}})();gws.windows={mobile:false};gws.windows.currentWinner=new function(){this.hide=function(){document.getElementById("current-winner").style.display="none"};this.show=function(bQ,e){document.getElementById("current-winner").innerHTML='<div id="current-winner-text">Aktualni pobjednik</div><div class="team-score" style="color: #FFDF82;">'+bQ+'</div><div class="team-score" style="color: #FFDF82;">Ostalo vremena -  '+e+"</div>";document.getElementById("current-winner").style.display="block"}};var c=["game"];function bl(e){if(e){if(e=="menu"||e=="game"||e=="game-over"){c=[e]}else{if(c[c.length-1]!=e){c.push(e)}}}else{switch(c[c.length-1]){case"game":break;case"game-over":f();break;case"menu":ac();break;case"side-menu":gws.sideMenu.show();gws.controlBar.showMenuButton();break;case"expansion":ac("expansion");break;case"multiplayer":ac("multiplayer");break;case"buy-page":gws.buyPage.show();break}}}function bI(){c.pop()}function f(){gws.playAgain.show()}function ah(){gws.playAgain.hide()}function bx(){document.getElementById("swap").style.bottom="0";document.getElementById("swap-over").style.bottom="0"}function aR(){document.getElementById("swap").style.bottom="-21em";document.getElementById("swap-over").style.bottom="-21em"}(function(bS){var bR=null,bT=document.createElement("div"),bQ=document.createElement("div"),bU=null,bV=function(bW){bS.hideDialog();bl();bW.preventDefault();return false},e=function(bX,bY,bZ){var b3=0,b0=null,bW=document.createElement("div"),b2=document.createElement("div"),b4=document.createElement("div"),b1=document.createElement("div");bW.innerHTML=bX;bW.appendChild(b2);bW.appendChild(b4);b2.className="dialog-menu "+bY;b4.appendChild(b1);b1.className="dialog-menu "+bY;for(;b3<bZ.length;b3++){b2.innerHTML+='<div class="main-button-fake"><span class="main-button-text">'+bZ[b3].text+"</span></div>";b0=document.createElement("a");b0.className="main-button-real";b0.innerHTML='<span class="main-button-text">'+bZ[b3].text+"</span>";b0.addEventListener("click",bZ[b3].func,false);b1.appendChild(b0)}return bW};bS.CONFIRM_END=e('<div class="are-you-sure-text">Jeste li sigurni da želite zatvoriti igru?</div>',"are-you-sure-dialog-menu",[{text:"Da",func:function(){ac();gws.hideDialog()}},{text:"Ne",func:function(){gws.hideDialog();bl()}}]);bS.CONFIRM_NEW=e('<div class="are-you-sure-text">Jeste li sigurni da želite zatvoriti igru?</div>',"are-you-sure-dialog-menu",[{text:"Da",func:function(){gws.storage.remove("currentGame");bF(r);gws.hideDialog()}},{text:"Ne",func:function(){gws.hideDialog();bl()}}]);bS.SUBMIT_SCORE=e('<span class="submit-score-text">Želite poslati svoj rezultat?</span><br /><br /><br /><br /><span id="submit-score-small-text">(Provjera autentičnosti pomoću Google Računa.)</span>',"submit-score-dialog-menu",[{text:"Da",func:function(){gws.account.beginSignIn(I)}},{text:"Ne",func:function(){gws.hideDialog();a7(true)}}]);bS.LOW_SCORE=e("<br /><br /><br /><br />","submit-score-dialog-menu",[{text:"U redu",func:function(){gws.hideDialog();f()}},{text:"Najbolji rezultati",func:function(){gws.hideDialog();gws.scoreboard.show(r)}}]);bS.NAME_PICKER=e('<span id="name-chooser-text">Odaberite si ime:</span><div class="name-chooser-chooser" id="adj1"></div><div class="name-chooser-chooser" id="adj2"></div><div class="name-chooser-chooser" id="noun"></div>',"name-chooser-dialog-menu",[{text:"U redu",func:function(){bm();gws.hideDialog()}},{text:"Odustani",func:function(){gws.hideDialog();bt(false)}}]);bS.ABOUT_GW=e('<a href="http://gopherwoodstudios.com/"><img id="about-gopherwood" src="i/credits-gw.png" alt="Gopherwood Studios" /></a><img class="about-line" src="i/bar-horizontal.png" /><a href="http://jasonpastrana.com/"><img id="about-jp" src="i/credits-jp.png" alt="Jason Pastrana" /></a><img class="about-line" src="i/bar-horizontal.png" /><img id="about-omni" src="i/credits-oa.png" alt="Omni Audio" />',"about-dialog-menu",[{text:"Blog",func:function(){gws.loadURL("http://blog.gopherwoodstudios.com/search/label/entanglement")}}]);bS.LOGIN_FOR_PURCHASE=e('<span id="login-purchase-text">Da biste dodali prošireni set Sakura Grove na svoj račun, prijavite se na račun koji želite povezati s ovim proširenim setom.</span><br /><br /><br /><br /><span id="login-purchase-small-text">Kupnje su vezane uz vaš Google Račun.</span>',"login-purchase-dialog-menu",[{text:"Prijava",func:function(){gws.account.beginSignIn(function(bW){gws.confirmPurchase()})}},{text:"Odustani",func:function(){gws.hideDialog()}}]);if(window.chrome&&chrome.app&&chrome.app.runtime){bS.YOUTUBE_INSTRUCTIONS=e("<webview title='YouTube video player' class='youtube-player' type='text/html' src='http://www.youtube.com/embed/0gBuNknaj-4?rel=0' frameborder='0'></webview><img id='youtube-bar' src='i/bar-horizontal.png' />","youtube-instructions-dialog-menu",[{text:"U redu",func:function(){gws.hideDialog();bl()}}])}else{bS.YOUTUBE_INSTRUCTIONS=e("<iframe title='YouTube video player' class='youtube-player' type='text/html' src='http://www.youtube.com/embed/0gBuNknaj-4?rel=0' frameborder='0'></iframe><img id='youtube-bar' src='i/bar-horizontal.png' />","youtube-instructions-dialog-menu",[{text:"U redu",func:function(){gws.hideDialog();bl()}}])}bS.showDialog=function(bY,bX,bW){if(!bR){bR=document.createElement("div");bR.setAttribute("id","dialog");bQ.className="return";bQ.addEventListener("touchend",bV,false);bQ.addEventListener("mouseup",bV,false);bR.appendChild(bQ);bT.setAttribute("id","dialog-content");bR.appendChild(bT);gws.bodyClip.appendChild(bR)}clearTimeout(bU);if(bX){bT.style.background="url(i/expansion-box.png) center center no-repeat"}else{bT.style.background="transparent"}if(typeof bY==="string"){bT.innerHTML=bY}else{bT.innerHTML="";bT.appendChild(bY)}if(bW){bT.style.overflow="auto"}else{bT.style.overflow="visible"}bR.style.display="block";bR.style.opacity="0";bU=setTimeout(function(){bR.style.opacity="1"},1);bS.audio.play("WindowOpen")};bS.hideDialog=function(){if(bR){clearTimeout(bU);bU=setTimeout(function(){bR.style.display="none";bT.innerHTML=""},1000);bR.style.opacity="0";bS.audio.play("WindowClose")}}})(gws);function ac(e){gws.mainMenu.show(e)}function N(e){gws.mainMenu.hide({removeBG:e})}function ax(){setTimeout(function(){document.getElementById("main-menu-background").style.display="none"},1000);document.getElementById("main-menu-background").style.opacity="0"}(function(bS){var bR={showing:false},bT=null,e=null,bQ=null,bU=function(){var b0=function(cg){var ch=document.createElement("div");ch.className=cg;return ch},bW=b0("scoreboard"),b6=b0("return scoreboard-x"),cc=document.createElement("a"),b4=b0("scoreboard-container"),bX=b0("scoreboard-button"),b5=b0("scoreboard-button"),ce=b0("scoreboard-title"),bZ=b0("selectors"),b2=b0("med-button"),bY=document.createElement("a"),bV=document.createElement("div"),b9=document.createElement("div"),cd=document.createElement("div"),b1=b0("hs-header"),cf=b0("hs-header"),b8=b0("hs-header");bW.id="scoreboard";bW.appendChild(ce);cc.addEventListener("click",function(cg){bR.hide();bl();if(c[c.length-1]=="game-over"){gws.controlBar.showMenuButton()}},false);b6.appendChild(cc);bW.appendChild(b6);b2.id="scoreboard-ad";b2.innerHTML=bY.innerHTML="Kupite sad";bY.addEventListener("click",function(cg){bR.hide();bl();if(c[c.length-1]=="game-over"){gws.controlBar.showMenuButton()}gws.buyPage.show()},false);b2.appendChild(bY);bZ.appendChild(b2);bV.id="scoreboard-mode";bV.innerHTML="Način";bZ.appendChild(bV);b9.id="game-mode";bZ.appendChild(b9);cd.id="global-toggle";bZ.appendChild(cd);b1.id="hs-place";b1.innerHTML="<span>#</span>";bZ.appendChild(b1);cf.id="hs-name";cf.innerHTML="<span>Ime</span>";bZ.appendChild(cf);b8.id="hs-score";b8.innerHTML="<span>Rezultat</span>";bZ.appendChild(b8);bW.appendChild(bZ);bW.appendChild(b4);bX.id="scoreboard-replay-button";bX.addEventListener("click",function(cg){gws.playAgain.playAgainButtonFunction()},false);bX.appendChild(b0("scoreboard-button-bg-default"));bX.appendChild(b0("scoreboard-button-icon-replay-default"));bX.appendChild(b0("scoreboard-button-bg-hover"));bX.appendChild(b0("scoreboard-button-icon-replay-hover"));bW.appendChild(bX);b5.id="scoreboard-maps-button";b5.addEventListener("click",function(cg){gws.playAgain.mapChangeButtonFunction()},false);b5.appendChild(b0("scoreboard-button-bg-default"));b5.appendChild(b0("scoreboard-button-icon-maps-default"));b5.appendChild(b0("scoreboard-button-bg-hover"));b5.appendChild(b0("scoreboard-button-icon-maps-hover"));bW.appendChild(b5);gws.bodyClip.appendChild(bW);var b3=[];var ca=[];var cb=gws.vars.view.leaderboard.maps;for(var b7 in cb){b3.push(cb[b7].text);ca.push([cb[b7].gameId,0])}bQ=new bH(b9,b3,ca,function(cg){if((!W)&&(cg[1][0]==27)){W=true;highScoreBreadth=new bH(cd,["Prije 2 dana".replace("2","6"),"Prije 2 dana".replace("2","5"),"Prije 2 dana".replace("2","4"),"Prije 2 dana".replace("2","3"),"Prije 2 dana".replace("2","2"),"Prije 2 dana".replace("2","1"),"Današnji rezultati"],[6,5,4,3,2,1,0],function(ch){bC(ch[1])},6-aL)}else{if(W&&(!(cg[1][0]==27))){W=false;highScoreBreadth=new bH(cd,["Osobni rezultati","Današnji rezultati","Ovotjedni rezultati","Rezultati svih vremena"],[0,1,2,3],function(ch){bC(ch[1])},bB)}}af(cg[1][0],cg[1][1])});highScoreBreadth=new bH(cd,["Osobni rezultati","Današnji rezultati","Ovotjedni rezultati","Rezultati svih vremena"],[0,1,2,3],function(cg){bC(cg[1])},bB);return{scoreboard:bW,title:ce,container:b4,replayButton:bX,menuButton:b5,selectors:bZ}};bR.show=function(bY,bW){var bX=gws.storage.get("triedTrial"),bV=gws.storage.get("gamesPlayed");bR.showing=true;gws.hideDialog();gws.controlBar.hideMenuButton();if(!bT){bT=bU()}if((bY==="results")&&(gws.currentGame.players.length>1)){bT.title.innerHTML="Rezultati";bT.selectors.style.display="none";bT.container.innerHTML='<div id="scoreboard-content" class="scoreboard-content">'+u()+"</div>"}else{if(bY==="results"){bY=gws.currentGame.id}bT.title.innerHTML="Najbolji rezultati";bT.selectors.style.display="block";bT.container.innerHTML='<div id="scoreboard-content2" class="scoreboard-content"><div id="scoreboard-table"></div></div>';gws.highScoreTable=gws.createElement(document.getElementById("scoreboard-table"),"div","scroll-table");gws.highScoreTable.innerHTML='<br /><br /><div class="scoreboard-error">Učitavanje...</div>';bQ.setSelectionByValue(bY)}if(c!="game-over"){bT.replayButton.style.display="none";bT.menuButton.style.display="none"}else{bT.replayButton.style.display="block";bT.menuButton.style.display="block"}bT.scoreboard.style.display="block";bT.scoreboard.style.opacity="0";setTimeout(function(){bT.scoreboard.style.opacity="1"},10);gws.audio.play("WindowOpen")};bR.hide=function(){if(bR.showing){bR.showing=false;setTimeout(function(){bT.scoreboard.style.display="none"},1000);bT.scoreboard.style.opacity="0";gws.audio.play("WindowClose");if(e){e();e=null}}};bS.scoreboard=bR})(gws);function B(){gws.sideMenu.hide()}function al(e){gws.sideMenu.show()}function aN(){if((+bn.width>(+bn.height*1.5))&&(+bn.width>1024)){al("side-menu")}else{B()}}function M(){document.getElementById("title").style.top="-60px"}function bo(){document.getElementById("title").style.top="5px"}function ar(bQ){for(var e=0;e<5;e++){document.getElementById("icon"+e).style.opacity="0.01"}document.getElementById(bQ).style.opacity="1"}var bL=0;var d=[];gws.windows.showScores=function(){var bQ="";var e=0;if(U){d=aW.slice()}for(e in d){if(d.length!=1){bQ+='<div class="team-score" style="color: '+d[e].color+'">'+d[e].team+" "+d[e].score;if(+e==+aY){bQ+=" &laquo;";bL=d[e].score}bQ+="</div>"}else{bQ+='<div class="team-score">Rekord '+d[e].highScore+"</div>";if(!this.mobile){bQ+='<div class="team-score">Trenutni put '+d[e].segments+"</div>";bQ+='<div class="team-score">Najdulji put '+d[e].highSegments+"</div>"}}}bQ='<div id="score-title">Rezultat |</div> <div id="single-score" style="text-shadow: 0px 0px '+bb+'px #ffffbe;">'+bL+"</div>"+bQ;if(document.getElementById("inner-scores").innerHTML!=bQ){document.getElementById("inner-scores").innerHTML=bQ;document.getElementById("scores").style.top="0"}};function X(){document.getElementById("scores").style.top="-500px"}function q(bR,bS,bW,bT,bV){var e=parseInt(bn.scale*ay*(window.devicePixelRatio||1));bR.render();var bQ=bn.context;var bU=parseInt(e*0.6);if(bS>9){bU=parseInt(e*0.5)}if(bS>99){bU=parseInt(e*0.3)}bQ.textAlign="center";bQ.textBaseline="middle";bQ.font=bU+"px Fontin-SmallCaps";bQ.fillStyle=bT;if(an==1){bQ.fillStyle="#ffffdd"}bQ.shadowOffsetX=0;bQ.shadowOffsetY=0;if(!bV){bV=0.15}bQ.shadowBlur=bU*bV;bQ.shadowColor=bQ.fillStyle;bQ.fillText(bS,bR.windowX()*bn.viewScale,bR.windowY()*bn.viewScale-(e*0.08));bU=parseInt(e*0.1);bQ.font=bU+"px Fontin-SmallCaps";bQ.fillText(bW,bR.windowX()*bn.viewScale,bR.windowY()*bn.viewScale+(e*0.2));bQ.shadowColor="transparent"}gws.background={images:[],repositionImage:function(bS,bT,bQ,bR){var e="em";if(this.images[bS]){this.images[bS].style[bR]=Math.min(bQ+bT,0)+e}},reposition:function(){var bR=true,bS=this.images.bgGlow?this.images.bgGlow.style:false;if(gws.currentGame&&gws.currentGame.limitedTiles){bR=false;if(bS&&(bS.opacity!="0.5")){bS.opacity="0.5"}}else{if(bS&&(bS.opacity!="0.75")){bS.opacity="0.75"}}var bQ=((bn.width)-((bn.softRight-bn.softLeft+2*l)*bn.scale))/20;var e=((bn.height)-((bn.softBottom-bn.softTop+2*j)*bn.scale))/20;this.repositionImage("bgTL1",-30,bR?bQ:0,"left");this.repositionImage("bgL",-25,bR?bQ:0,"left");this.repositionImage("bgTL2",-21.8,bR?bQ:0,"left");this.repositionImage("bgTR1",-42.7,bR?bQ:0,"right");this.repositionImage("bgTR2",-36.4,bR?bQ:0,"right");this.repositionImage("bgBL",-40.9,bR?bQ:0,"left");this.repositionImage("bgSBR",-40.9,bQ,"right");this.repositionImage("bgSBL",-40.9,bR?0:bQ,"left");this.repositionImage("bgSTR",-40.9,bR?0:bQ,"right");this.repositionImage("bgSTL",-40.9,bR?0:bQ,"left");this.repositionImage("bgT",-8.2,bR?e:0,"top");this.repositionImage("bgTR3",-26.4,bR?0:26.4,"right");this.repositionImage("bgTL3",-35.6,bR?0:35.6,"left")}};aQ.components={}})();