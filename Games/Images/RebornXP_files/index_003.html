<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <script src="index_data_003/tinymce.min.js"></script>
        
    <link rel="stylesheet" type="text/css" id="mce-u0" href="https://rebornxp.js.org/html/msword/tinymce/skins/ui/oxide/skin.min.css"></head>
    <body>
        <textarea name="" id="tinymce-textarea" style="position: absolute; inset: 0px; display: none;" aria-hidden="true"></textarea><div role="application" class="tox tox-tinymce" style="visibility: hidden; height: 400px;" aria-disabled="false"><div class="tox-editor-container"><div data-alloy-vertical-dir="toptobottom" tabindex="-1" class="tox-editor-header"><div style="display:none;" class="tox-promotion"><a href="https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&amp;utm_medium=SPAP&amp;utm_campaign=SPAP&amp;utm_id=editorreferral" rel="noopener" target="_blank" aria-hidden="true" class="tox-promotion-link">⚡️Upgrade</a></div><div role="menubar" data-alloy-tabstop="true" class="tox-menubar"></div><div role="group" class="tox-toolbar-overlord" aria-disabled="false"><div role="group" class="tox-toolbar__primary"></div><div role="group" class="tox-toolbar__overflow tox-toolbar__overflow--closed" style="height: 0px;"></div></div><div class="tox-anchorbar"></div></div><div class="tox-sidebar-wrap"><div class="tox-edit-area"><iframe id="tinymce-textarea_ifr" frameborder="0" allowtransparency="true" title="Rich Text Area" class="tox-edit-area__iframe"></iframe></div><div role="complementary" class="tox-sidebar"><div data-alloy-tabstop="true" tabindex="-1" class="tox-sidebar__slider tox-sidebar--sliding-closed" style="width: 0px;"></div></div></div><div class="tox-statusbar"><div class="tox-statusbar__text-container"><div role="navigation" data-alloy-tabstop="true" class="tox-statusbar__path" aria-disabled="false"></div><button type="button" tabindex="-1" data-alloy-tabstop="true" class="tox-statusbar__wordcount"></button><span style="display:none;" class="tox-statusbar__branding"><a href="https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v6" rel="noopener" target="_blank" aria-label="Powered by Tiny" tabindex="-1"><svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"></path>
</svg></a></span></div><div title="Resize" data-alloy-tabstop="true" tabindex="-1" class="tox-statusbar__resize-handle"><svg width="10" height="10" focusable="false"><g fill-rule="nonzero"><path d="M8.1 1.1A.5.5 0 1 1 9 2l-7 7A.5.5 0 1 1 1 8l7-7ZM8.1 5.1A.5.5 0 1 1 9 6l-3 3A.5.5 0 1 1 5 8l3-3Z"></path></g></svg></div></div></div><div aria-hidden="true" class="tox-view-wrap" style="display: none;"></div><div aria-hidden="true" class="tox-throbber" style="display: none;"></div></div>
        
        <script>
            
            tinymce.init({
                selector: `#tinymce-textarea`,
                setup: function (editor) {
                    setup_editor(editor);
                },
                plugins: 'preview importcss searchreplace autolink autosave directionality code visualblocks visualchars fullscreen image link table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons',
                menubar: 'file edit view insert format tools table',
                toolbar: 'undo redo | bold italic underline strikethrough | fontfamily fontsize blocks | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save | insertfile image media template link anchor | ltr rtl',
                menu: {
                    file: {title: 'File', items: 'open save save_as new print'},
                    tools: {title: 'Tools', items: 'wordcount'},
                    view: {title: 'View', items: 'visualaid visualchars visualblocks preview'}
                },
                toolbar_sticky: true,
                autosave_ask_before_unload: false,
                autosave_interval: '30s',
                autosave_prefix: '{path}{query}-{id}-',
                autosave_restore_when_empty: false,
                autosave_retention: '2m',
                image_advtab: false,
                importcss_append: true,
                file_picker_callback: async (callback, value, meta) => {
                    await file_picker_callback(callback, value, meta);
                },
                template_cdate_format: '[Date Created (CDATE): %m/%d/%Y : %H:%M:%S]',
                template_mdate_format: '[Date Modified (MDATE): %m/%d/%Y : %H:%M:%S]',
                quickbars_selection_toolbar: 'bold italic | quicklink h2 h3 blockquote quicktable',
                noneditable_class: 'mceNonEditable',
                toolbar_mode: 'sliding',
                contextmenu: 'link table',
                contextmenu_never_use_native: true,
                quickbars_insert_toolbar: '',
                content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:16px }table { border-spacing: 0; border-collapse: separate; border: 1px solid #000000;} th, td {border: 1px solid #000000;}'
            });
        </script>

        <script>
            function wait_for_elm(selector) {
                return new Promise(resolve => {
                    if (document.querySelector(selector)) {
                        return resolve(document.querySelector(selector));
                    }

                    const observer = new MutationObserver(mutations => {
                        if (document.querySelector(selector)) {
                            resolve(document.querySelector(selector));
                            observer.disconnect();
                        }
                    });

                    observer.observe(document.body, {
                        childList: true,
                        subtree: true
                    });
                });
            }

            function set_content(html){
                console.log('set content');
                tinymce.activeEditor.resetContent(html);
            }
            function get_content(){
                return tinymce.activeEditor.getContent();
            }
            function outer_html(){
                return document.querySelector('.tox-edit-area iframe').contentWindow.document.documentElement.outerHTML;
            }

            function is_dirty(){
                return tinymce.activeEditor.isDirty();
            }

            function set_dirty(bool){
                console.log('set dirty')
                tinymce.activeEditor.setDirty(bool);
            }
            function show_drawer(){
                wait_for_elm('.tox-tbtn[aria-label="More..."]')
                .then(elm => {
                    elm.click();
                })
            }

            var initialized = false;
            var on_dirty = () => {}
            var open_file = () => {}
            var save_file = () => {}
            var save_file_as = () => {}
            var new_document = () => {}
            var focus_window = () => {}
            var export_pdf = () => {}
            var export_epub = () => {}
            var export_html = () => {}
            var export_txt = () => {}
            var parent_key_event = (e) => {} 

            var file_picker_callback = () => {}

            function setup_editor(editor){
                editor.on('init', async function (e) {
                    let editor_el = document.querySelector('.tox-tinymce[role="application"]');
                    editor_el.setAttribute('style', 'position:absolute;inset:0;');
                    show_drawer();
                    tinymce.activeEditor.execCommand('mceToggleVisualAid');
                    initialized = true;
                });

                editor.on('Dirty', () => {
                    console.log('Dirty');
                    on_dirty();
                })

                editor.on('OpenWindow', ({ dialog }) => {
                    let obj = dialog?.getData();
                    if(obj != null && obj.alt != null && obj.dimensions != null && obj.src != null){
                        console.log('possibly image');
                        let dialog_elm = document.querySelector('div[role="dialog"]');
                        if(dialog_elm != null){
                            let input_url = dialog_elm.querySelector('input[type="url"]');
                            input_url?.setAttribute('disabled', true);
                        }
                    }
                })

                editor.on('click', e => {
                    focus_window();
                })
                editor.on('keydown', (e) => {
                    if(e.ctrlKey || e.metaKey) {
                        parent_key_event(e);
                    }
                })
                
                editor.ui.registry.addMenuItem('open', {
                    text: 'Open',
                    icon: 'open',
                    onAction: () => open_file()
                });
                editor.ui.registry.addMenuItem('save', {
                    text: 'Save',
                    icon: 'save',
                    onAction: () => save_file()
                });
                editor.ui.registry.addMenuItem('save_as', {
                    text: 'Save As',
                    icon: 'save-as',
                    onAction: () => save_file_as()
                });

                editor.ui.registry.addMenuItem('new', {
                    text: 'New Document',
                    icon: 'new',
                    onAction: () => new_document()
                });

                editor.ui.registry.addNestedMenuItem('export_as', {
                    text: 'Export As',
                    icon: 'export',
                    getSubmenuItems: () => {
                        return [
                            {
                                type: 'menuitem',
                                text: 'PDF Document (.pdf)',
                                onAction: export_pdf
                            },
                            {
                                type: 'menuitem',
                                text: 'EPUB Publication (.epub)',
                                onAction: export_epub
                            },
                            {
                                type: 'menuitem',
                                text: 'Web Page (.html)',
                                onAction: export_html
                            },
                            {
                                type: 'menuitem',
                                text: 'Plain Text (.txt)',
                                onAction: export_txt
                            },
                        ]
                    }
                });
            }
            
            document.body.addEventListener('contextmenu', (e) => {
                e.preventDefault();
            })
            document.body.addEventListener('click', () => {
                focus_window();
            })

            document.body.addEventListener('keydown', (e) => {
                if(e.ctrlKey || e.metaKey) {
                    parent_key_event(e);
                }
            })


        </script>

    
<div class="tox tox-silver-sink tox-tinymce-aux" style="position: relative;"></div></body></html>